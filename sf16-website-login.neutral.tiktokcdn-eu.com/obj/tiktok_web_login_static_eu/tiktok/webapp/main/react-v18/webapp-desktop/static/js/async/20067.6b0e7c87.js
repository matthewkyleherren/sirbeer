"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["20067"],{87383:function(e,r,n){n.d(r,{E:function(){return d}});var t=n(5377),o=n(51070),i=n(32749),u=n(49339),a=n(75888),s=n(97726),c=n(61724),l=n(82258),d=function(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.s.BrowserMode;return function(a){var d,f=(0,i.u)(e,r,n)(a),m=(0,l.A)(e,r,n)(a),v=(0,s.N)({itemListKey:e})(a),h=function(e){var r=(0,c.uA)().enableImmersivePlayer,n=(0,u.vkb)().isRefactorGroup,i=(0,u.Vv$)().isInProductHoldout;return r?(0,o.Y)(v,(0,t._)({},e)):(0,o.Y)(n&&!i?m:f,(0,t._)({},e))};return h.displayName="WithOverlayPlayer(".concat(null!=(d=a.displayName)?d:a.name,")"),h}}},99784:function(e,r,n){n.d(r,{Em:function(){return s},WA:function(){return a},f8:function(){return i},mo:function(){return u}});var t=n(29332),o=n(89485),i=function(){return(0,t.o$)(function(e){return e.needClearInput})},u=function(){return(0,t.o$)(function(e){return e.replyCid})},a=function(){return(0,t.o$)(function(e){return e.isInputFocus})},s=function(e){var r=(0,t.o$)(function(e){return{isCommentInputEmpty:e.isInputEmpty,isReplyInputEmpty:e.isReplyInputEmpty}},o.bN),n=r.isCommentInputEmpty,i=r.isReplyInputEmpty;return e?i:n&&i}},39845:function(e,r,n){n.d(r,{dY:function(){return g},gs:function(){return y},mL:function(){return b}});var t=n(41386),o=n(5377),i=n(45996),u=n(16327),a=n(6586),s=n(69513),c=n(73628),l=n(89485),d=n(82761),f=n(49861),m=n(58034),v=n(80660),h=n(10449),p=n(25435),w=n(84918),_=n(50720),y=(0,d.$)("BrowserContext@tiktok/fe-shared")({isBrowserModeShowing:!1,showBrowserMode:s.A,closeBrowserMode:s.A}),g=(0,d.$)("BrowserViewContext@tiktok/fe-shared")({currentIndex:-1,itemListKey:null,enterFrom:void 0,teaParams:{}});function b(){var e=(0,a._)((0,c.useState)(!1),2),r=e[0],n=e[1],s=(0,a._)((0,c.useState)({}),2),d=s[0],y=s[1],g=(0,a._)((0,c.useState)(),2),b=g[0],C=g[1],L=(0,a._)((0,p.BI)(function(e){return{showingBrowserMode:e.showingBrowserMode,itemListKey:e.itemListKey,currentIndex:e.currentIndex,enterWindowTimeSec:e.enterWindowTimeSec}},l.bN),2),P=L[0],k=P.showingBrowserMode,M=P.itemListKey,S=P.currentIndex,B=P.enterWindowTimeSec,R=L[1],I=(0,c.useRef)(0),E=(0,c.useRef)(0),T=(0,c.useRef)(0),x=(0,c.useRef)(0),N=(0,c.useRef)(0),D=(0,c.useRef)(null),V=(0,c.useRef)(null),A=(0,_.hL)({currentIndex:S}),K=A.authorId,Y=A.groupId,F=(0,v.L$)((0,h.W)(function(){return["user"]},[])).user,q=(0,c.useMemo)(function(){return{author_id:K,group_id:Y}},[K,Y]),O=(0,c.useCallback)(function(){var e=Math.floor((Number(new Date)-E.current)/1e3),r=(0,i._)((0,o._)((0,i._)((0,o._)({},f.L.getScreenRatio()),{duration:e}),q),{play_mode:m.Tk.BrowserMode});f.L.handleExitBrowser(r)},[q]),U=function(){null!==V.current&&window.removeEventListener("resize",V.current)};(0,c.useEffect)(function(){var e,n=function(){if(r){var e=f.L.getScreenRatio(),n=e.height_max,t=e.width_max,i=e.width,u=e.height,a=e.height_ratio,s=e.width_ratio,c=Number(new Date),l=(0,o._)({height_ratio_after:a,width_ratio_after:s,height_ratio:x.current/n,width_ratio:N.current/t,height_after:u,width_after:i,height:x.current,width:N.current,height_max:n,width_max:t,duration:(c-T.current)/1e3},q);T.current=c,x.current=u,N.current=i,f.L.handleAdjustBrowserSize(l)}};if(U(),r){var t=function(){clearTimeout(e),e=setTimeout(n,500)};window.addEventListener("resize",t),V.current=t}if(0===I.current){var i=Number(new Date);I.current=i,E.current=i,T.current=i}return function(){U()}},[r,q]);var W=(0,c.useMemo)(function(){return{capture:!0}},[]),$=(0,c.useCallback)(function(){null!==D.current&&window.removeEventListener("beforeunload",D.current,W)},[W]);(0,c.useEffect)(function(){var e=function(){var e=Math.floor((Number(new Date)-B)/1e3),n=(0,o._)((0,i._)((0,o._)({},f.L.getScreenRatio()),{duration:e}),r?q:{});f.L.handleCloseWindow(n),r&&O()};return $(),D.current=e,window.addEventListener("beforeunload",e,W),function(){$()}},[$,B,r,W,O,q]);var z=(0,w.J)();return{itemListKey:M,currentIndex:S,showBrowserMode:(0,c.useCallback)(function(e){if(!z()){var r=e.teaParams,a=e.reportTeaParams,s=e.enterFrom,c=(0,u._)(e,["teaParams","reportTeaParams","enterFrom"]);(0,t._)(document.activeElement,HTMLElement)&&document.activeElement.blur(),R.showBrowserMode(c),n(!0),y(null!=r?r:{}),C(s);var l=(null==r?void 0:r.author_id)&&(null==F?void 0:F.uid)===r.author_id,d=f.L.getScreenRatio(),v=(0,i._)((0,o._)({},null!=a?a:r,d),{play_mode:m.Tk.BrowserMode,is_self_content:l}),h=d.width;x.current=d.height,N.current=h;var p=Number(new Date);E.current=p,T.current=p,f.L.handleEnterBrowserOpt(v)}},[R,z]),closeBrowserMode:(0,c.useCallback)(function(e){n(!1),R.closeBrowserMode(e),O()},[R,O]),isBrowserModeShowing:k,disableUpdate:!r,teaParams:d,enterFrom:b}}},82258:function(e,r,n){n.d(r,{A:function(){return w}});var t=n(5377),o=n(51070),i=n(73628),u=n(96187),a=n(25435),s=n(40007),c=n(30494),l=n(75888),d=n(15275),f=n(40979),m=n(69554),v=n(2909),h=n(39845),p=(0,v.Rq)({resolved:{},chunkName:function(){return"instance"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("96821"),n.e("49871"),n.e("79781"),n.e("84673"),n.e("11380"),n.e("37050"),n.e("44810"),n.e("95029"),n.e("78288"),n.e("2536"),n.e("91340"),n.e("27234"),n.e("30462"),n.e("26684"),n.e("34807"),n.e("73921"),n.e("49346"),n.e("2391"),n.e("71522"),n.e("73155"),n.e("23966"),n.e("12456"),n.e("14601"),n.e("1305"),n.e("45176"),n.e("57881"),n.e("52482"),n.e("97301"),n.e("83241"),n.e("49538"),n.e("85127"),n.e("64418"),n.e("58385"),n.e("94213"),n.e("32271"),n.e("85602"),n.e("11898"),n.e("72920"),n.e("70372"),n.e("28751"),n.e("85032"),n.e("47775"),n.e("64643"),n.e("47856"),n.e("58677"),n.e("28939")]).then(n.bind(n,73643))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 73643}},(0,t._)({},u.KE));function w(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.s.BrowserMode;return function(u){var l=function(l){var m=(0,h.mL)(),v=m.closeBrowserMode,w=m.isBrowserModeShowing,_=m.disableUpdate,y=m.showBrowserMode,g=m.currentIndex,b=m.enterFrom,C=m.teaParams,L=(0,a.YZ)(),P=(0,i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.playProgress,t=e.fromPopState;v({playProgress:n,shouldPause:e.shouldPause}),!t&&r&&window.history.back()},[v]),k=(0,i.useCallback)(function(){L.setClickSamePage()},[L]);(0,s.N)(function(){w&&v(void 0)}),(0,i.useEffect)(function(){L.setItemListKey(e)},[L]),(0,i.useEffect)(function(){(0,d.uQ)(f.Y.BrowseModeRerender)});var M=(0,i.useMemo)(function(){return{closeBrowserMode:v,showBrowserMode:y,isBrowserModeShowing:w}},[v,y,w]),S=(0,i.useMemo)(function(){return{currentIndex:g,itemListKey:e,enterFrom:b,teaParams:C}},[g,b,C]);return(0,c.w)(),(0,o.Y)(h.gs.Provider,{value:M,children:(0,o.FD)(h.dY.Provider,{value:S,children:[(0,o.Y)(u,(0,t._)({},l)),w&&(0,o.Y)(p,{disableUpdate:_,needUrlDelegate:r,zIndex:n,onCloseBrowserMode:P,onJumpSamePage:k})]})})};return l.displayName="WithBrowserMode(".concat((0,m.x)(u),")"),l}}},50720:function(e,r,n){n.d(r,{Bc:function(){return ed},DA:function(){return en},DX:function(){return ec},HK:function(){return el},Il:function(){return j},JE:function(){return X},RH:function(){return et},V0:function(){return ee},dD:function(){return Q},hL:function(){return eu},ih:function(){return es},pk:function(){return eo},rw:function(){return ea},wP:function(){return ei}});var t=n(5377),o=n(6586),i=n(53036),u=n(26869),a=n(73628),s=n(89485),c=n(10874),l=n(2916),d=n(38896),f=n(12499),m=n(3595),v=n(79178),h=n(36646),p=n(58034),w=n(20746),_=n(13654),y=n(4115),g=n(49861),b=n(42684),C=n(26705),L=n(53069),P=n(29332),k=n(58409),M=n(44904),S=n(82983),B=n(42963),R=n(80660),I=n(38577),E=n(43919),T=n(58094),x=n(44928),N=n(97734),D=n(11567),V=n(48653),A=n(37585),K=n(25435),Y=n(31217),F=n(23460),q=n(81329),O=n(55999),U=n(31343),W=n(74473),$=n(86712),z=n(74035),H=n(49339),J=n(77407),Z=n(99784);function Q(e){var r=e.itemListKey,n=e.item,t=e.author,o=e.needUrlDelegate,s=e.disableUpdate,l=void 0!==s&&s,d=(0,c.useLocation)(),m=d.pathname,v=d.search,h=(0,c.useHistory)(),p=(0,T._u)(),w=(0,a.useRef)(!1);(0,a.useEffect)(function(){if(n&&r&&o&&!l){(0,c.matchPath)(location.pathname,{path:f.vI.liveRoom})&&(w.current=!0);var e=n.scheduleTime,a=n.author,s=(0,i.A)((0,u.parse)(v),"sender_device","sender_web_id","item_id"),d=e?(0,x.fJ)({uniqueId:void 0===a?"":a,secUid:null==t?void 0:t.secUid}):(0,u.stringifyUrl)({url:p(n),query:s},{skipNull:!0});if(w.current&&null!==window.history.state&&/^(?!.*@.*\/video).*$/.test(location.pathname)&&/^(?!.*@.*\/photo).*$/.test(location.pathname))return void window.history.replaceState(null,"",location.pathname);w.current?window.history.replaceState(window.history.state,"video-detail",d):(window.history.pushState(window.history.state,"video-detail",d),w.current=!0)}},[null==t?void 0:t.secUid,h,n,m,r,o,v,l])}function j(e){var r=e.onCloseBrowserMode,n=(0,o._)((0,v.S)(N.C,{dependencies:[],selector:function(e){return{searchValue:e.searchValue,previousSearchValue:e.previousSearchValue}}}),2),t=n[0],i=t.searchValue,u=t.previousSearchValue,s=n[1],c=s.setPreviousSearchValue,l=s.setSearchValue,d=s.setInputFocus;(0,a.useEffect)(function(){c(i),l("");var e=function(){l(u),d(!1),r({fromPopState:!0})};return window.addEventListener("popstate",e),function(){window.removeEventListener("popstate",e)}},[])}var G=function(e){null==e||e.preventDefault(),null==e||e.stopPropagation()};function X(e){var r=e.onCloseBrowserMode,n=e.onNextVideo,i=e.onPrevVideo,u=e.pause,s=e.setPause,d=e.embedVisibleRef,f=e.group_id,L=e.handleLikeClick,M=e.author_id,S=e.itemListKey,B=e.onJumpSamePage,R=e.shouldPause,I=e.photoVideoRef,E=e.isPhotoMode,T=e.photoTeaParams,x=e.setIsShowPhoto,W=e.itemMute,$=e.playerRef,z=(0,D.m)().isRTL,H=(0,o._)((0,a.useState)(!1),2),J=H[0],Q=H[1],j=(0,o._)((0,a.useState)(0),2),X=j[0],ee=j[1],er=(0,Z.Em)(),en=(0,P.$4)().setNeedClearInput,et=(0,v.w)(V.aL),eo=(0,o._)((0,v.S)(N.C,{dependencies:[],selector:function(e){return{previousSearchValue:e.previousSearchValue,searchValue:e.searchValue}}}),2),ei=eo[0],eu=ei.previousSearchValue,ea=ei.searchValue,es=eo[1].setSearchValue,ec=(0,A.ah)({playMode:p.ey.BrowserMode,itemMute:void 0!==W&&W}),el=ec.mute,ed=ec.setMute,ef=(0,o._)((0,K.BI)(function(e){return e.isCreatorBrowserMode}),2),em=ef[0],ev=ef[1],eh=(0,a.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),ed(!el,w.c.Keydown,T)},[ed,el,T,f,M]),ep=(0,h.P)(Y.hf,{selector:function(e){return e.showing},dependencies:[]}),ew=(0,h.P)(F.y7,{selector:function(e){return e.showing},dependencies:[]}),e_=(0,k.mZ)(function(e){return e.isOpen}),ey=(0,a.useCallback)(function(e){var r,n,t,o,i,a,c,l,d,f,m,v,h,p,w,_;E?u?(null==(t=I.current)||null==(n=t.swiper)||null==(r=n.play)||r.call(n),null==(a=I.current)||null==(i=a.audio)||null==(o=i.play)||o.call(i)):(null==(d=I.current)||null==(l=d.swiper)||null==(c=l.pause)||c.call(l,e),null==(v=I.current)||null==(m=v.audio)||null==(f=m.pause)||f.call(m)):u?null==(p=$.current)||null==(h=p.play)||h.call(p,!0):null==(_=$.current)||null==(w=_.pause)||w.call(_),s(!u)},[E,s,u,I,f,M,$]),eg=(0,c.useLocation)().pathname,eb=(0,c.useHistory)(),eC=(0,a.useCallback)(function(e,n){if(G(e),es(eu),er){var t;r({fromPopState:n,playProgress:null==(t=$.current)?void 0:t.currentTime,shouldPause:R})}else ee(1),Q(!0)},[er,R,r,eu,es,$]),eL=(0,a.useCallback)(function(e){G(e),ev.handleExitCreatorMode()},[ev]),eP=(0,a.useRef)(-1),ek=(0,a.useCallback)(function(e){var r,n,t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.c.Click,i=e>0?V.RW.Forward:V.RW.BackWard;window.clearTimeout(eP.current),et.setSeekType(i),eP.current=window.setTimeout(function(){et.setSeekType(V.RW.None)},2e3),null==(t=$.current)||null==(n=t.seekTime)||n.call(t,(null==(r=$.current)?void 0:r.currentTime)+e),_.V.handleVideoControlChange({play_mode:p.Tk.BrowserMode,author_id:null!=M?M:"",group_id:f,enter_method:o,click_section:o===w.c.Click?"pc_web_keyboard_btn":void 0,change_params:e>0?"video_forward":"video_backward"})},[M,f]),eM=(0,a.useRef)(""),eS=(0,a.useCallback)(function(e,r,n){if(r.includes(eg)&&eg!==m.OZ.home){eC(e),B();return}er||(G(e),ee(4),Q(!0),eM.current=r),n&&y.O.handleGeneralClick(n,{scene:"video_feed"})},[eC,er,eg,B]),eB=(0,a.useCallback)(function(){E&&(x(!1),setTimeout(function(){x(!0)},0))},[E,x]),eR=(0,l.Rx)(),eI=(0,a.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.c.Click;if(e&&G(e),eR(r),ea&&es(""),er){n(),s(!1);var o=(0,t._)({enter_method:r,play_mode:p.Tk.BrowserMode,group_id:f,author_id:null!=M?M:"",skipped_group_num:0,skipped_group_ids:""},T);g.L.handleVideoChange(o,"next"),eB()}else ee(3),Q(!0)},[eR,ea,es,er,n,s,f,M,T,eB]),eE=(0,a.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.c.Click;if(e&&G(e),eR(r),ea&&es(""),er){i(),s(!1);var n=(0,t._)({enter_method:r,play_mode:p.Tk.BrowserMode,group_id:f,author_id:null!=M?M:"",skipped_group_num:0,skipped_group_ids:""},T);g.L.handleVideoChange(n,"prev"),eB()}else ee(2),Q(!0)},[er,i,s,f,M,T,S,eB,ea,es]),eT=(0,a.useCallback)(function(e){e&&G(e),ea&&es(""),er?(s(!1),eB()):(ee(3),Q(!0))},[er,s,eB,ea,es]),ex=(0,q.mE)(function(e){return{isMiniPlayerShowing:e.isMiniPlayerShowing}}).isMiniPlayerShowing,eN=(0,a.useCallback)(function(e){if(!(e.keyCode!==O.D.Esc&&["input","textarea"].includes(e.target.tagName.toLocaleLowerCase()))&&"true"!==e.target.getAttribute("contenteditable")&&!e_){var r=new Map([[O.D.Esc,function(){!ex&&(em?(eL(e),s(!1)):ep||ew||d.current||eC(e))}],[O.D.Down,function(){eI(e,w.c.Keydown)}],[O.D.Space,function(){ey(b.kC.Keyboard)}],[O.D.Right,function(){ek(z?U.a:U.S,w.c.Keydown)}],[O.D.Left,function(){ek(z?U.S:U.a,w.c.Keydown)}],[O.D.Up,function(){eE(e,w.c.Keydown)}],[O.D.L,function(){L(w.c.Keydown)}],[O.D.M,function(){eh(e)}]]),n=e.keyCode;r.has(n)&&(e.preventDefault(),r.get(n)())}},[d,eC,L,eI,eE,eh,e_,ep,ew,ey,eL,em,ek,z,s,ex]),eD=(0,a.useCallback)(function(){switch(X){case 1:var e;r({playProgress:null==(e=$.current)?void 0:e.currentTime,shouldPause:R});break;case 2:i(),s(!1);break;case 3:n(),s(!1);break;case 4:eM.current&&eb.push(eM.current)}Q(!1),en(!0),C.ao.handleLeaveComment({group_id:f})},[X,f,eb,R,r,n,i,en,s]),eV=(0,a.useCallback)(function(){ee(0),Q(!1),C.ao.handleKeepComment({group_id:f})},[f]);return(0,a.useEffect)(function(){return document.addEventListener("keydown",eN),function(){document.removeEventListener("keydown",eN)}},[eN]),{handleLinkClick:eS,handleClose:eC,handleCloseCreatorMode:eL,handleNext:eI,handlePrev:eE,preventDefault:G,togglePlay:ey,showLeaveModal:J,noEditingContent:er,handleConfirmLeave:eD,handleCancelLeave:eV,handleSeek:ek,handleClickCreatorVid:eT}}function ee(e){var r=e.id,n=e.authorId,t=e.playMode,o=e.needDispose,i=void 0===o||o,u=e.handleCommentScrollDown,s=e.handleCommentHitTop,c=(0,M.BY)(),l=(0,a.useRef)(null),d=(0,a.useCallback)(function(){C.ao.handleCommentLoadMore({play_mode:t,group_id:r,author_id:n}),c.fetchComment({aweme_id:r})},[c,r]);return(0,a.useEffect)(function(){return function(){i&&c.setCommentItem({itemId:r,item:M.lN})}},[c,r,i]),(0,W.O9)({elemRef:l,onHitBottom:d,bottomThreshold:200,throttle:200}),(0,W.yE)({elemRef:l,onHitTop:s,onScrollDown:u}),l}function er(e,r){C.ao.handleClose({group_id:e,is_comments_loaded:r?C.uO.Loading:C.uO.Loaded})}function en(e){var r=e.group_id,n=(0,M._B)(function(e){var n;return null!=(n=e[r])?n:{loading:!1}},s.bN).loading;(0,a.useEffect)(function(){return function(){er(r,n)}},[r])}function et(e){var r=e.group_id,n=(0,M._B)(function(e){var n;return null!=(n=e[r])?n:{loading:!1}},s.bN).loading;(0,a.useEffect)(function(){er(r,n)},[])}var eo=function(e){var r=e.currentIndex,n=(0,K.JD)(function(e){return e.isCreatorBrowserMode});return(0,$.d8)(function(e){return(null==e?void 0:e.browserList)?{currentId:(n?e.creatorBrowserList:e.browserList)[r]}:null},s.bN)},ei=function(){var e=(0,K.JD)(function(e){return e.isCreatorBrowserMode});return(0,$.d8)(function(r){return(null==r?void 0:r.browserList)?{listLength:(e?r.creatorBrowserList:r.browserList).length}:null},s.bN)},eu=function(e){var r,n=e.currentIndex,t=(0,R.L$)(eo({currentIndex:n})).currentId,o=(0,R.L$)((0,z.k)(void 0===t?"":t)),i=null!=(r=null==o?void 0:o.id)?r:"";return{authorId:null==o?void 0:o.authorId,groupId:i}};function ea(e,r,n){var t=(0,o._)((0,S.sK)(function(e){var r,n,t;return{loading:null!=(r=e.loading)&&r,hasMoreLatest:null!=(n=e.hasMoreLatest)&&n,hasMorePrevious:null!=(t=e.hasMorePrevious)&&t}},s.bN),2),i=t[0],u=i.loading,c=i.hasMoreLatest,l=i.hasMorePrevious,f=t[1];return(0,a.useCallback)(function(){(!n||!u&&c)&&(n||!u&&l)&&f.getCreatorTabList({key:B.Lz.CreatorTab,secUid:e,createTime:r,fetchType:n?d.N.LoadLatest:d.N.LoadPrevious})},[u,l,c,n,e,r,f])}var es=function(){var e=(0,I.s)(),r=e("pc_web_login"),n=e("pc_web_login_to_comment"),t=n.indexOf("%s");return{prefixText:n.slice(0,t),loginText:r,endText:n.slice(t).replace("%s","")}},ec=function(e){return e?new Map([[B.Lz.ForYou,"one-column-item"],[B.Lz.Following,"one-column-item"]]).get(e):e},el=function(e,r,n){var t=(0,H.reW)().withMultiInstance,o=(0,L.RT)(),i=o===r,u=o===p.ey.BrowserMode,a=(0,L.w)(e,r,n),s=(0,L.R3)(e,r),c=E.R.DEFAULT;return i&&u?c=a?E.R.ACTIVE:s&&t?E.R.BACKUP:E.R.DEFAULT:i&&(c=E.R.ACTIVE),c};function ed(e){var r=e.handleNext,n=e.handlePrev,t=e.currentId,o=(0,H.TFl)(),i=o.fixLastRef,u=o.scrollOPT,s=(0,a.useRef)(""),c=(0,a.useRef)(0),l=(0,a.useRef)(0),d=(0,a.useRef)(null),f=(0,a.useRef)(!0),m=(0,a.useRef)(""),v=(0,a.useRef)(null),h=(0,a.useRef)(0),p=(0,J._g)(function(e){if(s.current!==t||i){e.stopPropagation(),d.current&&clearTimeout(d.current),d.current=window.setTimeout(function(){l.current=0},100);var o=new Date().getTime(),u=Math.max(-1,Math.min(1,e.wheelDelta||-e.deltaY||-e.detail)),a=o-c.current;l.current=l.current+1,c.current=o,a>100&&1===l.current&&(u<0?r(e,w.c.Scroll):n(e,w.c.Scroll),i||(s.current=t))}},[t,r,n],20),_=(0,a.useCallback)(function(e){var t,o=e.deltaY,i=null!=(t=e.timeStamp)?t:performance.now(),u=i-(h.current||i);h.current=i;var a=o<0?"prev":o>0?"next":"";if(a&&!(10>Math.abs(o))){a!==m.current&&(v.current&&clearTimeout(v.current),f.current=!0);var s=0!==e.deltaMode||Math.abs(o)>=30&&u>35;f.current&&("next"===a?r(e,w.c.Scroll):n(e,w.c.Scroll),f.current=!1,m.current=a),v.current&&clearTimeout(v.current),v.current=window.setTimeout(function(){f.current=!0},s?160:300)}},[r,n]),y=(0,a.useCallback)(function(e){u?_(e):p(e)},[u,p,_]);return(0,a.useEffect)(function(){return function(){d.current&&clearTimeout(d.current),v.current&&clearTimeout(v.current)}},[]),y}},97726:function(e,r,n){n.d(r,{N:function(){return S}});var t=n(5377),o=n(45996),i=n(6586),u=n(51070),a=n(73628),s=n(10449),c=n(25435),l=n(84918),d=n(62672),f=n(90432),m=n(49861),v=n(58034),h=n(73645),p=n(42963),w=n(45893),_=n(80660),y=n(2909),g=n(89485),b=n(47),C=n(61724),L=n(38424),P=n(96375),k=n(24874),M=(0,y.Ay)({resolved:{},chunkName:function(){return"immersive-player"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("96821"),n.e("79781"),n.e("84673"),n.e("11380"),n.e("37050"),n.e("44810"),n.e("95029"),n.e("78288"),n.e("27234"),n.e("30462"),n.e("26684"),n.e("73921"),n.e("49346"),n.e("47981"),n.e("71522"),n.e("73155"),n.e("12456"),n.e("14601"),n.e("1305"),n.e("57881"),n.e("97301"),n.e("85127"),n.e("64418"),n.e("19278"),n.e("58385"),n.e("94213"),n.e("33842"),n.e("85032"),n.e("68422"),n.e("72335")]).then(n.bind(n,57800))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 57800}}),S=function(e){var r=e.itemListKey;return function(e){var n,y=function(n){var y=(0,C.uA)().isCommentsDefaultOpen,S=(0,_.L$)((0,s.W)(function(){return["user"]},[])).user,B=(0,i._)((0,c.BI)(function(e){return e.showingBrowserMode},g.bN),2),R=B[0],I=B[1],E=(0,i._)((0,h.vZ)(function(e){return{isImmersivePlayerOpen:e.isOpen}},g.bN),2),T=E[0].isImmersivePlayerOpen,x=E[1],N=(0,L.R0)(function(e){return{selectedTab:e.selectedTab}},g.bN).selectedTab,D=(0,k.w)(r).list,V=(0,P.Cd)(),A=V.enterTimeRef,K=V.closeImmersivePlayer,Y=(0,l.J)(),F=(0,b.eK)().isUserPage,q=(0,a.useMemo)(function(){return r===p.Lz.ForYou||r===p.Lz.Friends||r===p.Lz.Following},[]);(0,a.useEffect)(function(){T!==R&&I.setShowingBrowserMode(T)},[I,T,R]);var O=(0,a.useCallback)(function(e,n,t,o){var i=null!=n?n:F?N:r,u={index:e,itemListSourceConfig:t?{mode:"id",source:"user-playlist",id:t}:{mode:"single",itemListKey:i},isCommentsOpen:q||y,teaParams:o};return(0,w.D)(r)||(u.id=D[e]),u},[x,y,q,F,N,D]),U=(0,a.useCallback)(function(e){var r=e.index,n=e.teaParams,i=e.reportTeaParams,u=O(void 0===r?0:r,e.itemListKey,e.itemListConfigId,n);x.openImmersivePlayer(u),A.current=Number(Date.now());var a=(null==n?void 0:n.author_id)&&(null==S?void 0:S.uid)===n.author_id,s=m.L.getScreenRatio(),c=(0,o._)((0,t._)({},null!=i?i:n,s),{enter_method:q?"click_comment":"click_preview_card",play_mode:v.Tk.ImmersivePlayer,is_self_content:a});f.f.sendEvent("enter_immersive_player",c),m.L.handleEnterBrowserOpt(c)},[O,A,x]),W=(0,a.useCallback)(function(){K("close-browser-mode")},[K]);return(0,u.FD)(d.g.Provider,{value:{showBrowserMode:function(e){var r=e.index,n=e.teaParams,t=e.reportTeaParams,o=e.itemListKey,i=e.id;Y()||U({index:r,teaParams:n,reportTeaParams:t,itemListKey:o,itemListConfigId:i})},closeBrowserMode:W,isBrowserModeShowing:T,isLiveBrowserShowing:T},children:[(0,u.Y)(e,(0,t._)({},n)),(0,u.Y)(M,{})]})};return y.displayName="WithImmersivePlayer(".concat(null!=(n=e.displayName)?n:e.name,")"),y}}},96375:function(e,r,n){n.d(r,{Cd:function(){return v}});var t=n(5377),o=n(45996),i=n(73628),u=n(73645),a=n(90432),s=n(49861),c=n(58034),l=n(89485),d=n(24874),f=i.createRef(),m=function(){var e=(0,d.Z)(function(e){return{teaParams:e.teaParams}},l.bN).teaParams;return{reportExitImmersivePlayer:(0,i.useCallback)(function(r){if(r&&f.current){var n=Number(new Date),i=(0,o._)((0,t._)((0,o._)((0,t._)({},s.L.getScreenRatio()),{duration:f.current?(n-f.current)/1e3:void 0}),e),{enter_method:r,play_mode:c.Tk.ImmersivePlayer});s.L.handleExitBrowser(i),a.f.sendEvent("exit_immersive_player",i),f.current=null}},[e])}},v=function(){var e=m().reportExitImmersivePlayer,r=(0,u.kh)();return{enterTimeRef:f,closeImmersivePlayer:(0,i.useCallback)(function(n){e(n),r.closeImmersivePlayer()},[r,e]),reportExitImmersivePlayer:e}}},24874:function(e,r,n){n.d(r,{Z:function(){return f},w:function(){return d}});var t=n(5377),o=n(45996),i=n(6586),u=n(70143),a=n(79178),s=n(73645),c=n(45893),l=n(89485),d=function(e){return(0,i._)((0,a.S)(u.O,{selector:function(r){var n;return null!=(n=r[null!=e?e:""])?n:{list:[]}},dependencies:[e]}),1)[0]},f=function(){for(var e,r=arguments.length,n=Array(r),u=0;u<r;u++)n[u]=arguments[u];var a=(0,i._)(n,2),f=a[0],m=a[1],v=(0,s.Z9)(f,m),h=(0,s.Z9)(function(e){return e},l.bN),p=h.itemListSourceConfig,w=d((null==p?void 0:p.mode)==="single"?p.itemListKey:void 0);return(null==p?void 0:p.mode)==="single"?(0,c.D)(p.itemListKey)?v:f((0,o._)((0,t._)({},h),{itemList:null!=(e=w.list)?e:[]})):v}},40979:function(e,r,n){n.d(r,{Y:function(){return o}});var t,o=((t={}).PlayerChange="player_change",t.PlayerDestroy="player_destroy",t.PlayerMounted="player_mounted",t.OneColumnRerender="one_column_rerender",t.BrowseModeRerender="browse_mode_rerender",t.VideoRequest="video_request",t.VideoCanPlay="video_can_play",t.VideoFirstFrame="video_first_frame",t)},15275:function(e,r,n){n.d(r,{uQ:function(){return i},xt:function(){return a}});var t=n(6586),o=n(40979);function i(e){return performance.mark(e)}function u(e){var r=e.start,n=e.end;try{return performance.measure("".concat(r,"-").concat(n),r,n)}catch(e){}}function a(){var e,r,n,i=[o.Y.PlayerDestroy,o.Y.PlayerMounted,o.Y.OneColumnRerender,o.Y.BrowseModeRerender,o.Y.VideoRequest,o.Y.VideoFirstFrame].map(function(e){var r,n,t;return(t=null!=(n=null==(r=u({start:o.Y.PlayerChange,end:e}))?void 0:r.duration)?n:0)<0?0:t}),a=(0,t._)(i,6);return{destroy_time:a[0],mounted_time:a[1],one_column_rerender_time:a[2],browse_mode_rerender_time:a[3],video_request_time:a[4],video_first_frame_time:a[5],player_first_frame_time:(n=null!=(r=null==(e=u({start:o.Y.VideoRequest,end:o.Y.VideoFirstFrame}))?void 0:e.duration)?r:0)<0?0:n}}},77576:function(e,r,n){n.d(r,{f:function(){return m}});var t=n(5377),o=n(6586),i=n(51070),u=n(73628),a=n(2909),s=n(79178),c=(n(69554),n(3437)),l=n(96187),d=n(23460),f=(0,a.Rq)({resolved:{},chunkName:function(){return"ad-report-loadable"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("79781"),n.e("84673"),n.e("71522"),n.e("18233")]).then(n.bind(n,54473))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 54473}},(0,t._)({},l.bu));function m(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onClose,r=(0,c.g9)().hideModal,n=(0,o._)((0,s.S)(d.y7,{selector:function(e){return e.showing},dependencies:[]}),2),t=n[0],a=n[1],l=(0,u.useCallback)(function(){null==e||e(),r(),a.hideReport()},[a,r,e]);return(0,i.Y)(f,{onClose:l,visible:t})}},69804:function(e,r,n){n.d(r,{B:function(){return h}});var t=n(5377),o=n(6586),i=n(51070),u=n(73628),a=n(79178),s=n(69554),c=n(77576),l=n(3437),d=n(31217),f=n(2909),m=n(96187),v=(0,f.Rq)({resolved:{},chunkName:function(){return"report"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("77877"),n.e("5440"),n.e("79781"),n.e("84673"),n.e("20853"),n.e("11380"),n.e("37050"),n.e("95029"),n.e("13038"),n.e("71522"),n.e("39199"),n.e("73155"),n.e("93950"),n.e("23966"),n.e("72863"),n.e("45464"),n.e("85066"),n.e("12456"),n.e("57881"),n.e("41516"),n.e("23322")]).then(n.bind(n,24945))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 24945}},(0,t._)({},m.bu));function h(e){var r=function(r){var n=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onClose,r=(0,l.g9)().hideModal,n=(0,o._)((0,a.S)(d.hf,{selector:function(e){return e.showing},dependencies:[]}),2),t=n[0],s=n[1],c=(0,u.useCallback)(function(){null==e||e(),r(),s.hideReport()},[s,r,e]);return(0,i.Y)(v,{onClose:c,visible:t})}(),s=(0,c.f)();return(0,i.FD)(i.FK,{children:[(0,i.Y)(e,(0,t._)({},r)),n,s]})};return r.displayName="WithReport(".concat((0,s.x)(e),")"),r}},40007:function(e,r,n){n.d(r,{N:function(){return i}});var t=n(73628),o=n(10874);function i(e){var r=(0,t.useRef)(),n=(0,o.useHistory)();(0,t.useEffect)(function(){var t,o,i=null!=(o=null==n||null==(t=n.location)?void 0:t.pathname)?o:"";i&&r.current!==i&&(null==e||e(r.current,i),r.current=i)},[n,e])}},30494:function(e,r,n){n.d(r,{w:function(){return d}});var t=n(6586),o=n(73628),i=n(89485),u=n(66868),a=n(38577),s=n(71952),c=n(70721),l=n(15035);function d(){var e=(0,a.s)(),r=(0,t._)((0,l.W)(function(e){return{statusCode:e.statusCode,statusMessage:e.statusMessage,action:e.action,toastNotShown:e.toastNotShown}},i.bN),2),n=r[0],d=n.statusCode,f=n.statusMessage,m=n.action,v=n.toastNotShown,h=r[1];(0,o.useEffect)(function(){var r;if(v){switch(d){case s.s.Ok:"delete"===m&&(r=e("deleted"));break;case s.s.AdVideoUnavailableChange:r=f;break;case s.s.VideoUnavailableDeleted:r=e("video_unavailable_deleted");break;default:r=e(c.Sw)}u.F.destroy(),u.F.open({content:r,duration:3,widthType:"half"}),h.clearBrowserModeStatus()}},[e,v,d,f,m,h])}},32749:function(e,r,n){n.d(r,{u:function(){return b}});var t=n(5377),o=n(51070),i=n(73628),u=n(75888),a=n(58409),s=n(10449),c=n(67500),l=n(15275),d=n(40979),f=n(69554),m=n(2909),v=n(96187),h=n(40007),p=n(25435),w=n(30494),_=n(62672),y=(0,m.Rq)({resolved:{},chunkName:function(){return"instance"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("96821"),n.e("49871"),n.e("79781"),n.e("84673"),n.e("11380"),n.e("37050"),n.e("44810"),n.e("95029"),n.e("78288"),n.e("2536"),n.e("91340"),n.e("27234"),n.e("30462"),n.e("26684"),n.e("34807"),n.e("73921"),n.e("49346"),n.e("2391"),n.e("71522"),n.e("73155"),n.e("23966"),n.e("12456"),n.e("14601"),n.e("1305"),n.e("45176"),n.e("57881"),n.e("52482"),n.e("97301"),n.e("83241"),n.e("49538"),n.e("85127"),n.e("64418"),n.e("58385"),n.e("94213"),n.e("32271"),n.e("85602"),n.e("11898"),n.e("72920"),n.e("70372"),n.e("28751"),n.e("85032"),n.e("47775"),n.e("64643"),n.e("47856"),n.e("58677"),n.e("28939")]).then(n.bind(n,29913))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 29913}},(0,t._)({},v.KE)),g=(0,m.Rq)({resolved:{},chunkName:function(){return"live-top-modules-live-browser-mode-live-browser-mode"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("79781"),n.e("84673"),n.e("65514"),n.e("88977"),n.e("71522"),n.e("9346"),n.e("59292"),n.e("12112"),n.e("87564")]).then(n.bind(n,95670))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 95670}},(0,t._)({},v.KE));function b(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.s.BrowserMode;return function(u){var m=function(f){var m,v,b=(0,_.m)(),C=b.itemListKey,L=b.currentIndex,P=b.closeBrowserMode,k=b.isLiveBrowserShowing,M=b.isBrowserModeShowing,S=b.disableUpdate,B=b.showBrowserMode,R=b.teaParams,I=b.enterFrom,E=(0,p.YZ)(),T=(0,a.b1)(),x=(0,s.W)(function(){return["abTestVersion"]},[]),N=null!=(m=(0,c.qt)(null==x?void 0:x.abTestVersion,"search_video"))?m:"v1",D=(null!=(v=(0,s.W)(function(){return["user"]},[]))?v:{}).user,V=E.getAdjacentVideoInfo(),A=("general_search"===I||"search_video"===I)&&!D,K=(0,i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.playProgress,t=e.fromPopState;P({playProgress:n,shouldPause:e.shouldPause}),!t&&r&&window.history.back()},[P]),Y=(0,i.useCallback)(function(){E.setClickSamePage()},[E]);(0,h.N)(function(){M&&P(void 0)}),(0,i.useEffect)(function(){E.setItemListKey(e)},[E]),(0,i.useEffect)(function(){(0,l.uQ)(d.Y.BrowseModeRerender)});var F=(0,i.useMemo)(function(){return{closeBrowserMode:P,showBrowserMode:B,isBrowserModeShowing:M,isLiveBrowserShowing:k}},[P,M,k,B]),q=(0,i.useCallback)(function(){if((0,l.uQ)(d.Y.PlayerChange),5===L&&A&&("v3"===N||"v4"===N))return void T.openModal({isSignup:!1,query:{redirect_url:window.location.href,enter_method:"click_top_bar",enter_from:I,type:"loginsearchmore"}});E.handleNextVideo()},[L,T,N,I,A,E]),O=(0,i.useCallback)(function(){(0,l.uQ)(d.Y.PlayerChange),E.handlePrevVideo()},[E]);return(0,w.w)(),(0,o.FD)(_.g.Provider,{value:F,children:[(0,o.Y)(u,(0,t._)({},f)),k?(0,o.Y)(g,{itemListKey:C,currentIndex:L,zIndex:n,onCloseBrowserMode:K,onNextVideo:q,onPrevVideo:O}):M&&(0,o.Y)(y,{disableUpdate:S,itemListKey:C,currentIndex:L,onNextVideo:q,onPrevVideo:O,needUrlDelegate:r,zIndex:n,onCloseBrowserMode:K,teaParams:R,onJumpSamePage:Y,adjacentVideoIds:V})]})};return m.displayName="WithBrowserMode(".concat((0,f.x)(u),")"),m}}}}]);