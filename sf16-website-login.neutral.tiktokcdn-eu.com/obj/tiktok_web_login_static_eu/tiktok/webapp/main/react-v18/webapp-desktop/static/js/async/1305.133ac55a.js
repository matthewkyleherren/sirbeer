"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["1305"],{45001:function(e,t,n){n.d(t,{VL:function(){return d},qW:function(){return u}});var r=n(5377),a=n(45996),o=n(66905),i=(0,n(10625).p)("videoActualResolutionState@tiktok/webapp-atoms",{actualResolution:""}),l=(0,o.i)(i,function(e,t){return{setVideoActualResolution:function(e){t(i,function(t){return(0,a._)((0,r._)({},t),{actualResolution:e})})}}}),u=(l.useAtomService,l.useServiceState),d=l.useServiceDispatchers;l.getStaticApi},18408:function(e,t,n){n.d(t,{Ek:function(){return d},I7:function(){return c}});var r=n(5377),a=n(45996),o=n(16327),i=n(66905),l=(0,n(10625).p)("llmPopupAtom@tiktok/webapp-atoms",{isVisible:!1,lastInference:null,actionHooksMap:{}}),u=(0,i.i)(l,function(e,t){return{showPopup:function(e){var n=e.actionHooksMap;t(l,{isVisible:!0,lastInference:(0,o._)(e,["actionHooksMap"]),actionHooksMap:void 0===n?{}:n})},hidePopup:function(){t(l,function(e){return(0,a._)((0,r._)({},e),{isVisible:!1})})},clearInference:function(){t(l,function(e){return(0,a._)((0,r._)({},e),{lastInference:null,actionHooksMap:{}})})}}}),d=u.useAtomService,c=u.useServiceState;u.useServiceDispatchers},40053:function(e,t,n){n.d(t,{Y:function(){return a}});var r,a=((r={}).LOGIN_TO_LIKE="login_to_like",r.LOGIN_TO_COMMENT="login_to_comment",r.LOGIN_TO_FAVORITE="login_to_favorite",r.LOGIN_TO_SHARE_WITH_FRIEND="login_to_share_with_friend",r.LOGIN_FOR_BETTER_RECOMMENDATION="login_for_better_recommendation",r.REDIRECT_TO_CREATOR_PAGE="redirect_to_creator_page",r.REDIRECT_TO_EXPLORE_PAGE="redirect_to_explore_page",r.SHARE_TO_OTHER_SOCIAL_MEDIA="share_to_other_social_media",r)},66693:function(e,t,n){n.d(t,{Gh:function(){return s},ey:function(){return d},gc:function(){return u},yR:function(){return v},zU:function(){return l},zf:function(){return c}});var r,a,o=n(35383),i=n(40053),l=!0,u=31536e6,d=((r={}).CLOSE_LOGIN_LIKE="close_login_like",r.CLOSE_LOGIN_COMMENT="close_login_comment",r.CLOSE_LOGIN_FAVORITE="close_login_favorite",r.CLOSE_LOGIN_SHARE="close_login_share",r.CLOSE_SHARE_POPUP="close_share_popup",r.AVATAR_HOVER="avatar_hover",r.HIGH_VV_COUNT="high_vv_count",r.LOW_ENGAGEMENT="low_engagement",r),c="llm_inference_cool_down",s=(a={},(0,o._)(a,i.Y.LOGIN_TO_LIKE,{messageKey:"llmAssist_web_msg1_body",defaultMessage:"Want to see more videos like this? Like this video by logging in",ctaKey:"llmAssist_web_msg1CTA_btn",defaultCta:"Log in to like"}),(0,o._)(a,i.Y.LOGIN_TO_COMMENT,{messageKey:"llmAssist_web_msg2_body",defaultMessage:"Leave a comment and join the conversation",ctaKey:"llmAssist_web_msg2CTA_btn",defaultCta:"Log in to comment"}),(0,o._)(a,i.Y.LOGIN_TO_FAVORITE,{messageKey:"llmAssist_web_msg3_body",defaultMessage:"Log in to save this video and watch it later",ctaKey:"llmAssist_web_msg3CTA_btn",defaultCta:"Log in to save"}),(0,o._)(a,i.Y.LOGIN_TO_SHARE_WITH_FRIEND,{messageKey:"llmAssist_web_msg4_body",defaultMessage:"Share this video with your friends!",ctaKey:"llmAssist_web_msg4CTA_btn",defaultCta:"Log in to share"}),(0,o._)(a,i.Y.LOGIN_FOR_BETTER_RECOMMENDATION,{messageKey:"llmAssist_web_msg5_body",defaultMessage:"See more videos like this and other personalized content",ctaKey:"llmAssist_web_msg5CTA_btn",defaultCta:"Log in"}),(0,o._)(a,i.Y.REDIRECT_TO_EXPLORE_PAGE,{messageKey:"llmAssist_web_msg6_body",defaultMessage:"Discover popular categories on the Explore page",ctaKey:"llmAssist_web_msg6CTA_btn",defaultCta:"Explore"}),(0,o._)(a,i.Y.REDIRECT_TO_CREATOR_PAGE,{messageKey:"llmAssist_web_msg7_body",defaultMessage:"View this creator's profile",ctaKey:"llmAssist_web_msg7CTA_btn",defaultCta:"View"}),(0,o._)(a,i.Y.SHARE_TO_OTHER_SOCIAL_MEDIA,{messageKey:"llmAssist_web_msg8_body",defaultMessage:"Share this video link anywhere!",ctaKey:"llmAssist_web_msg8CTA_btn",defaultCta:"Share"}),a),v={1:i.Y.LOGIN_TO_LIKE,2:i.Y.LOGIN_TO_COMMENT,3:i.Y.LOGIN_TO_FAVORITE,4:i.Y.LOGIN_TO_SHARE_WITH_FRIEND,5:i.Y.LOGIN_FOR_BETTER_RECOMMENDATION,6:i.Y.REDIRECT_TO_EXPLORE_PAGE,7:i.Y.REDIRECT_TO_CREATOR_PAGE,8:i.Y.SHARE_TO_OTHER_SOCIAL_MEDIA}},41166:function(e,t,n){n.d(t,{V:function(){return k}});var r=n(79066),a=n(6586),o=n(72516),i=n(73628),l=n(10449),u=n(40053),d=n(22481),c=n(95086),s=n(70991),v=n(18408),p=n(66693),f=n(5377),_=n(44957),y=n(54149),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.Y.LOGIN_TO_LIKE;return{actionString:e}},g=function(e){var t=e.triggerEvent,n=u.Y.LOGIN_TO_LIKE;switch(t){case p.ey.CLOSE_LOGIN_LIKE:n=u.Y.LOGIN_TO_LIKE;break;case p.ey.CLOSE_LOGIN_COMMENT:n=u.Y.LOGIN_TO_COMMENT;break;case p.ey.CLOSE_LOGIN_FAVORITE:n=u.Y.LOGIN_TO_FAVORITE;break;case p.ey.CLOSE_LOGIN_SHARE:n=u.Y.LOGIN_TO_SHARE_WITH_FRIEND;break;case p.ey.HIGH_VV_COUNT:n=u.Y.LOGIN_FOR_BETTER_RECOMMENDATION;break;case p.ey.LOW_ENGAGEMENT:n=u.Y.REDIRECT_TO_EXPLORE_PAGE;break;case p.ey.AVATAR_HOVER:n=u.Y.REDIRECT_TO_CREATOR_PAGE;break;case p.ey.CLOSE_SHARE_POPUP:n=u.Y.SHARE_TO_OTHER_SOCIAL_MEDIA;break;default:n=u.Y.LOGIN_TO_LIKE}return h(n)},m=function(e){switch(e){case"close_login_like":return"The user clicked the like button and then closed the login popup";case"close_login_comment":return"The user tried to comment on a video and then closed the login popup";case"close_login_favorite":return"The user tried to favorite a video and then closed the login popup";case"close_login_share":return"The user tried to share a video to friends and then closed the login popup";case"close_share_popup":return"The user tried to share a video to other social media platform, but did not complete, and closed the share popup";case"avatar_hover":return"The user hovered over a video creator's avatar";case"high_vv_count":return"The user has watched more than 5 videos";case"low_engagement":return"The user has watched multiple videos with very short viewing time";default:return e}},b=n(23155),P=function(e){return{vv_count:0,play_duration:0,avg_play_duration:0,vv_finish:0,page_view:0,like_cnt:0,comment_cnt:0,favorite_cnt:0,follow_cnt:0,share_cnt:0,login_button_clicked_cnt:0,first_active_date:0,launch_mode:"",region:"",hardware_score:"",network_downlink:"",time_of_day_landing:0,day_of_week:"",is_login:!1,trigger_event:m(e)}},T=function(e){try{var t,n=(0,d._S)(s.ne)||"{}",r=JSON.parse(n),a=new Date().toLocaleDateString("en-US"),o=Object.keys(r[a]||{})[0];if(!o||!(null==(t=r[a])?void 0:t[o]))return P(e);var i=r[a][o];return{vv_count:i.vv||0,play_duration:60*i.play_duration||0,avg_play_duration:i.vv>0?60*i.play_duration/i.vv:0,vv_finish:i.video_finish||0,page_view:i.page_view||0,like_cnt:i.like_cnt||0,comment_cnt:i.comment_cnt||0,favorite_cnt:i.favorite_cnt||0,follow_cnt:i.follow_cnt||0,share_cnt:i.share_cnt||0,login_button_clicked_cnt:i.login_button_clicked_cnt||0,first_active_date:i.first_active_date||0,launch_mode:i.launch_mode||"",region:i.region||"",hardware_score:String(i.hardware_score||""),network_downlink:String(i.network_downlink||""),time_of_day_landing:i.time_of_day_landing||0,day_of_week:(0,b.O)(i.day_of_week||""),is_login:!!i.is_login,trigger_event:m(e)}}catch(t){return console.error("Error preparing SPF request:",t),P(e)}},k=function(){var e,t=null!=(e=(0,l.W)(function(){return["user","webIdCreatedTime"]},[]))?e:{},n=t.user,h=t.webIdCreatedTime,m=!!n,P=(0,a._)((0,i.useState)(!1),2),k=P[0],C=P[1],E=(0,b.z)(),S=E.isInSPFTreatment,R=E.isInSPFEarlyInterestSelector,w=E.isInSPFNormalInterestSelector,A=(0,a._)((0,v.Ek)(),2)[1].showPopup,I=(0,i.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r._)(function(){var n,a,i;return(0,o.__generator)(this,function(l){switch(l.label){case 0:return[4,(0,r._)(function(){var t;return(0,o.__generator)(this,function(n){switch(n.label){case 0:return[4,(0,r._)(function(){var t,n,r,a,i;return(0,o.__generator)(this,function(o){switch(o.label){case 0:if(o.trys.push([0,4,,5]),!p.zU)return[3,1];return t=g({userMetrics:{},triggerEvent:e}),[3,3];case 1:return n=T(e),[4,_.h.get("/api/spf/prompt/",{query:(0,f._)({},n,{aid:1988,app_language:"en",device_platform:"web_pc",fromWeb:1,enter_from:"tiktok_web"}),baseUrlType:y.Z4.FixedWww})];case 2:if((r=o.sent())&&200===r.statusCode||console.error("API error: ".concat((null==r?void 0:r.statusMsg)||"Unknown error")),void 0===(a=r.action_event)||!(i=p.yR[a]))return[2,null];t={actionString:i},o.label=3;case 3:if(!t.actionString||!p.Gh[t.actionString])return[2,null];return[2,t.actionString];case 4:return console.error("LLM inference error:",o.sent()),[2,null];case 5:return[2]}})})()];case 1:if(t=n.sent())return[2,{actionString:t}];return[2,null]}})})()];case 1:if(n=l.sent())return A({actionString:i=(a=n.actionString)&&Object.keys(t).includes(a)?a:u.Y.REDIRECT_TO_EXPLORE_PAGE,actionHooksMap:t}),[2,i];return[2,null]}})})()},[A]);return{maybeTriggerInference:(0,i.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r._)(function(){var n,r;return(0,o.__generator)(this,function(a){switch(a.label){case 0:if(!S||(R||w)&&"1"!==(0,d._S)(s.Is,"0")||m||k||!(0,c.m)(h)||(n=(0,d._S)(p.zf))&&Date.now()-parseInt(n,10)<p.gc)return[2,null];a.label=1;case 1:return a.trys.push([1,,3,4]),C(!0),[4,I(e,t)];case 2:return(r=a.sent())&&(0,d.AP)(p.zf,Date.now().toString()),[2,r];case 3:return C(!1),[7];case 4:return[2]}})})()},[S,R,w,m,k,h,I])}}},23155:function(e,t,n){n.d(t,{O:function(){return i},z:function(){return l}});var r=n(80660),a=n(10449),o=n(67500),i=function(e){return({0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"})["string"==typeof e?parseInt(e,10):e]||""},l=function(){var e,t=(0,r.L$)((0,a.W)(function(){return["abTestVersion"]},[])).abTestVersion,n=null!=(e=(0,o.qt)(t,"webapp_spf"))?e:"v0";return{isInSPFTreatment:"v0"!==n,isInSPFEarlyInterestSelector:"v1"===n,isInSPFNormalInterestSelector:"v2"===n,isInSPFIneffectiveInterestSelector:"v3"===n}}},52878:function(e,t,n){n.d(t,{Hs:function(){return h},MA:function(){return _},Q4:function(){return b},Zd:function(){return g},mx:function(){return f},n5:function(){return m},yy:function(){return y}});var r=n(73628),a=n(89485),o=n(66917),i=n(58034),l=n(3878),u=n(12293),d=n(34826),c=n(10449),s=n(67500),v=n(74035),p=n(7622),f=function(e){return void 0!==(null==e?void 0:e.imagePost)},_=function(e){var t,n,r=f(e);return{aweme_type:150*!!r,pic_cnt:r?null==e||null==(n=e.imagePost)||null==(t=n.images)?void 0:t.length:void 0}},y=function(e,t){var n,i,l=(0,v.k)(e),c=(0,u.nW)(function(e){var t;return e.users[null!=(t=null==l?void 0:l.author)?t:""]},a.bN),s=null!=(n=null==l?void 0:l.video)?n:{},f=s.width,_=s.height,y=s.duration,h=s.ratio,g=(0,d.F3)(),m=(0,r.useMemo)(function(){return Object.keys(g)},[g]),b=(0,p.bE)(m,t),P=null!=l?l:{},T=P.createTime,k=P.authorStats,C=(void 0===k?{}:k).followerCount,E=void 0===C?0:C,S=P.stats,R=void 0===S?{}:S,w=R.diggCount,A=R.playCount,I=void 0===A?0:A,M=R.shareCount,O=R.commentCount,L=R.collectCount;return{video_freshness:(0,o.QR)(Number(void 0===T?0:T)),video_duration:void 0===y?0:y,video_like_history:void 0===w?0:w,video_vv_history:I,video_share_history:void 0===M?0:M,video_comment_history:void 0===O?0:O,video_favorite_history:Number(void 0===L?0:L),video_resolution:(0,o.sG)(void 0===h?"":h),video_is_portrait:+((void 0===_?0:_)>(void 0===f?0:f)),video_100k_vv:+(I>=1e5),video_creator_bluev:null!=(i=null==c?void 0:c.verified)&&i?1:0,video_creator_1k_follower:+(E>=1e3),video_creator_10k_follower:+(E>=1e4),video_creator_100k_follower:+(E>=1e5),video_next_info:JSON.stringify(b)}},h=function(e){var t,n=(0,v.k)(e),r=null!=(t=null==n?void 0:n.video)?t:{};return{video_width:r.width,video_height:r.height,video_duration:r.duration}},g=function(e){var t,n=e.id,r=e.play_mode,a=void 0===r?i.Tk.OneColumn:r,o=(null!=(t=(0,c.W)(function(){return["wid"]},[]))?t:{}).wid,u=(0,v.k)(n),d=null==u?void 0:u.ad_info;if(d){var s=(0,l.n5)({ad_info:d,play_mode:a});return s.ad_extra_data={user_session:o},s}},m=function(e,t){var n;if(t)return null!=(n=null==e?void 0:e.isPinnedItem)&&n},b=function(e){var t,n,r,a;return"v0"!==(null!=(n=(0,s.d)("page_stability_opt"))?n:"v0")?!!(null==e||null==(r=e.AnchorTypes)?void 0:r.some(function(e){return"33"===e.toString()}))&&!(null==e||null==(a=e.video)?void 0:a.playAddr):!!(null==e||null==(t=e.AnchorTypes)?void 0:t.some(function(e){return"33"===e.toString()}))&&!e.video.playAddr}},80567:function(e,t,n){n.d(t,{Az:function(){return o},Dr:function(){return a},H4:function(){return l}});var r=n(71952),a=function(e){return e===r.s.VideoRMask||e===r.s.VideoRiskMask},o=function(e){if(isNaN(e))return"00:00";var t=Math.floor(e/3600),n=(t<10?"0":"")+t.toString(),r="0".concat(Math.floor(e/60%60)).slice(-2),a="0".concat(Math.floor(e%60)).slice(-2);return 0===t?"".concat(r,":").concat(a):"".concat(n,":").concat(r,":").concat(a)},i=new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),l=function(e,t){if(!e)return t;if(String(e).indexOf("xgpreload_config")>-1)return e;if(!i.has(Number(e))){var n=String(e).match(/^([a-zA-Z]*)+_([0-9]+)_0$/i);return n?"".concat(n[1],"_").concat(n[2],"p"):"unknown_".concat(e)}return i.get(Number(e))}},45797:function(e,t,n){n.d(t,{e:function(){return a}});var r=n(69513),a=(0,n(82761).$)("CoreContentContext@tiktok/fe-shared")({armCoreContentEvent:r.A})},40654:function(e,t,n){n.d(t,{K:function(){return g},v:function(){return m}});var r=n(73628),a=n(35383),o=n(70991),i=n(88840),l=n(20746),u=n(22481),d=n(40053),c=n(66693),s=n(41166),v=function(){try{var e,t=(0,u._S)(o.ne)||"{}",n=JSON.parse(t),r=new Date().toLocaleDateString("en-US"),a=Object.keys(n[r]||{})[0];if(!a||!(null==(e=n[r])?void 0:e[a]))return;var i=n[r][a];return i.vv>0?60*i.play_duration/i.vv:0}catch(e){console.error("Error getting avg_play_duration from feature store:",e);return}},p=function(){var e=(0,s.V)().maybeTriggerInference,t=(0,r.useCallback)(function(){i.q.handleEnterExplore({enter_method:l.c.SPFCTAExplore}),window.location.href="/explore"},[]);return{triggerInferenceBasedOnVideoView:(0,r.useCallback)(function(n){try{var r=v(),o=(0,u._S)("w_g_vv"),i=o?parseInt(o,10):0;if(i>5){var l=(0,a._)({},d.Y.REDIRECT_TO_EXPLORE_PAGE,t);n&&(l[d.Y.LOGIN_FOR_BETTER_RECOMMENDATION]=n),e(c.ey.HIGH_VV_COUNT,l)}else i>=3&&void 0!==r&&r<2&&e(c.ey.LOW_ENGAGEMENT,(0,a._)({},d.Y.REDIRECT_TO_EXPLORE_PAGE,t))}catch(e){console.error("Error triggering LLM inference based on video view:",e)}},[e,t])}},f=n(58034),_=n(53069),y=n(31349),h=n(21057),g=function(e){var t=(0,_.nr)().updateGlobalVVCount,n=(0,y.eu)(),a=p().triggerInferenceBasedOnVideoView,o=(0,h.G)({modalConfig:{query:{enter_method:"spf_cta_recommend"}}}),i=(0,r.useCallback)(function(){t(e),a(o)},[t,e,a,o]),l=(0,r.useCallback)(function(){(e===f.ey.VideoDetail||e===f.ey.BrowserMode&&n)&&(t(e),a(o))},[t,e,n,a,o]);return(0,r.useMemo)(function(){return{handleBreakCount:i,handleVvCountOnEnd:l}},[i,l])},m=function(e){var t=(null==e?void 0:e.UrlList)||[];return t.length<1?null:t}},76576:function(e,t,n){n.d(t,{K:function(){return v}});var r=n(5377),a=n(45996),o=n(51070),i=n(73628),l=n(2909),u=n(96187),d=n(49339),c=n(8631),s=(0,l.Rq)({resolved:{},chunkName:function(){return"video-player"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("2075").then(n.bind(n,14015))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return t.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 14015}},(0,r._)({},u.TN)),v=(0,i.memo)((0,i.forwardRef)(function(e,t){var n=(0,i.useRef)(null);(0,i.useImperativeHandle)(t,function(){return{play:function(e){var t,r;(null==(t=n.current)?void 0:t.play)&&(null==(r=n.current)||r.play(e))},pause:function(){var e,t;(null==(e=n.current)?void 0:e.pause)&&(null==(t=n.current)||t.pause())},seek:function(e){var t,r;(null==(t=n.current)?void 0:t.seek)&&(null==(r=n.current)||r.seek(e))},seekTime:function(e){var t,r;(null==(t=n.current)?void 0:t.seekTime)&&(null==(r=n.current)||r.seekTime(e))},onSeeked:function(e){var t,r;(null==(t=n.current)?void 0:t.onSeeked)&&(null==(r=n.current)||r.onSeeked(e))},onSeeking:function(e){var t,r;(null==(t=n.current)?void 0:t.onSeeking)&&(null==(r=n.current)||r.onSeeking(e))},onTimeUpdate:function(e){var t,r;(null==(t=n.current)?void 0:t.onTimeUpdate)&&(null==(r=n.current)||r.onTimeUpdate(e))},getFullscreen:function(e){var t;null==(t=n.current)||t.getFullscreen(e)},exitFullscreen:function(e){var t;null==(t=n.current)||t.exitFullscreen(e)},replay:function(){var e,t;(null==(e=n.current)?void 0:e.replay)&&(null==(t=n.current)||t.replay())},updatePlayer:function(e){var t,r;(null==(t=n.current)?void 0:t.updatePlayer)&&(null==(r=n.current)||r.updatePlayer(e))},changeResolution:function(e){var t,r;(null==(t=n.current)?void 0:t.changeResolution)&&(null==(r=n.current)||r.changeResolution(e))},getResolutionInfo:function(){var e;return null==(e=n.current)?void 0:e.getResolutionInfo()},get currentTime(){var e,t;return null!=(t=null==(e=n.current)?void 0:e.currentTime)?t:0},get duration(){var r,a;return null!=(a=null==(r=n.current)?void 0:r.duration)?a:0},get currentCanPlay(){var o,i;return null!=(i=null==(o=n.current)?void 0:o.currentCanPlay)&&i},get paused(){var l;return null==(l=n.current)?void 0:l.paused}}});var l=(0,d.Sc)(),u=l.isUseNativePlayer,v=l.adaptBitrateVid;return u?(0,o.Y)(s,(0,a._)((0,r._)({},e),{ref:n})):(0,o.Y)(c.A,(0,a._)((0,r._)({},e),{adaptBitrateVid:v,ref:n}))}))},80191:function(e,t,n){n.d(t,{CZ:function(){return c},Ec:function(){return u},K3:function(){return d},Le:function(){return i},R:function(){return l}});var r=n(30418),a=n(58034),o=n(90947),i=(0,r.default)("div",{target:"e1sq7r4z0",label:"7937d88b--DivContainer"})(function(e){var t=e.horizontal,n=e.mode,r=e.theme.colors;return[{width:"100%",height:"100%",overflow:"hidden",position:"relative",backgroundColor:n===a.ey.ThreeColumn?r.BGPlaceholderOpaque:r.BGPlaceholderDefault,backgroundSize:t?"contain":"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},n===a.ey.BrowserMode||n===a.ey.ThreeColumn||n===a.ey.FullscreenMode&&{display:"flex",alignItems:"center",justifyContent:"center"}]}),l=(0,r.default)("img",{target:"e1sq7r4z1",label:"7937d88b--ImgPoster"})(function(e){var t=e.horizontal,n=e.mode,r=e.fetchPriority,o=void 0===r?"auto":r;return n!==a.ey.BrowserMode&&n!==a.ey.VideoDetail&&n!==a.ey.FullscreenMode?{width:"100%",height:"100%",objectFit:"cover",fetchPriority:o}:{width:"100%",height:"100%",objectFit:t?"contain":"cover",fetchPriority:o}}),u=(0,r.default)("div",{target:"e1sq7r4z2",label:"7937d88b--DivBasicPlayerWrapper"})(function(e){var t=e.horizontal,n=void 0===t||t;return{position:"absolute",left:0,top:0,width:"100%",height:"100%","& .xgplayer video":{display:"block",width:"100%",height:"100%",objectFit:n?"contain":"cover"},"& .tiktok-web-player video":{display:"block",width:"100%",height:"100%",objectFit:n?"contain":"cover"}}}),d=(0,r.default)(o.R,{target:"e1sq7r4z3",label:"7937d88b--StyledLoading"})({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}),c=(0,r.default)("video",{target:"e1sq7r4z4",label:"7937d88b--VideoBasic"})(function(e){return{display:"block",width:"100%",height:"100%",objectFit:e.horizontal?"contain":"cover"}})},8631:function(e,t,n){n.d(t,{A:function(){return eY}});var r=n(5377),a=n(45996),o=n(16327),i=n(6586),l=n(51070),u=n(69513),d=n(32224),c=n(73628),s=n(43919),v=n(75835),p=n(75766),f=n(36413),_=n(33751),y=n(65362),h=n(79066),g=n(72516),m=n(31432),b=n(93787),P=n(89111),T=n(90432),k=n(58034),C=n(53069),E=n(27392),S=n(15275),R=n(40979),w=n(94805),A=n(81269),I=n(41386),M=n(54333),O=n(90513),L=n(39131),D=n(94179),V=n(72615),N=n(19611),x=n(95357),F=n(35617),H=n(29964);function U(e,t,n){try{if(!e)return"";var r=new URL(e).host;if(t.filter(function(e){return e===r}).length>0)return"anonymous";if(n.filter(function(e){return e===r}).length>0)return"use-credentials";return""}catch(e){return""}}var B={player_type:"playerType",video_play_mode:"videoPlayMode",preloader:"preloader",muted:"muted",format:"format"},G=null;function q(e,t){var n,r,a,o,i,l,u,d,c,s,v,p,f=null!=(c=null==e||null==(n=e.element)?void 0:n.error)?c:null,_=null==e||null==(r=e.element)?void 0:r.buffered,y=null==e?void 0:e.currentTime,h=null==e?void 0:e.type,g=(null==e?void 0:e.curDefinition)||{};return{buffered:_,currentTime:y,ended:null==e||null==(a=e.element)?void 0:a.ended,currentSrc:null!=t?t:null==e||null==(o=e.element)?void 0:o.currentSrc,duration:null==e?void 0:e.duration,readyState:null==e||null==(i=e.element)?void 0:i.readyState,networkState:null==e||null==(l=e.element)?void 0:l.networkState,error:f?{code:null==f?void 0:f.code,message:null!=(s=null==e||null==(u=e.element)?void 0:u.error)?s:(null==f?void 0:f.message)||"UNKNOWN_ERROR_MESSAGE",MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4}:null,playerType:h,volume:null==e?void 0:e.volume,muted:null==e?void 0:e.muted,videoBitrate:null==g?void 0:g.bitrate,videoQuality:null==g?void 0:g.definition,codecType:null!=(v=null==g?void 0:g.codecType)?v:"h264",play_url:null!=(p=null==e||null==(d=e.element)?void 0:d.currentSrc)?p:t}}function Q(e,t){!A.r.level||(0,y.fU)()||(window[e]=t)}function W(){return{enableReuse:!1,enableMultiple:!0,minBuffer:0,defaultMSE:!1}}var z=null,Y=null,K=[];m.a.register(s.P.XG,new H.u,L.a),m.a.register(s.P.NEW_TT,new F.V,L.a);var j={group1:["v16-webapp.tiktok.com","v16m-webapp.tiktokcdn-us.com"],group2:["v16-webapp-prime.tiktok.com","v16-webapp-prime.us.tiktok.com","v19-webapp-prime.us.tiktok.com"]};function X(e,t,n){if(t.length>0){K=[],t.forEach(function(e){K.push(e)}),m.a.clearTask(e);var r=t.map(function(e,t){return{order:t,data:e}});m.a.addPreloadList(r,e)}}function J(e,t){m.a.changeCodec(t,e)}var $=function(e){return U(e.url,j.group1,j.group2)===w.uJ?{credentials:"include"}:{}},Z=function(e,t){var n=t.playerPreload,o=t.playerUpgrade,i=t.playerUpgradePreload,l=t.playerDemux,u=t.preloadType,d=null==o?void 0:o.preload;m.a.update((0,a._)((0,r._)({getRequestOptionsCallback:$},n,d,null==i?void 0:i.preloaderConfig,null==l?void 0:l.preloaderConfig),{preloadType:void 0===u?0:u}),e),(0,_.as)((null==n?void 0:n.maxQueueCount)||3),A.r.level>0&&(window.MultiMediaPreloader=m.a)};function ee(e){return e===s.R.ACTIVE}var et=function(e){e&&N.DS.setCustomTracker({event:function(e,t){T.f.event(e,t)}})},en=function(e){var t=e.config.H264DefinitionList;if(t&&t.length>0){var n=t[0];return e.emit("playCatch","MP4_3",{errorCode:8200,message:"width and height is 0"}),e.setConfig({defaultBitrate:n.bitrate,defaultDefinition:n.definition,url:n.url,codecType:n.codecType}),e.src=n.url,e.play(),!0}return!1};function er(e){return e?(0,I._)(e,Array)?e.length>0?e[0]:"":e:""}function ea(e,t,n){var r,a=(null==e?void 0:e.playerOpenMse)||"v0",o=null==e||null==(r=e.previewConfig)?void 0:r.videoPlayMode;return n&&o?o:"v1"===a||"v2"===a?s.V.MSE:(null==t?void 0:t.videoPlayMode)||s.V.AUTO}function eo(e){return"three_column"===e}function ei(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e?(0,M._)(t).concat((0,M._)(n)):t}function el(e,t){return("v1"===e||"v2"===e)&&(!!t&&"h265"===t.codec||!!p.a.canUseHevc("v2"===e?1:2))}var eu=["video_detail","homepage_hot"];function ed(e,t){var n=e.format,r=void 0===n?s.c.MP4:n,a=e.disablePreview,o=void 0===a?0:a,i=t.playMode,l=t.playerType,u=t.isPlayback;return"three_column"===i&&(o>=2||o>0&&(void 0===u||u))||l!==s.P.NEW_TT?s.c.MP4:r}var ec=n(32753),es={color:"#fff",backgroundColor:"#2a9d1f",position:"absolute",zIndex:2,top:"30px"},ev=function(e){if(!e)return{};var t=e.format,n=e.renderState,r=e.resolution,a=e.playerType;return{render_state:void 0===n?"":n,video_type:void 0===t?"":t,video_quality:void 0===r?"":r,codec_format:e.codecType,player_type:void 0===a?"":a}},ep=(0,c.memo)((0,c.forwardRef)(function(e,t){var n=e.containerId,o=e.classList,i=e.player,u=e.bitrateInfo,d=e.oncanplay,v=e.onplay,f=e.onwaiting,h=e.onended,g=e.ontimeupdate,m=e.onloadstart,b=e.onloadeddata,P=e.onvolumechange,k=e.onVideoPlayEnd,C=e.onResolutionReady,E=e.onerror,w=e.onpause,I=e.onplaying,M=e.onbreak,O=e.onseeking,L=e.onseeked,D=e.onloadedmetadata,V=e.subtitle,N=e.teaParams,x=e.videoDimensionParams,F=e.mode,H=e.id,U=e.containerRef,B=e.hitPreload,G=e.eventTrigger,q=(0,c.useRef)(!1),Q=(0,c.useMemo)(function(){var e,t={};if(!N)return t;var n=null==i?void 0:i.attributes,r=ec.qd.Public;N.forFriend&&(r=ec.qd.Friend),N.secret&&(r=ec.qd.Self);var a="";if(null==n?void 0:n.src){var o=n.src.match(/^(?:https?:\/\/)?([^\/\s:]+)/);a=o?o[1]:""}var l={group_id:H,author_id:N.author_id||"",play_mode:(0,ec.AI)(F),logo_type:"unwatermarked",item_status:r,play_url:n?n.src:"",host:a,aweme_type:N.aweme_type||0,pic_cnt:N.pic_cnt||0,playlist_id:N.playlist_id||"",popup_type:N.popup_type||"",size:N.size,log_id:N.log_id||"none",is_ad:N.isAd,video_width:x?x.video_width:0,video_height:x?x.video_height:0,video_duration:x?x.video_duration:0,player_type:(null==i?void 0:i.playerType)||""},u=p.M.getDeviceScore(),d=u.dScore,c=u.netScore,s=null==(e=z||Y)?void 0:e.device;return Object.assign({},{cpu_core:(null==s?void 0:s.cpu)||0,memory_size:(null==s?void 0:s.memory)||0,HEVC_supported:+(null!=s&&!!s.isHEVCSupported),hardware_score:d,network_score:c},l)},[N,x,H,F]),W=(0,c.useRef)(0),K=(0,c.useCallback)(function(){if(!i||!N)return null;var e=i.curDefinition||{};return(0,ec.H4)(e.definition,N.definition)},[i,N]),j=(0,c.useCallback)(function(){return i&&N&&(i.curDefinition||{}).bitrate||0},[i,N]),X=(0,c.useCallback)(function(){return i&&N?(i.curDefinition||{}).codecType:null},[i,N]),J=(0,c.useCallback)(function(){var e="";if(!N)return e;var t=K();return N.videoQuality&&t&&(e="".concat(N.videoQuality,"_").concat(t)),e},[N,K]),$=(0,c.useCallback)(function(){var e={};if(N){var t,n=j(),r=X(),a=J(),o=(0,_.ZQ)(),l=(null==i?void 0:i.state)||"default";H&&(t=o.getPreloadCacheInfo(H)),e.video_bitrate=n||N.bitrate,e.video_format=N.format,e.codec_format=r||"h264",e.encoded_type=N.encodedType,e.bitrate_quality=N.videoQuality,e.video_quality=a,e.video_encodeUserTag=N.encodeUserTag,e.original_definition=N.definition,e.preload_size=t?t.byteLength:-1,e.preload_time=t?Math.floor(t.duration):-1,e.player_type=i?i.type:"defaultPlayer",e.video_type="mp4",e.render_state=l}return e},[N,K,j,X,J,H,i]),Z=(0,c.useCallback)(function(){var e=X();return e||(e="h264"),!!e&&e.indexOf("h265")>-1},[X]),ee=(0,c.useCallback)(function(e){if((0,S.uQ)(R.Y.VideoRequest),Q&&1!==F){var t=ev(e);T.f.event(ec.zD.Request,(0,r._)({},Q,t))}},[Q,F]),et=(0,c.useCallback)(function(e){if(Q&&1!==F&&i){var t,n=ev(e),r=$(),a=Z(),o=0;i.attributes&&(t=i.attributes.error,o=i.attributes.duration);var l=e.code||0,u=e.message||"";l<=0&&t&&(l=t.code,u=t.message);var d=Object.assign({},r,{error_code:String(l),error_info:u,is_bytevc1:+!!a,duration:Math.round(1e3*o),isExpired:e.isExpired||0,isSupportMP4:Number((0,y.vk)()),is_before:+(0!==e.status),retry_c:e.retryCount||0,retry_l:e.retryList||[]},Q,n);T.f.event(ec.zD.PlayFailed,d)}},[Q,$,Z,F]),en=(0,c.useCallback)(function(e){if(null==M||M(),Q&&1!==F){var t,n,o=ev(e),l=$(),u=Z(),d=0,c=e.currentTime,s=0,v=1,p=!1,f=e.duration-e.pauseDuration;(null==i?void 0:i.attributes)&&(t=i.attributes.error,d=i.attributes.duration||0,s=i.attributes.readyState,n=i.attributes.buffered,v=i.attributes.volume,p=i.attributes.muted);var _=Math.min(f,1e3*d),y=j();y<=0&&(y=(null==N?void 0:N.bitrate)?N.bitrate:0);var h=null==e?void 0:e.costTimes,g=y/8*(_/1e3),m=Object.assign({},l,{is_success:t?"0":"1",video_duration:Math.round(1e3*d),play_duration:Math.round(1e3*c),buffering:+(s<=2),duration:Math.round(f),wait_duration:0,cur_cache_duration:(0,ec.L8)(n),local_time_ms:Date.now(),volume_level:v,volume_change:0,muted:+!!p,click_mute:0,session_order:0,play_size:Math.round(g),data_player_type:2,cache_size:0,cache_duration:0,cdn_size_video:0,is_bytevc1:+!!u,drop_frame:0,total_play_frame:0,drop_frame_rate:0,drop_frame_duration:0,cost_times:h,end_state:null==e?void 0:e.endState},Q,o),b=(0,ec.Ug)(i),P=(0,a._)((0,r._)({vid:H,playPos:Math.round(1e3*c),stayDuration:(null==h?void 0:h.stay_dur)||0,videoQuality:1},b),{logid:(null==N?void 0:N.log_id)||"nonw",endState:null==e?void 0:e.endState,costTimes:h});null==k||k(P),T.f.event(ec.zD.PlayEnded,m)}},[Q,$,Z,j,N,F]),er=(0,c.useCallback)(function(e){if((0,S.uQ)(R.Y.VideoFirstFrame),Q&&1!==F){var t=ev(e),n=Object.assign({},{feed_total:e.duration},Q,t),a=(0,S.xt)();T.f.event(ec.zD.FirstFrame,(0,r._)({},n,a))}},[Q,F]),ea=(0,c.useCallback)(function(e){if(Q&&1!==F){var t=0,n=!1;(null==i?void 0:i.attributes)&&(t=i.attributes.duration,n=i.attributes.muted);var r=Z(),a=Object.assign({},$(),{duration:Math.round(e.duration),is_bytevc1:+!!r,video_duration:Math.round(1e3*t),muted:+!!n,bitrate_set:(0,ec.OK)(u),quality_bitrate:(0,ec.n2)(u),duration_from_load:Math.round((null==e?void 0:e.durationFromLoaded)||0),duration_with_load:Math.round((null==e?void 0:e.durationWithLoaded)||0),is_same:0,retry_c:e.retryCount||0,retry_l:e.retryList||[]},Q);T.f.event(ec.zD.PlayQuality,a)}},[Q,Z,u,$,F]),eo=(0,c.useCallback)(function(e){if(Q&&1!==F&&(null==i?void 0:i.state)===s.R.ACTIVE){var t=ev(e),n=$(),r=0;(null==i?void 0:i.attributes)&&(r=i.attributes.currentTime);var a=Z(),o=Object.assign({},n,{duration:Math.round(e.duration),is_bytevc1:+!!a,position:Math.round(1e3*r),should_filter:"0",droppedRate:0,end_type:0,block_type:W.current},Q,t);T.f.event(ec.zD.Block,o)}},[Q,Z,$,F]),ei=(0,c.useCallback)(function(e){e.preventDefault()},[]),el=(0,c.useCallback)(function(){(0,S.uQ)(R.Y.VideoCanPlay),null==d||d()},[d]),eu=(0,c.useCallback)(function(e){null==m||m(e)},[m]),ed=(0,c.useCallback)(function(e){null==b||b(e)},[b]),ep=(0,c.useCallback)(function(e){null==v||v(e),q.current=!0},[v]),ef=(0,c.useCallback)(function(e){null==f||f(e)},[f]),e_=(0,c.useCallback)(function(e){null==h||h(e)},[h]),ey=(0,c.useCallback)(function(){2>((null==i?void 0:i.readyState)||0)&&"v1"===G||null==g||g()},[g,i,G]),eh=(0,c.useCallback)(function(e){null==E||E(e)},[E]),eg=(0,c.useCallback)(function(e){null==w||w(e)},[w]),em=(0,c.useCallback)(function(e){q.current||(null==v||v(e),q.current=!0),null==I||I(e)},[I]),eb=(0,c.useCallback)(function(e){null==L||L(e)},[L]),eP=(0,c.useCallback)(function(e){null==O||O(e)},[O]),eT=(0,c.useCallback)(function(e){null==D||D(e)},[D]),ek=(0,c.useCallback)(function(e){null==P||P(e)},[P]),eC=(0,c.useCallback)(function(e){e.id=H,null==C||C(e)},[C,H]);return(0,c.useEffect)(function(){return function(){(null==i?void 0:i.metrics)&&i.metrics.stop()}},[H]),(0,c.useEffect)(function(){if(null==i?void 0:i.metrics)return i.metrics.on("PlayEnded",en),function(){i.metrics&&i.metrics.off("PlayEnded",en)}},[en]),(0,c.useEffect)(function(){if(null==i?void 0:i.metrics)return i.metrics.on("VideoRequest",ee),i.metrics.on("Block",eo),i.metrics.on("PlayQuality",ea),i.metrics.on("PlayFailed",et),i.metrics.on("FirstFrame",er),i.element&&i.element.addEventListener("contextmenu",ei),i.event&&(i.event.on("canplay",el),i.event.on("play",ep),i.event.on("waiting",ef),i.event.on("ended",e_),i.event.on("timeupdate",ey),i.event.on("error",eh),i.event.on("pause",eg),i.event.on("playing",em),i.event.on("loadstart",eu),i.event.on("loadeddata",ed),i.event.on("volumechange",ek),i.event.on("resolutionReady",eC),i.event.on("seeking",eP),i.event.on("seeked",eb),i.event.on("loadedmetadata",eT)),function(){i.metrics&&(i.metrics.off("VideoRequest",ee),i.metrics.off("Block",eo),i.metrics.off("PlayQuality",ea),i.metrics.off("PlayFailed",et),i.metrics.off("FirstFrame",er),i.element&&i.element.removeEventListener("contextmenu",ei),i.event&&(i.event.off("canplay",el),i.event.off("play",ep),i.event.off("waiting",ef),i.event.off("ended",e_),i.event.off("timeupdate",ey),i.event.off("error",eh),i.event.off("pause",eg),i.event.off("playing",em),i.event.off("loadstart",eu),i.event.off("loadeddata",ed),i.event.off("volumechange",ek),i.event.off("resolutionReady",eC),i.event.off("seeking",eP),i.event.off("seeked",eb),i.event.off("loadedmetadata",eT)))}},[ep,el,ef,e_,ey,eh,eg,em,eu,ed,ee,eo,ea,et,er,ei,d,m,b,eC,eT,eb,eP,ek]),(0,l.FD)("div",{id:void 0===n?"":n,className:(void 0===o?[]:o).join(" "),ref:U,children:[V?(0,l.Y)("track",{default:!0,kind:"subtitles",srcLang:V.language,src:V.url}):null,A.r.level>0?(0,l.FD)("div",{style:es,children:[null==i?void 0:i.uuid,"_",null==i?void 0:i.state,B?"_hitPreload":""]}):null]})})),ef={playerReuse:"v0",playerPreload:{vid:"v0",maxQueueCount:3,preloadMaxCacheCount:5,preloadTime:10,segmentMinDuration:10,minBufferLength:10,startPreloadControl:!1,startPreloadMinBuffer:0,startPreloadMinPosTime:0},bitrateSelect:{vid:"v0",selector:"default",qualityType:20,hevcQualityType:14,config:{bitrateLower:2e5,bitrateRange:[2e5,15e5],bitrateUpper:2e6,mode:"buffer-info",paramBf:.3,paramBp:.5,paramLower:.6,paramUpper:1.5,paramUpperBl:.7,paramVl1:.8,paramVl2:3,paramVlLower:10,paramVlUpper:10,slidingWindowCountThreshold:30,slidingWindowExtraction:"weighted_median",slidingWindowType:"by_weight",slidingWindowWeight:"size",slidingWindowWeightThreshold:2e7}},playerUpgrade:{vid:"v0",playerType:"XG",preload:{},playerConfig:{},maxCacheCount:5},playerH265Soft:{vid:"v0",enableSoftwareH265:0,config:void 0},playerDash:{vid:"v0",format:"MP4"},playerOpenMse:"v0",eventTrigger:"v0",playerHevc:"v0",audioEqualizer:{vid:"v0",enable:!1},playerHevcDevice:{vid:"v3",open:!0,dScore:0,vendor1:["Intel","AMD","NVIDIA","Apple"],qualityType:20,closePreload:!1}},e_={Chrome:{cpuCore:0,dScore:0,score:-2,gpuScore:0,hevcQualityType:14,checkLevel:2,pageNames:["video_detail","homepage_hot","homepage_follow","others_homepage","explore_page"],playModes:["video_detail","one_column","browser_mode","immersive_player","three_column"]},Edge:{cpuCore:0,dScore:0,score:-2,gpuScore:0,hevcQualityType:14,checkLevel:2,pageNames:["video_detail","homepage_hot","homepage_follow","others_homepage","explore_page"],playModes:["video_detail","one_column","browser_mode","immersive_player","three_column"]}},ey="PlayerLife",eh="PlayerCall",eg=(0,c.memo)((0,c.forwardRef)(function(e,t){var n,o=e.id,u=e.url,d=e.mode,f=e.muteSetting,I=e.playProgress,M=e.duration,L=e.playbackRate,N=void 0===L?1:L,F=e.onLoadStart,H=e.onLoadedData,es=e.onCanPlay,ev=e.onPause,eg=e.onPlay,em=e.onPlaying,eb=e.onTimeUpdate,eP=e.onWaiting,eT=e.onEnded,ek=e.onError,eC=e.onUnmount,eE=e.onVideoChange,eS=e.onBreak,eR=e.onVideoVolumeChange,ew=e.onVideoPlayEnd,eA=e.onAutoplayPrevented,eI=e.onResolutionReady,eM=e.userResolution,eO=e.subtitleStruct,eL=e.subtitleList,eD=e.curSubtitle,eV=e.onSubtitleCallback,eN=void 0===eV?function(e){}:eV,ex=e.bitrateInfo,eF=e.defaultDefinition,eH=e.preloadUrlsList,eU=e.preloader,eB=e.defaultBitrate,eG=void 0===eB?-1:eB,eq=e.playerInitHost,eQ=e.teaParams,eW=e.autoPlay,ez=e.autoReplay,eY=void 0===ez||ez,eK=e.size,ej=e.pathId,eX=void 0===ej?"":ej,eJ=e.metrics,e$=e.playbackAbTestInfo,eZ=void 0===e$?ef:e$,e0=e.isTTP,e1=e.videoDimensionParams,e2=e.vIndex,e4=void 0===e2?-1:e2,e3=e.extInfo,e5=void 0===e3?{}:e3,e6=e.renderState,e7=void 0===e6?s.R.ACTIVE:e6,e8=e.urlList,e9=e.videoSource,te=(0,i._)((0,c.useState)(null),2),tt=te[0],tn=te[1],tr=(0,c.useRef)(null),ta=(0,c.useRef)(new Date().getTime()),to=(0,c.useRef)(!1),ti=(0,c.useRef)(0),tl=(0,c.useRef)(null),tu=(0,c.useRef)(),td=(0,c.useRef)(null),tc=(0,c.useRef)(function(){if(G)return G;for(var e={playerType:"",videoPlayMode:"",preloader:"",format:"",codec:""},t=(location.search||"").replace("?","").split("&"),n=0;n<t.length;n++){var r=t[n].split("=");void 0!==B[r[0]]&&(e[B[r[0]]]=r[1])}return G=e,e}()),ts=(0,c.useRef)(e7),tv=(0,c.useRef)(s.P.XG),tp=(0,c.useRef)(null),tf=(0,C.Ul)(),t_=(0,c.useRef)(!1),ty=(0,c.useRef)(null),th=(0,i._)((0,c.useState)(!1),2),tg=th[0],tm=th[1];eq&&(j=eq);var tb=(0,i._)((0,c.useState)(!1),2),tP=tb[0],tT=tb[1],tk=(n=(0,E.i3)(),d===k.ey.ThreeColumn?f:f||n),tC=(0,E.R4)(),tE=(0,E.S4)().setMute,tS=(p.M.setHevcTestData(ef.playerHevcDevice),p.M.checkHevcResult(!0)),tR=(0,c.useMemo)(function(){return(0,r._)({},eZ,A.r.playbackAbTestInfo)},[eZ]),tw=(0,c.useCallback)(function(e,t){(0,y.AX)(t)&&J(tv.current,s.C.H264)},[o,d,eX,td]),tA=(0,c.useCallback)(function(){null==eA||eA()},[o,d,eX]);(0,c.useEffect)(function(){var e;eU.setPreloadIndex(null!=(e=null==tf?void 0:tf.index)?e:0)},[tf]),(0,c.useEffect)(function(){var e,t,n=(0,ec.AI)(d);Z(tv.current,tR),p.M.playMode=n,p.M.pageName=eX,p.a.getInstance().needPersist=!0,p.M.setHevcEffectiveConditions(e_),tS=p.M.checkHevcResult(!0);var a=tR.playerReuse,o=tR.playerHevc,i=tR.playerPoolControl,l=el(void 0===o?"v0":o,tc.current),u=tS.open||l?s.C.H265:s.C.H264,c=tR.playerUpgrade,v=tR.playerDash;tv.current=function(e,t){if(t.playerType===s.P.NEW_TT||t.playerType===s.P.XG)return t.playerType;s.P.XG;return e===s.P.NEW_TT?s.P.NEW_TT:s.P.XG}((null==c?void 0:c.playerType)||s.P.XG,tc.current);var f=ed(v||{},{playMode:n,playerType:tv.current,isPlayback:!1});m.a.changeFormat(f,tv.current),e=tv.current,t=null,e===s.P.NEW_TT?(Y||(Y=new D.M(W())),t=Y):(z||(z=new V.M(W())),t=z),a&&t.setConfig((0,r._)({enableReuse:"v0"!==a,needReset:"v1"===a},void 0===i?{}:i)),tp.current=t,Q("_multimediaPool",tp.current),J(tv.current,u)},[]),(0,c.useEffect)(function(){var e=el(tR.playerHevc),t=tR.playerUpgrade,n=tS.open||e?s.C.H265:s.C.H264;if(tv.current===s.P.NEW_TT){var r=K;m.a.clearAll(s.P.NEW_TT),(null==t?void 0:t.closePreload)||!r||X(tv.current,r,o);var a=null==tl?void 0:tl.current;a&&m.a.attachPlayer(a,tv.current),J(tv.current,n)}else J(tv.current,n);(0,y.Tb)(eh,"changePreloadCodec",o,n,tS.open)},[o,tS.open,tS.openSrc]);var tI=(0,c.useCallback)(function(e){var t,n=e.player;if(n){var r=n.element;(0,y.y8)(r)&&(en(n),J(tv.current,s.C.H264)),null==(t=tl.current)||t.off("loadedmetadata",tI)}},[o,d,eX,td]),tM=function(e){(0,y.Tb)(eh,"handlerPreloadInfoReady",e),(0,_.ZQ)().setPreloadCacheInfo(o,e),tm(!0)},tO=(0,c.useMemo)(function(){return eL&&eL.length>0?eL:[]},[eL]),tL=(0,c.useMemo)(function(){return eH.length},[o,eH]);(0,c.useEffect)(function(){var e,t=tR.playerPreload,n=tR.playerUpgrade,r="number"==typeof(e=(null==t?void 0:t.vid)||"v0")?e:"boolean"==typeof e?+!!e:0===e.indexOf("v")&&2===e.length?parseInt(e[1],10):parseInt(e,10),a=tv.current===s.P.NEW_TT?s.P.NEW_TT:s.P.XG;!(r>0)||(null==n?void 0:n.closePreload)||X(a,eH,o)},[o,tL]),(0,c.useEffect)(function(){var e,t,n,r,a;tO.length>0?(tu.current?tu.current.setSubTitles(tO):(tu.current=new b.S({subTitlesList:tO}),null==(e=tu.current)||e.on("update",function(e){eN(e)}),null==(t=tu.current)||t.on("change",function(e){eN(e)}),null==(n=tu.current)||n.on("error",function(e){eN(e)})),tl.current&&tu.current.attach(null==(r=tl.current)?void 0:r.element)):null==(a=tu.current)||a.switchOff()},[tO,o]),(0,c.useEffect)(function(){var e,t;eD?null==(e=tu.current)||e.switch(eD):null==(t=tu.current)||t.switchOff()},[eD,o]),(0,c.useEffect)(function(){tl.current&&(null==eJ||eJ.setPlayerType(tv.current))},[eJ,tt]),(0,c.useEffect)(function(){(0,y.Tb)(ey,"renderState",null==(e=tl.current)?void 0:e.uuid,o,e7,tk,tC);var e,t,n,r,a=e7,i=ts.current;if(tl.current){e7===s.R.BACKUP&&(a=s.R.RETAIN),ts.current=a,null==eJ||eJ.setRenderState(a,o),i===s.R.ACTIVE&&a!==s.R.ACTIVE&&(null==(r=tl.current)||null==(n=r.metrics)||n.stop());var l=tp.current;null==l||l.updatePlayer(tl.current,a),ee(a)&&eW&&(tl.current.play(),tl.current.forceAutoplay=!0),a!==s.R.ACTIVE?tl.current.pause():Q("__ttplayer",tl.current)}else e7===s.R.RETAIN&&(a=s.R.BACKUP),ts.current=a,null==eJ||eJ.setRenderState(a,o);(0,y.Tb)(ey,null==(t=tl.current)?void 0:t.uuid,o,"renderStateChange",o,"renderState:".concat(e7," preState:").concat(i," state:").concat(a," muted:").concat(tk," volume:").concat(tC," autoplay:").concat(eW),null==eJ?void 0:eJ.renderState)},[e7,eJ]),(0,c.useEffect)(function(){if(!tt){var e,t=p.M.playMode,n={vIndex:e4,extInfo:(0,a._)((0,r._)({},e5),{log_id:(null==eQ?void 0:eQ.log_id)||"none",is_ad:+(null!=eQ&&!!eQ.isAd)})},i=e8&&e8.length>0?e8:u,l=tv.current===s.P.NEW_TT,d={bitrate:eG,definition:eF,duration:M,codecType:s.C.H264,url:i,format:s.c.MP4,vtype:s.c.MP4,vid:o,bitrateList:[]},c=(0,v.$)(ex||[],d),f=function(e,t,n,o){var i,l,u,d,c,v,f,_,h,g,m,b,P,T,k,C,E,S,R,A,I,M,L,D,V,N,F,H,B,G,q,Q,W,z,Y,K,X,J,Z,ee,et,en,ec,es,ev,ep,ef,e_,ey,eh,eg,em,eb,eP,eT,ek,eC,eE,eS,eR,ew,eA,eI,eM,eO,eL,eD,eV,eN,ex,eF,eH,eU,eB,eG,eq,eQ,eW,ez,eY,eK,ej,eX,eJ,e$,eZ,e0,e1,e2,e4,e3,e5,e6;return e?(i=n.videoSource,l=n.id,u=n.autoplay,d=n.teaParams,c=n.volume,v=n.muted,f=n.url,_=n.appLoggerParams,h=n.hevcResult,g=n.switchPlayerTime,m=n.userResolution,b=n.startTime,P=p.M.channelInfo,T=p.M.regionInfo,C=(k=o||{}).playerHevc,E=k.bitrateSelect,S=k.playerPreload,R=k.playerDash,A=k.playerUpgrade,I=k.audioEqualizer,M=k.playerRequest,L=k.playerStuck,D=k.previewConfig,V=k.playerSbp,N=k.playerDemux,F=k.playerAutoSeek,H=k.playerEos,B=el(C),G=(null==h?void 0:h.open)||B?"h265":"h264",q=i.bitrateList,Q=i.audioBitrateList,W=(0,O.OK)(q,Q),z="",f&&(z=U(er(f),j.group1,j.group2)),Y=z===w.uJ?{credentials:"include"}:{},K={channel:null==P?void 0:P.channel,channel_domain:null==P?void 0:P.domain,channel_type:null==P?void 0:P.type},X=eo(p.M.playMode),J=(null==T?void 0:T.region)||"",Z=(null==T?void 0:T.wid)||"",ee=(null==T?void 0:T.isLogin)||!1,et=(null==_?void 0:_.extInfo)||{},en=(R||{}).dashParserConfig,ec=ed(R||{},{playMode:p.M.playMode,playerType:s.P.NEW_TT,isPlayback:!0}),es=ea(o,t,X),ev=(null==A?void 0:A.playerConfig)||(null==A?void 0:A.multiplexConfig)||{fallback:ec!==s.c.DASH},N&&(ev=Object.assign({},ev,N.multiplexConfig||{})),V&&(ev=Object.assign({},ev,V.multiplexConfig||{})),H&&(ev=Object.assign({},ev,H.multiplexConfig||{})),M&&(ev.loaderOptions=Object.assign({},ev.loaderOptions,M.loaderOptions)),(null==F?void 0:F.vid)==="v1"&&(ev.autoSeekWhenWaiting=!0),L&&(ev.loaderOptions=Object.assign({},ev.loaderOptions,L.loaderOptions)),"AUTO"===es&&(ev.fallback=!0),ep=(null==A?void 0:A.mp4ParserConfig)||{},ef=(null==A?void 0:A.maxCacheCount)||0,e_={selector:(null==E?void 0:E.selector)||"default",selectConfig:(null==E?void 0:E.config)||{},quality:(null==E?void 0:E.qualityType)||20,hevcQuality:(null==E?void 0:E.hevcQualityType)||14,defaultMaxBitrate:(null==d?void 0:d.isHDSelfView)||!1},ey=ei(X,null==E?void 0:E.disableResolutions,null==D?void 0:D.disableResolutions),eh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0;if(null!==t&&n){var r=n.pIndex||-1;if(t>=0&&r>=0&&t<=r&&eu.includes(e))return n}}(p.M.pageName,null==_?void 0:_.vIndex,null==E?void 0:E.playSelector),(0,y.Tb)("generatePlayerConfigTT",l,eh,X,es,i,q,e_,ey),eg=p.a.getHevcDisableInfo(),{playerType:"NEW_TT",playerConfig:{autoplay:void 0===u||u,volume:c,muted:v,playbackRate:1,codecType:G,vtype:ec,format:ec,startTime:b||0,crossOrigin:z,mp4EncryptPlayer:{closeDowngrade:!1,minBufferLength:10,maxBufferLength:30,needPreloadRangeList:!0,needPreloadCheck:!0,needAutoBitrate:!0,removeBufferLen:60,resumePlayWaterLevel:0,segmentMinDuration:10,reqOptions:Y,getRequestOptionsCallback:$},getRequestOptionsCallback:$},strategyConfig:{enableSubtitle:!0,enablePreloader:(null==t?void 0:t.preloader)!=="0",enableLogger:!0,preloaderConfig:(0,a._)((0,r._)({minBufferLength:10,preloadCacheType:1,preloadMaxCacheCount:5,preloadTime:10,preloadSize:209715,segmentMinDuration:10,reqOptions:Y},void 0===S?{}:S),{getRequestOptionsCallback:$}),playSelector:eh,bitrateAdapter:(0,a._)((0,r._)({},e_),{hevcQuality:14,quality:20,userSelectResolution:m||"auto"}),videoPlayMode:es,multiplexConfig:ev,mp4ParserConfig:ep,dashParserConfig:en,maxCacheCount:ef,audioEqualizer:{enable:(null==I?void 0:I.enable)||!1,targetLoudness:(null==I?void 0:I.targetLoudness)||0},hevcDisableResolution:ey},videoInfo:(0,r._)({},i),loggerParams:{lineAppId:1988,playerCoreVersion:"",codec_type:G,tag:p.M.pageName,preTag:p.M.prePageName,preSubtag:p.M.prePlayMode,subtag:p.M.playMode,vid:l,region:J,webId:Z,uid:(null==T?void 0:T.uid)||Z,isLogin:ee,channelConfig:K,switchPlayerTime:g,bitrateSet:W,pIndex:(null==_?void 0:_.vIndex)||-1,ext:(0,a._)((0,r._)({},et,eg),{log_id:(null==d?void 0:d.log_id)||"",is_ad:+(null!=d&&!!d.isAd),self_view:+(null!=d&&!!d.isHDSelfView)}),deviceScore:p.b.shortData,strategyVersion:x.v},envInfo:{tag:p.M.pageName,subtag:p.M.playMode,preTag:p.M.prePageName,preSubtag:p.M.prePlayMode,isLogin:ee}}):(em=n.videoSource,eb=n.id,eP=n.autoplay,eT=n.teaParams,ek=n.volume,eC=n.muted,eE=n.url,eS=n.appLoggerParams,eR=n.hevcResult,ew=n.switchPlayerTime,eA=n.userResolution,eI=n.startTime,eM=p.M.channelInfo,eO=p.M.regionInfo,eL=er(eE),eD=el(null==o?void 0:o.playerHevc),eV=(null==eR?void 0:eR.open)||eD?"h265":"h264",eN="".concat(eb),ex=em.bitrate,eF=em.definition,eU=void 0===(eH=em.bitrateList)?[]:eH,eB=em.audioBitrateList,eG=em.duration,eq=em.volumeInfo,eQ=(0,O.OK)(eU,void 0===eB?[]:eB),eW="",eL&&(eW=U(eL,j.group1,j.group2)),ez=eW===w.uJ?{credentials:"include"}:{},eY={channel:null==eM?void 0:eM.channel,channel_domain:null==eM?void 0:eM.domain,channel_type:null==eM?void 0:eM.type},eK=(null==eO?void 0:eO.region)||"",ej=(null==eO?void 0:eO.wid)||"",eX=(null==eO?void 0:eO.isLogin)||!1,eJ=(null==o?void 0:o.playerPreload)||{},e$=(null==eS?void 0:eS.extInfo)||{},eZ=null==o?void 0:o.bitrateSelect,e0=null==o?void 0:o.previewConfig,e2=ea(o,t,e1=eo(p.M.playMode)),e4={selector:(null==eZ?void 0:eZ.selector)||"default",selectConfig:(null==eZ?void 0:eZ.config)||{},quality:(null==eZ?void 0:eZ.qualityType)||20,hevcQuality:(null==eZ?void 0:eZ.hevcQualityType)||14,defaultMaxBitrate:(null==eT?void 0:eT.isHDSelfView)||!1},e3=ei(e1,null==eZ?void 0:eZ.disableResolutions,null==e0?void 0:e0.disableResolutions),(0,y.Tb)("generatePlayerConfig",eF,eN,e1,eU,e4,e3),e5=p.a.getHevcDisableInfo(),e6={loudness:(null==eq?void 0:eq.loudness)||0,peak:(null==eq?void 0:eq.peak)||0},{enableSubtitle:!0,enablePreloader:(null==t?void 0:t.preloader)!=="0",enableLogger:!0,preloader:(0,a._)((0,r._)({minBufferLength:10,preloadCacheType:1,preloadMaxCacheCount:5,preloadTime:10,preloadSize:209715,segmentMinDuration:10,reqOptions:ez},eJ),{getRequestOptionsCallback:$}),mp4EncryptPlayer:{closeDowngrade:!1,minBufferLength:10,maxBufferLength:30,needPreloadRangeList:!0,needPreloadCheck:"MSE"!==e2,needAutoBitrate:!0,removeBufferLen:60,resumePlayWaterLevel:0,segmentMinDuration:10,h265Degrade:!0,reqOptions:ez,getRequestOptionsCallback:$},logger:{appId:548444,line_app_id:1988,playerCoreVersion:"",codec_type:eV,tag:p.M.pageName,preTag:p.M.prePageName,preSubtag:p.M.prePlayMode,subtag:p.M.playMode,vid:eb,region:eK,webId:ej,uid:(null==eO?void 0:eO.uid)||ej,isLogin:eX,channelConfig:eY,switchPlayerTime:ew,bitrateSet:eQ,pIndex:(null==eS?void 0:eS.vIndex)||-1,ext:(0,a._)((0,r._)({},e$,e5),{log_id:(null==eT?void 0:eT.log_id)||"",is_ad:+(null!=eT&&!!eT.isAd),self_view:+(null!=eT&&!!eT.isHDSelfView)}),deviceScore:p.b.shortData,strategyVersion:x.v},video:{codecType:eV,defaultBitrate:ex,defaultDefinition:eF,definitionList:[],duration:void 0===eG?0:eG,autoplay:void 0===eP||eP,volume:null!=ek?ek:.7,muted:eC||!1,vqscore:0,mvmaf:"",volumeInfo:e6},extra:{url:eL,actualUrl:eL,vid:eN,ignores:["play","start"],reqAuth:eW,closeMSE:!1,startTime:eI||0},hevcResult:eR,bitrateList:eU,bitrateAdapter:(0,a._)((0,r._)({},e4),{hevcQuality:14,quality:20,userSelectResolution:eA||"auto"}),hevcDisableResolution:e3})}(l,tc.current,{videoSource:e9||(0,a._)((0,r._)({},d),{bitrateList:c}),id:o,autoplay:eW,teaParams:eQ,volume:tC,muted:tk,url:i,appLoggerParams:n,vqscore:0,hevcResult:tS,switchPlayerTime:ta.current,userResolution:eM,startTime:I},tR);t_.current=!1,ty.current=null,tr.current=f;var _=tp.current,h=_.usePlayer(f,ts.current);_.mountDom(h,td.current);var g=tR.playerUpgrade;(null==g?void 0:g.closePreload)||X(tv.current,eH,o),(0,y.Tb)(ey,"usePlayer",h.uuid,o,"autoPlay:".concat(eW," volume:").concat(tC," mute:").concat(tk," playMode:").concat(t),f,t,eX,tS,"playProgress:".concat(I),e9),"three_column"===t&&(h.objectFit="cover"),h.on("playCatch",tw),h.on("autoplay_was_prevented",tA),h.on(w.Wu,tM),h&&(tl.current=h,null==(e=tu.current)||e.attach(h.player),tn("xgplayer")),et(1),_.setCustomTracker({event:function(e,t){(0,y.Tb)("VodLogger",e,t),T.f.event(e,t)}})}},[eK,o,u,d,eU,tE,eF,e0]);var tD=(0,c.useCallback)(function(e){null==eg||eg(e)},[eg]),tV=(0,E.VN)();(0,c.useImperativeHandle)(t,function(){var e=tl.current;return{play:function(){return(0,h._)(function(){var e,t,n,r;return(0,g.__generator)(this,function(a){switch(a.label){case 0:if((0,y.Tb)(eh,"play",null==(e=tl.current)?void 0:e.uuid,ts.current,!ee(ts.current),"paused:".concat(null==(t=tl.current)?void 0:t.paused," readyState:").concat(null==(n=tl.current)?void 0:n.readyState)),!tl.current||!ee(ts.current))return[2,Promise.resolve()];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==(r=tl.current)?void 0:r.play()];case 2:return a.sent(),[3,4];case 3:return console.info("Video play error: ",a.sent()),[3,4];case 4:return[2]}})})()},pause:function(){var e,t;(0,y.Tb)(eh,"pause",null==(e=tl.current)?void 0:e.uuid,ts.current);try{null==(t=tl.current)||t.pause(),P.A.emit("video_pause",{itemId:o,playMode:d})}catch(e){console.info("Video pause error: ",e)}},seek:function(t){if((0,y.Tb)(eh,"seek",t),e){P.A.emit("video_seek",{itemId:o,playMode:d});var n=e.duration;n&&tl.current&&tl.current.seek(n*t)}},seekTime:function(t){null==e||e.seek(t)},onSeeked:function(t){null==e||e.on("seeked",t)},onSeeking:function(t){null==e||e.on("seeking",t)},onTimeUpdate:function(t){null==e||e.on("timeupdate",function(){var n,r,a=null!=(n=null==e?void 0:e.currentTime)?n:0,o=null!=(r=null==e?void 0:e.duration)?r:0;t(a/o,a,o)})},onCanPlay:function(t){null==e||e.on("canplay",t)},getFullscreen:function(t){return(0,h._)(function(){return(0,g.__generator)(this,function(n){switch(n.label){case 0:return[4,null==e?void 0:e.enterFullscreen(t)];case 1:return n.sent(),[2]}})})()},exitFullscreen:function(t){return(0,h._)(function(){return(0,g.__generator)(this,function(n){switch(n.label){case 0:return[4,null==e?void 0:e.exitFullscreen(t)];case 1:return n.sent(),[2]}})})()},getPlayerAttributes:function(){return q(e,u)},replay:function(){(null==e?void 0:e.replay)&&(null==e||e.replay())},getPlaybackQuality:function(){var t;return null==e||null==(t=e.element)?void 0:t.getVideoPlaybackQuality()},updatePlayer:function(e){if(tl.current){var t;null==(t=tp.current)||t.updatePlayer(tl.current,e7)}},changeResolution:function(e){if(tl.current){var t;null==(t=tp.current)||t.changeResolution(tl.current,e)}},getResolutionInfo:function(){if(tl.current){var e;return null==(e=tp.current)?void 0:e.getResolutionInfo(tl.current)}return null},get renderState(){return ts.current},get paused(){var t;return null==(t=tl.current)?void 0:t.paused}}});var tN=(0,c.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,h._)(function(){var t,n,r,a,o,i,l,u,d,c;return(0,g.__generator)(this,function(s){switch(s.label){case 0:if(!ee(ts.current)||e>=3)return[2];s.label=1;case 1:if(s.trys.push([1,5,,6]),!(null==(n=null==(t=tl.current)?void 0:t.player)?void 0:n.isCanplay))return[3,3];return[4,null==(r=tl.current)?void 0:r.play()];case 2:return s.sent(),[3,4];case 3:null==(a=tl.current)||a.on("canplay",function(){return(0,h._)(function(){var e;return(0,g.__generator)(this,function(t){switch(t.label){case 0:if(!ee(ts.current))return[3,2];return[4,null==(e=tl.current)?void 0:e.play()];case 1:t.sent(),t.label=2;case 2:return[2]}})})()}),s.label=4;case 4:return[3,6];case 5:if(u=(l=null!=(i=null==(o=s.sent())?void 0:o.message)?i:"").indexOf(w.LA.AbortRequest)>-1,c=null!=(d=l.match(w.LA.NoInteract))?d:l.match(w.LA.SafariNoInteract),u)return[2];return c?(tE(!0),setTimeout(function(){tN(e+1)},0)):tN(e+1),[3,6];case 6:return[2]}})})()},[tE]),tx=(0,c.useCallback)(function(){try{var e,t;(null==(e=tl.current)?void 0:e.replay)&&(null==(t=tl.current)||t.replay()),P.A.emit("video_replay",{itemId:o,playMode:d})}catch(e){setTimeout(function(){tE(!0)},0)}},[tE,o,d]);(0,c.useEffect)(function(){tp.current&&(tp.current.muted=tk,tp.current.volume=tC,null==eR||eR(tk?0:tC)),tt&&tl.current&&ee(ts.current)&&(tl.current.playbackRate=N)},[tt,tk,N,tC,eR]),(0,c.useEffect)(function(){var e=tl.current;if(tt&&e&&ee(ts.current)){var t="undefined"!=typeof document&&!document.hidden;eW&&tt&&(d===k.ey.MiniPlayer||t)&&tN(),(0,y.Tb)("videoCanplay",o,e.uuid,e.currentTime,I,"videoCanplay:".concat(tP," autoPlay:").concat(eW)),I>0&&d!==k.ey.VideoDetail&&e&&Math.abs(e.currentTime-I)>.2&&tP&&e.seek(I)}},[tP,eW,I,tN,tt,d]);var tF=(0,c.useCallback)(function(e){var t;(0,y.Tb)("callback handlePlayerWaiting",null==(t=tl.current)?void 0:t.uuid),tt&&(null==eP||eP(e))},[tt,eP]),tH=(0,c.useCallback)(function(){tt&&(null==eS||eS())},[tt,eS]),tU=(0,c.useCallback)(function(e){var t;(0,y.Tb)("callback handlePlayerEnded",null==(t=tl.current)?void 0:t.uuid),tt&&(null==eT||eT(e),eY&&tx())},[tt,eT,tx,eY]),tB=(0,c.useCallback)(function(e){(0,y.Tb)("callback handleLoadStart",null==(t=tl.current)?void 0:t.uuid);var t,n,r,a=null==(n=tl.current)?void 0:n.element,o=a?null==a?void 0:a.style.background:null;t_.current&&(null==tl||null==(r=tl.current)?void 0:r.element)&&(ty.current=o||"",tl.current.element.style.background="#000"),null==F||F(e)},[F]),tG=(0,c.useCallback)(function(e){var t;(0,y.Tb)("callback handleLoadedData",null==(t=tl.current)?void 0:t.uuid),t_.current=!0,null==H||H(e)},[H]),tq=(0,c.useCallback)(function(e){if(tl.current&&ee(ts.current)){var t=tl.current,n=t.volume,r=t.muted;ee(ts.current)&&r&&tE(!0),null==eR||eR(r?0:n)}},[eR]),tQ=(0,c.useCallback)(function(){null==eb||eb()},[eb]),tW=(0,c.useCallback)(function(e){var t;(0,y.Tb)("handleError",null==(t=tl.current)?void 0:t.uuid,e),null==ek||ek(e)},[ek]),tz=(0,c.useCallback)(function(){null==es||es(),tT(!0);var e,t=ty.current;(null==tl||null==(e=tl.current)?void 0:e.element)&&null!==t&&(tl.current.element.style.background=t,ty.current=null)},[es]),tY=(0,c.useCallback)(function(e){var t;(0,y.Tb)("callback handlePause",null==(t=tl.current)?void 0:t.uuid),null==ev||ev(e)},[ev]),tK=(0,c.useCallback)(function(e){var t;(0,y.Tb)("callback handlePlaying",null==(t=tl.current)?void 0:t.uuid),null==em||em(e)},[em]),tj=(0,c.useCallback)(function(e){var t;(0,y.Tb)(eh,"handlePrevention",null==(t=tl.current)?void 0:t.uuid,o,ts.current),tt&&setTimeout(function(){try{if(!ee(ts.current))return;if(ti.current>=3)return void(null==eA||eA());if("xgplayer"===tt||!(null==e?void 0:e.errorName)||(null==e?void 0:e.errorName)==="NotAllowedError"){if(d===k.ey.MiniPlayer)return void tY(e);tE(!0);var t=tl.current;tl.current&&(tl.current.muted=!0),null==t||t.play()}ti.current+=1}catch(e){console.error("handle autoplay error",e)}},0)},[tt,d]);return(0,c.useEffect)(function(){if(tt){var e=tl.current;return null==e||e.on(w.CN,tj),function(){var e;(null==(e=tl.current)?void 0:e.element)&&tl.current.off(w.CN,tj)}}},[tt,tj]),(0,c.useEffect)(function(){return tt?function(){var e,t=tl.current;(0,y.Tb)(ey,"release off events",null==(e=tl.current)?void 0:e.uuid),t&&(t.off("playCatch",tw),t.off(w.Wu,tM),t.off("autoplay_was_prevented",tA))}:void Z(tv.current,tR)},[tt,tw]),(0,c.useEffect)(function(){var e,t;(0,y.Tb)(eh,"playing",null==(e=tl.current)?void 0:e.uuid,o,ts.current,"playing:".concat(tV," isPausedForced:").concat(to.current)),tV?to.current&&eW&&(to.current=!1,tN()):(to.current=!0,null==(t=tl.current)||t.pause())},[eW,tV,tN]),(0,c.useEffect)(function(){return function(){(0,S.uQ)(R.Y.PlayerDestroy),eC(q(tl.current,u))}},[]),(0,c.useEffect)(function(){var e;return(0,y.Tb)(ey,"releasePlayer0",null==(e=tl.current)?void 0:e.uuid,o),function(){var e,t,n,r,a,i=tl.current;null==i||null==(e=i.metrics)||e.stop(),null==i||i.off("playCatch",tw),null==i||i.off(w.Wu,tM),null==i||i.off("autoplay_was_prevented",tA),(0,y.Tb)(ey,"releasePlayer1",null==(t=tl.current)?void 0:t.uuid,o,ts,u,d),null==(n=tp.current)||n.releasePlayer(tl.current),null==(r=tu.current)||r.detach(),null==(a=tu.current)||a.destroy(),tu.current=null,tT(!1),tl.current=null,null==eE||eE(!1)}},[]),(0,l.Y)(ep,{containerId:"xgwrapper-".concat(d,"-").concat(o),classList:["xgplayer-container","tiktok-web-player"],player:tl.current,containerRef:td,bitrateInfo:ex,oncanplay:tz,onplay:tD,onwaiting:tF,onended:tU,onbreak:tH,ontimeupdate:tQ,onerror:tW,onpause:tY,onplaying:tK,onloadstart:tB,onloadeddata:tG,onvolumechange:tq,onVideoPlayEnd:ew,onResolutionReady:eI,subtitle:d===k.ey.VideoDetail&&eO?eO:void 0,teaParams:eQ,videoDimensionParams:e1,hitPreload:tg,mode:d,id:o,eventTrigger:(null==tR?void 0:tR.eventTrigger)||"v0"})})),em=n(57327),eb=n(88999),eP=n(15377),eT=n(42684),ek=n(38456),eC=n(31349),eE=n(45001),eS=n(80660),eR=n(89134),ew=n(81047),eA=n(10449),eI=n(2916),eM=n(14272),eO=n(99659),eL=n(49339),eD=n(72701),eV=n(80567),eN=n(26045),ex=n(37585),eF=n(93758),eH=n(52878),eU=n(86885),eB=n(49118),eG=n(45797),eq=n(40654),eQ=n(80191),eW=null,ez=null,eY=(0,c.memo)((0,c.forwardRef)(function(e,t){var n,h,g,m,b,P=e.poster,T=e.videoCover,w=e.lazyLoading,A=e.horizontal,I=e.playUrl,M=e.id,O=e.teaParams,L=e.index,D=e.mode,V=e.itemMute,N=e.desc,x=e.topSearchQueryAfterViewWord,F=e.duration,H=e.playbackRate,U=e.onVideoPause,B=void 0===U?u.A:U,G=e.onVideoPlaying,q=void 0===G?u.A:G,Q=e.onVideoPlay,W=e.onVideoEnded,z=e.onVideoError,Y=e.onTimeUpdate,K=e.onLoadStart,j=e.onLoadedData,X=e.onVolumeChange,J=e.onVideoUnmount,$=e.onUserHandlePlayVideo,Z=e.onUserHandlePauseVideo,ee=e.onVideoInit,et=void 0===ee?u.A:ee,en=e.e2eTag,er=e.subtitleStruct,ea=e.subtitleList,eo=e.curSubtitle,ei=e.onSubtitleCallback,el=e.onResolutionReady,eu=e.disableDownload,ed=e.volumeInfo,ec=void 0===ed?u.A:ed,es=e.bitrateInfo,ev=e.bitrate,ep=e.posterStyle,ef=e.playModeForTea,e_=e.autoPlay,ey=void 0===e_||e_,eh=e.autoReplay,eY=void 0===eh||eh,eK=e.size,ej=e.playerStyle,eX=e.fetchPriority,eJ=void 0===eX?"auto":eX,e$=e.renderState,eZ=void 0===e$?s.R.ACTIVE:e$,e0=e.posterAlt,e1=e.videoInfo,e2=(0,C.Ul)(),e4=null!=(n=(0,eC.eu)())&&n,e3=(0,E.ol)()||0,e5=(0,C.hM)(),e6=(0,eE.qW)().actualResolution,e7=(0,C.fD)(),e8=(0,eP.Nj)(eT.Gs),e9=(0,eP.Nj)(ek.AU),te=(0,c.useRef)(null),tt=(0,c.useRef)(null),tn=(0,eC.J3)(),tr=(0,E.S4)(),ta=(0,eL.HLh)(),to=(0,i._)((0,c.useState)(!1),2),ti=to[0],tl=to[1],tu=(0,i._)((0,c.useState)(I),2),td=tu[0],tc=tu[1],ts=(0,i._)((0,c.useState)(!1),2),tv=ts[0],tp=ts[1],tf=(0,c.useRef)(null),t_=(0,eP.Nj)(eD.V$),ty=(0,eS.L$)(e1),th=ty.PlayAddrStruct,tg=ty.videoID,tm=(0,v.WB)((0,eS.L$)(e1)),tb=(0,eq.v)(th),tP=null!=ef?ef:D,tT=(0,eL.Yud)(),tk=(0,eL.QcT)(),tC=(0,eL.T8z)()&&k.ey.ThreeColumn===D;if(!eW&&(eW=(0,em.V)())&&(p.M.channelInfo={domain:eW.tea,channel:eW.teaChannel,type:null!=(h=eW.teaChannelType)?h:"tcpy"}),!ez&&(ez=(0,eb.x)())){var tE=ez.user,tS=ez.wid,tR=ez.region,tw=ez.odinId;p.M.regionInfo={region:tR,uid:(null==tE?void 0:tE.uid)||tw||tS,wid:tS,isLogin:!!tE}}var tA=(0,C.w)(L,D,M),tI=[s.R.ACTIVE,s.R.BACKUP,s.R.RETAIN].includes(eZ)&&(tP===k.ey.OneColumn||tP===k.ey.BrowserMode);(0,c.useEffect)(function(){if(e2){var e=e2.index;if((0,d.A)(e)&&(L-e<0||L-e>=3)){tv&&(tp(!1),tf.current=null);return}}if(!tv){var t=new f.K("webapp-desktop",{playReport:e8,experienceReport:e9});t.videoPlayAB=tk,tp(!0),tf.current=t}},[tv,e2,L,e8,e9]);var tM=(0,c.useCallback)(function(){try{var e,t;null==$||$(),null==(t=te.current)||null==(e=t.play)||e.call(t)}catch(e){}},[]),tO=(0,c.useCallback)(function(){var e,t;null==(t=te.current)||null==(e=t.pause)||e.call(t),null==Z||Z()},[]);(0,c.useEffect)(function(){var e=null!=e2?e2:{},t=e.id,n=e.mode;t===M&&D===n||tc(I)},[e2,M,D,I]),(0,c.useEffect)(function(){tA||tl(!1)},[tA]),(0,eI.XK)({isCurrentVideo:tA,index:L,mode:D}),(0,c.useImperativeHandle)(t,function(){return{play:function(e){tM(),tt.current=!0,e&&e8.triggerResume({enter_method:"click_resume",playMode:D})},pause:function(){tO(),tt.current=!1,e8.triggerPause({enter_method:"click_pause",playMode:tP,currentBackendSourceEventTracking:O.currentBackendSourceEventTracking})},seek:function(e){var t;null==(t=te.current)||t.seek(e)},seekTime:function(e){var t;null==(t=te.current)||t.seekTime(e)},onSeeked:function(e){var t;null==(t=te.current)||t.onSeeked(e)},onSeeking:function(e){var t;null==(t=te.current)||t.onSeeking(e)},onTimeUpdate:function(e){var t;null==(t=te.current)||t.onTimeUpdate(e)},getFullscreen:function(e){var t;null==(t=te.current)||t.getFullscreen(e)},exitFullscreen:function(e){var t;null==(t=te.current)||t.exitFullscreen(e)},replay:function(){var e;null==(e=te.current)||e.replay()},updatePlayer:function(e){var t;null==(t=te.current)||t.updatePlayer(e)},changeResolution:function(e){var t;null==(t=te.current)||t.changeResolution(e)},getResolutionInfo:function(){var e;return null==(e=te.current)?void 0:e.getResolutionInfo()},get currentTime(){var e,t;return null!=(t=null==(e=te.current)?void 0:e.getPlayerAttributes().currentTime)?t:0},get duration(){var n,r;return null!=(r=null==(n=te.current)?void 0:n.getPlayerAttributes().duration)?r:0},get currentCanPlay(){return tA&&ti},get paused(){var a;return null==(a=te.current)?void 0:a.paused}}},[ti,tA,tO,tM,e8,tP,O.currentBackendSourceEventTracking]);var tL=(0,ex.jj)();(0,c.useEffect)(function(){var e,t=null===tt.current||tt.current,n=(0,eS.L$)(null==(e=te.current)?void 0:e.getPlayerAttributes()).ended&&!eY;tL&&t&&ey&&!n||D===k.ey.MiniPlayer&&t?tM():(tO(),tA&&!tL&&e8.triggerPause({enter_method:"switch_tab",playMode:tP,currentBackendSourceEventTracking:O.currentBackendSourceEventTracking}))},[ey,tL,tM,tO,e8,tA,tP,eY,D,O.currentBackendSourceEventTracking]);var tD=(0,eH.Zd)({id:M}),tV=(0,eH.Hs)(M),tN=(0,eH.yy)(M,L),tx=(0,eU.WH)(M),tF=(0,c.useMemo)(function(){var e,t=(0,eS.L$)(null==(e=te.current)?void 0:e.getPlayerAttributes()).videoQuality,n=O.definition;return(0,eV.H4)(t,n)},[O]),tH=(0,c.useCallback)(function(){var e,t=(0,eS.L$)(null==(e=te.current)?void 0:e.getPlayerAttributes()),n=t.videoBitrate,i=(t.videoQuality,t.codecType),l=(0,o._)(t,["videoBitrate","videoQuality","codecType"]),u=O.bitrate,d=O.author_id,c=O.format,s=O.encodedType,v=O.videoQuality,p=O.encodeUserTag,f=O.secret,_=O.forFriend,y=O.definition,h=O.playlist_id,g=O.popup_type,m=O.size;return(0,a._)((0,r._)({id:M,authorId:d,playMode:tP,bitrate:null!=n?n:u,format:c,encodedType:s,videoQuality:v,encodeUserTag:p,codecType:i,definition:tF,secret:f,forFriend:_,originalDefinition:y,playlist_id:h,popupType:g},null!=l?l:{},tV,tN),{size:m})},[M,O,tF,tP,tV,tN]),tU=(0,E.i3)(),tB=(0,c.useMemo)(function(){var e=O.group_id,t=O.author_id,n=O.is_scheduled,a=O.search_id,o=O.search_keyword,i=O.search_result_id,l=O.question_id,u=O.collection_id,d=O.collection_name,c=O.isPaidPartnership,s=O.poi_id,v=O.playlist_id,p=O.popup_type,f=O.enter_tab,_=O.diversify_id,y=O.enter_method,h=O.is_sub_only_video,g=O.tab_name,m=O.isPinnedItem,b=O.isReposted,P=O.is_just_watched,T=O.index_from_just_watched,k=O.currentBackendSourceEventTracking,C=O.inspiration_session_id,E=O.inspiration_result_id,S=O.inspiration_keyword,R=O.inspiration_type,w=O.rank,A=O.is_fullscreen,I=O.token_type,M=O.isHDSelfView;return(0,r._)({itemId:e,authorId:t,isScheduled:!!n,autoplayStatus:1,searchId:a,searchKeyword:o,searchResultId:i,questionId:l,playMode:tP,isMute:tU,collectionId:u,collectionName:d,isPaidPartnership:!!c,poiId:s,playlistId:v,popupType:p,enterTab:f,diversifyId:_,enterMethod:y,isSubOnlyVideo:h,isCopyrightMuted:V,isPinnedItem:m,isReposted:b,tab_name:g,isAutoScroll:e4,resolution:e6,is_auto_resolution:e7,is_just_watched:P,index_from_just_watched:T,currentBackendSourceEventTracking:k,inspiration_session_id:C,inspiration_result_id:E,inspiration_keyword:S,inspiration_type:R,rank:w,is_fullscreen:A,token_type:I,self_view:+!!M},tV,tN,tx)},[tU,V,O,e4,e6,e7,tP,tV,tN,tx]),tG=(0,c.useCallback)(function(){var e,t=(0,eS.L$)(null==(e=te.current)?void 0:e.getPlayerAttributes()),n=t.currentTime,o=t.duration;return(0,a._)((0,r._)({},tB),{currentTime:void 0===n?0:n,duration:void 0===o?0:o,index:L})},[L,tB]);(0,c.useEffect)(function(){O&&tv&&tf.current&&(tf.current.videoPlayHandleParams=tG())},[tG,O,tv]);var tq=(0,c.useMemo)(function(){return(0,eR.fU)()?"":(0,eN.N2)(window.location.pathname)},[]),tQ=(0,ex.iJ)({isCurrentVideo:tA}),tW=tQ.loading,tz=tQ.handleCanPlayWithLoading,tY=tQ.handlePauseWithLoading,tK=tQ.handlePlayingWithLoading,tj=tQ.handleWaitingWithLoading,tX=(0,c.useCallback)(function(){var e,t,n;null==(t=tf.current)||t.updateMetricsParams({playbackAttribute:null==(e=te.current)?void 0:e.getPlayerAttributes(),videoQualityParams:tH()}),null==(n=tf.current)||n.onLoadStart(),null==K||K()},[tH]),tJ=(0,c.useCallback)(function(){var e,t,n;null==(t=tf.current)||t.updateMetricsParams({playbackAttribute:null==(e=te.current)?void 0:e.getPlayerAttributes(),videoQualityParams:tH()}),null==(n=tf.current)||n.onLoadedData(),null==j||j()},[tH]),t$=(0,c.useCallback)(function(){var e,t,n;null==(t=tf.current)||t.updateMetricsParams({playbackAttribute:null==(e=te.current)?void 0:e.getPlayerAttributes(),videoQualityParams:tH()}),tz(),tl(!0),null==et||et(!0),null==(n=tf.current)||n.onCanPlay()},[tH,tz,et]),tZ=(0,c.useCallback)(function(e){var t,n,r;null==(n=tf.current)||n.updateMetricsParams({playbackAttribute:null==(t=te.current)?void 0:t.getPlayerAttributes(),videoQualityParams:tH()}),null==(r=tf.current)||r.onPlay(),null==Q||Q(e),tr.setCanAutoPlay(!0)},[tH,Q,D]),t0=(0,c.useCallback)(function(){var e,t,n,o,i=(0,eS.L$)(null==(e=te.current)?void 0:e.getPlayerAttributes()),l=i.currentTime,u=i.duration,d=i.playerType,c=(0,_.ZQ)().getPreloadCacheInfo(M),s=c.byteLength,v=c.duration;null==(n=tf.current)||n.updateMetricsParams({playbackAttribute:(0,a._)((0,r._)({},tD,null==(t=te.current)?void 0:t.getPlayerAttributes()),{preload_size:s,preload_time:v,player_type:d,bitrateInfo:es}),videoQualityParams:tH()}),null==(o=tf.current)||o.onTimeUpdate(),null==Y||Y((void 0===l?0:l)/(void 0===u?0:u)),eM.e.handleFirstFrameVideo()},[tH,Y,M,es,tD]),t1=(0,ex.TL)(),t2=(0,c.useCallback)(function(e){var t=e.httpCode,n=e.errorCode,r=e.errorMessage,a=e.url,o=e.response,i=e.mode,l=e.pathId;t_.emitEvent("video_mse_error",{},{httpCode:String(void 0===t?-1:t),errorCode:String(void 0===n?-1:n),errorMessage:void 0===r?"":r,url:void 0===a?"":a,response:void 0===o?"":o,mode:void 0===i?"":i,pathId:void 0===l?"":l})},[t_]),t4=(0,c.useCallback)(function(e){tn.setPlayerError(),null==z||z(e);var t,n,a,o,i=tH(),l=null==(t=te.current)?void 0:t.getPlayerAttributes();t1((0,r._)({},l,i)),null==(a=tf.current)||a.updateMetricsParams({playbackAttribute:null==(n=te.current)?void 0:n.getPlayerAttributes(),videoQualityParams:tH()}),null==(o=tf.current)||o.onError()},[tH,z,t1]),t3=(0,c.useCallback)(function(e){var t,n,r;B(e),tY(),null==(n=tf.current)||n.updateMetricsParams({playbackAttribute:null==(t=te.current)?void 0:t.getPlayerAttributes(),videoQualityParams:tH()}),null==(r=tf.current)||r.onPause()},[tH,B,tY]),t5=(0,c.useCallback)(function(e){var t,n,r;q(e),tK(),null==(n=tf.current)||n.updateMetricsParams({playbackAttribute:null==(t=te.current)?void 0:t.getPlayerAttributes(),videoQualityParams:tH()}),null==(r=tf.current)||r.onPlaying()},[tH,q,tK]),t6=(0,c.useCallback)(function(){tj();var e=null==(t=te.current)?void 0:t.getPlayerAttributes();if(e){null==(r=tf.current)||r.updateMetricsParams({playbackAttribute:null==(n=te.current)?void 0:n.getPlayerAttributes(),videoQualityParams:tH()});var t,n,r,a,o,i,l=e.buffered,u=e.currentTime,d=void 0===u?0:u,c=e.duration;if(.5>Math.abs(((null!=(o=null==l?void 0:l.length)?o:0)>0&&null!=(i=null==l?void 0:l.start(0))?i:0)-d)||.5>Math.abs((void 0===c?0:c)-d))return;null==(a=tf.current)||a.onWaiting()}},[tH,tj]),t7=(0,eq.K)(D),t8=t7.handleVvCountOnEnd,t9=t7.handleBreakCount,ne=(0,c.useCallback)(function(){t9()},[]),nt=(0,c.useCallback)(function(e){null==X||X(e)},[]),nn=(0,c.useCallback)(function(e){var t,n,r;null==(n=tf.current)||n.updateMetricsParams({playbackAttribute:null==(t=te.current)?void 0:t.getPlayerAttributes(),videoQualityParams:tH()}),null==(r=tf.current)||r.onEnded(),null==W||W(e),t8()},[tH,W]),nr=(0,c.useCallback)(function(e){var t,n,o,i,l=(0,_.ZQ)().getPreloadCacheInfo(M),u=l.byteLength,d=l.duration;null==(n=tf.current)||n.updateMetricsParams({playbackAttribute:null==(t=te.current)?void 0:t.getPlayerAttributes(),videoQualityParams:tH()});var c=null==(o=te.current)?void 0:o.getPlaybackQuality(),s=c?c.droppedVideoFrames/c.totalVideoFrames*100:0;null==(i=tf.current)||i.onUnmount((0,a._)((0,r._)({},e),{preload_size:u,preload_time:d,droppedRate:s})),null==J||J()},[tH,M]),na=(0,c.useCallback)(function(e){e.preventDefault},[]);(0,c.useEffect)(function(){tA||null==B||B({})},[tA,B]),(0,c.useEffect)(function(){tA&&(0,S.uQ)(R.Y.PlayerMounted)},[tA]);var no=(0,c.useCallback)(function(){null==et||et()},[et]),ni=A||D===k.ey.BrowserMode||D===k.ey.VideoDetail||D===k.ey.Pip||D===k.ey.FullscreenMode,nl=(0,c.useMemo)(function(){return(0,y.J)(O)},[O]),nu=(null!=(g=(0,ew.U)(function(){return["isTTP"]},[]))?g:{}).isTTP,nd=(null!=(m=(0,eA.W)(function(){return["region"]},[]))?m:{}).region,nc=(null!=(b=(0,eA.W)(function(){return["abTestVersion"]},[]))?b:{}).abTestVersion,ns=(0,eL.ZC0)(),nv=p.M;nv.isTTP=nu,nc&&(nv.abTestVersion=nc.versionName,p.M.setABTest(tT));var np=(0,eP.Nj)(_.JX),nf=np.getPreloadUrls(),n_=(0,ex.au)(nf),ny=(0,eL.NYA)().playerInitHost,nh=(0,eL.oJW)().videoOrder,ng=x?"".concat(x,". ").concat(N):N,nm=null!=e0?e0:ng,nb=(0,c.useContext)(eG.e).armCoreContentEvent,nP=(0,c.useCallback)(function(){null==nb||nb(),t_.reportActualFMP(),t_.reportPageReady(D),eO.A.reportCoreResourceLoadEnd(),eO.A.reportCoreRender(),eM.e.handleActualFMP()},[nb,t_,D]);(0,eI.w9)({isCurrentVideo:tA,index:L,mode:D});var nT=(0,c.useCallback)(function(e){var t=e.errorCode,n=e.errorMessage,r=e.logid,a=e.endState;t_.emitEvent("video_play_end",{count:1},{is_success:"".concat(0===t),error_code:String(t),error_msg:n,logid:r,end_state:"".concat(a)})},[t_]);return(0,c.useEffect)(function(){eO.A.reportCoreResourceLoadStart()},[]),(0,l.FD)(eQ.Le,{horizontal:A,mode:D,style:ej,children:[P?(0,l.Y)(eQ.R,{horizontal:ni,mode:D,src:P,alt:nm,loading:void 0===w||w?"lazy":"eager",style:ep,onLoad:nP,fetchPriority:eJ}):T?(0,l.Y)(eB.x,{video:T,objectFit:ni?"contain":"cover",style:ep,alt:nm,onLoad:nP,fetchPriority:eJ}):null,(tA||tI)&&(0,l.FD)(eQ.Ec,{horizontal:ni,"data-e2e":en,children:[(0,l.Y)(eg,{videoSource:tm,ref:te,id:M,vid:tg,url:td,urlList:tb,playbackRate:void 0===H?1:H,mode:D,muteSetting:V||eF.T5[D].forceMute,defaultMute:eF.T5[D].defaultMute,playProgress:eZ!==s.R.ACTIVE||tC?0:e3,duration:F,onUnmount:nr,onLoadStart:tX,onLoadedData:tJ,onTimeUpdate:t0,onError:t4,onCanPlay:t$,onPause:t3,onPlay:tZ,onPlaying:t5,onWaiting:t6,onEnded:nn,onBreak:ne,onVideoChange:no,onResolutionReady:el,userResolution:e5,onContextMenu:na,onVideoVolumeChange:nt,onVideoPlayEnd:nT,subtitleStruct:er,subtitleList:ea,curSubtitle:eo,onSubtitleCallback:ei,disableDownload:void 0===eu||eu,volumeInfo:ec,bitrateInfo:es,defaultDefinition:nl,preloader:np,preloadUrlsList:n_,playerInitHost:ny,defaultBitrate:ev,videoOrder:nh,teaParams:O,autoPlay:ey,autoReplay:eY,size:eK,pathId:tq,metrics:tf.current,playbackAbTestInfo:(0,r._)({},tT,ns),handleMseError:t2,isTTP:!!nu&&"US"===nd,vIndex:L,renderState:eZ,onAutoplayPrevented:function(){ta&&tr.setCanAutoPlay(!1)}}),tW&&(0,l.Y)(eQ.K3,{})]})]})}))},94805:function(e,t,n){n.d(t,{CN:function(){return l},LA:function(){return a},Wu:function(){return i},uJ:function(){return o}});var r,a=((r={}).NoInteract="failed because the user didn't interact with the document first.",r.Interrupted="request was interrupted by a call to pause",r.SafariNoInteract="The request is not allowed by the user agent or the platform in the current context",r.FireFox="The play method is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.",r.LoadInterrupt="request was interrupted by a new load request",r.Abort="The operation was aborted",r.AbortRequest="new load request",r),o="use-credentials",i="PRELOAD_INFO",l="autoplay_was_prevented"},36413:function(e,t,n){n.d(t,{K:function(){return f}});var r=n(95170),a=n(45275),o=n(5377),i=n(45996),l=n(54333),u=n(43919),d=n(58034),c=n(81269),s=n(65362);function v(){var e=performance.timeOrigin||performance.timing.navigationStart;return Math.round(Date.now()-e)}function p(e){return!e||e.length<1?0:e.end(0)}var f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"webapp",n=arguments.length>1?arguments[1]:void 0,a=n.playReport,o=n.experienceReport;(0,r._)(this,e),this.project=t,this._platform="",this._url="",this._playMode=d.ey.OneColumn,this._videoQualityHandleParams=null,this._videoPlayHandleParams=null,this._playbackAttributes=null,this.isIos=!1,this.isAndroid=!1,this.videoExperienceReport=o,this.videoPlayReport=a,this.renderState="default",this.playerType="",this.id="",this.loadedDuration=0,this.loadStartDuration=0,this.startDuration=0,this.firstFrameTrigger="v1",this.videoPlayVersion="",this.lastTime=0,this.timeupdateCount=0,this.startPlaying=-1,this.paused=!0}var t=e.prototype;return t.isActive=function(){return this.renderState!==u.R.BACKUP&&this.renderState!==u.R.RETAIN&&this.renderState!==u.R.RELEASE&&this.renderState!==u.R.DESTROY},t.updateMetricsParams=function(e){var t=e.playbackAttribute,n=e.videoQualityParams;t&&(this.playbackAttributes=t),n&&(this.videoQualityHandleParams=n)},t.onPlay=function(){this.loadStartDuration||(this.loadStartDuration=v()),this.log("onPlay")},t.onPlaying=function(){this.log("onPlaying"),this.startPlaying<0&&this.isActive()&&(this.startPlaying=Date.now()),"v2"===this.videoPlayVersion&&this.isActive()&&this.handleTimeupdate("playing"),this.videoExperienceReport.reportVideoInteract({endTime:Date.now(),videoSource:this._url})},t.onPause=function(){this._videoPlayHandleParams&&this._playbackAttributes&&this.isActive()&&this.videoPlayReport.handlePause((0,o._)({},this._videoPlayHandleParams,this._playbackAttributes));var e=0;this.startPlaying>0&&(e=Date.now()-this.startPlaying,this.startPlaying=-1),this.paused=!0,this.log("onPause",0,"duration:".concat(e))},t.onWaiting=function(){this._videoPlayHandleParams&&this._playbackAttributes&&this.isActive()&&this.videoPlayReport.handleWaiting((0,o._)({},this._videoPlayHandleParams,this._playbackAttributes))},t.onLoadStart=function(){var e=v();this.loadStartDuration=e,this.log("onLoadStart",e),this.loadedDuration=0,this.isActive()&&(this.startDuration=e)},t.onLoadedData=function(){var e=v();this.log("onLoadedData",e),this.loadedDuration=e,"v1"===this.videoPlayVersion&&this.isActive()&&this.handleTimeupdate("loadeddata"),"v2"===this.firstFrameTrigger&&this.sendFirstFrameReport("loadeddata")},t.onCanPlay=function(){this.log("onCanPlay"),this.videoExperienceReport.getCurrentPageReport()||(this.videoExperienceReport.reportVideoFirstScreen({endTime:Date.now(),videoSource:this._url}),this.videoExperienceReport.reportVideoAddition({endTime:Date.now(),videoSource:this._url}))},t.onCanPlayThrough=function(){this.isIos&&(this.videoExperienceReport.getCurrentPageReport()||(this.videoExperienceReport.reportVideoFirstScreen({endTime:Date.now(),videoSource:this._url}),this.videoExperienceReport.reportVideoAddition({endTime:Date.now(),videoSource:this._url})))},t.sendFirstFrameReport=function(e){if(!this.videoExperienceReport.getFirstFrameReport()&&this._playbackAttributes&&("v1"!==this.firstFrameTrigger&&"v2"!==this.firstFrameTrigger||!(this.loadedDuration<=0))){var t,n={startDuration:this.loadStartDuration,loadedDuration:this.loadedDuration,triggerFrom:e};this.videoExperienceReport.reportVideoFirstFrame(null!=(t=this._playbackAttributes.currentTime)?t:-1,n)}},t.handleTimeupdateLog=function(e,t){if(!(c.r.level<1)){var n=this._playbackAttributes||{},r=n.readyState,a=n.buffered;if(!(this.timeupdateCount>3)||this.paused){var o=p(void 0===a?null:a);(void 0===r?-1:r)>1&&(this.loadedDuration||o>1)&&this.isActive()&&this.timeupdateCount++,this.log("handleTimeupdate",e,"triggerFrom:".concat(t," loadStart:").concat(this.loadedDuration," loadedData:").concat(this.loadedDuration)),this.paused=!1}}},t.onTimeUpdate=function(){var e=(this._playbackAttributes||{}).buffered,t=this.loadedDuration>0?"timeupdate_1":"timeupdate";if("v1"===this.videoPlayVersion||"v2"===this.videoPlayVersion){var n=p(void 0===e?null:e);(this.loadStartDuration>0&&this.loadedDuration>0||0===this.loadStartDuration&&n>1)&&this.handleTimeupdate(t)}else this.handleTimeupdate(t);this.sendFirstFrameReport(t)},t.onError=function(){this._videoPlayHandleParams&&this.isActive()&&this.videoPlayReport.handleError(this._videoPlayHandleParams)},t.onEnded=function(){this._videoPlayHandleParams&&this.videoPlayReport.handleEnded(this._videoPlayHandleParams)},t.onSlideChange=function(e){var t,n;0!==(null!=(n=null==(t=this._playbackAttributes)?void 0:t.duration)?n:0)&&this._videoPlayHandleParams&&this.videoPlayReport.handlePlayTime(this._videoPlayHandleParams)},t.onUnmount=function(e){this.isIos||this.onSlideChange(e)},t.onProgress=function(e,t){},t.mseCDNCache=function(e){},t.pauseAction=function(e){this.videoPlayReport.triggerPause({enter_method:e,playMode:this.playMode})},t.setPlayerType=function(e){this.playerType=e},t.setRenderState=function(e,t){this.renderState=e,this.id=t,this.log("setRenderState"),this.isActive()&&(this.startDuration=v())},t.handleTimeupdate=function(e){if(this._videoQualityHandleParams&&this._videoPlayHandleParams&&this._playbackAttributes){var t=v();this.handleTimeupdateLog(t,e);var n=this._playbackAttributes.readyState,r=void 0===n?-1:n;"webapp-mobile"===this.project?this.videoPlayReport.handleTimeUpdate((0,i._)((0,o._)({},this._videoPlayHandleParams,this._playbackAttributes),{render_state:this.renderState}),!0):this.isActive()&&r&&r>=2&&this.videoPlayReport.handleTimeUpdate((0,i._)((0,o._)({},this._videoPlayHandleParams,this._playbackAttributes),{render_state:this.renderState,player_type:this.playerType,loadstart_dur:t-this.loadStartDuration,loadeddata_dur:this.loadedDuration>0?t-this.loadedDuration:0,trigger_from:e}))}},t.onSeeking=function(){this.log("onSeeking")},t.onSeeked=function(){this.log("onSeeked")},t.onLoadedMetadata=function(){this.log("onLoadedMetadata")},t.log=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(!(c.r.level<1)){var o=this._playbackAttributes||{},i=o.readyState,u=o.buffered,d=o.currentTime;if(!(this.timeupdateCount>3)||this.paused){var f,_=t||v(),y=p(void 0===u?null:u);s.Tb.apply(void 0,["Metrics",this.id,this.renderState,e,"costTime:".concat(_-this.lastTime," fromLoadStart:").concat(_-this.loadStartDuration," fromStart:").concat((f=this.startDuration)<=0||_<f?-1:_-f," readyState:").concat(void 0===i?-1:i," renderState:").concat(this.renderState," bufferEnd:").concat(y," currentTime:").concat(void 0===d?0:d," time:").concat(_," videoPlayVersion:").concat(this.videoPlayVersion)].concat((0,l._)(r))),this.lastTime=_}}},(0,a._)(e,[{key:"firstFrameAB",set:function(e){this.firstFrameTrigger=e}},{key:"videoPlayAB",set:function(e){this.videoPlayVersion=e}},{key:"platform",set:function(e){this._platform=e,this.isIos="ios"===this._platform,this.isAndroid="android"===this._platform}},{key:"playMode",set:function(e){this._playMode=e}},{key:"url",set:function(e){this._url=e}},{key:"videoQualityHandleParams",set:function(e){this._videoQualityHandleParams=e}},{key:"videoPlayHandleParams",set:function(e){this._videoPlayHandleParams=e}},{key:"playbackAttributes",set:function(e){this._playbackAttributes=e}}]),e}()},32753:function(e,t,n){n.d(t,{AI:function(){return u},H4:function(){return p},L8:function(){return s},OK:function(){return d},Ug:function(){return f},n2:function(){return c},qd:function(){return l},zD:function(){return i}});var r,a,o=n(5377),i=((r={}).PlayQuality="video_play_quality",r.PlayEnded="video_play_end",r.PlayFailed="video_play_failed",r.BlockStart="video_block_start",r.Block="video_block",r.Request="video_request",r.RequestResponse="video_request_response",r.FirstFrame="first_feed_show_time",r),l=((a={})[a.Public=0]="Public",a[a.Self=1]="Self",a[a.Friend=2]="Friend",a),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return["one_column","three_column","browser_mode","video_detail","pip","fullscreen","creator_tab","mini_player","immersive_player"][e]},d=function(e){return e?e.map(function(e){return e.GearName||""}):null},c=function(e){return e?e.map(function(e){return e.QualityType&&e.Bitrate?"".concat(e.QualityType,":").concat(e.Bitrate):""}).filter(function(e){return!!e}):null},s=function(e){if(!e)return 0;for(var t=0,n=0;n<e.length;n++)t+=e.end(n)-e.start(n);return Math.round(1e3*t)},v=new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),p=function(e,t){if(!e)return t;if("string"==typeof e&&e.indexOf("xgpreload_config")>-1)return e;var n=Number(e);if(!v.has(n)){var r=String(e).match(/^([a-zA-Z]*)+_([0-9]+)_0$/i);return r?"".concat(r[1],"_").concat(r[2],"p"):"_".concat(e)}return v.get(n)};function f(e){var t,n,r={isFinish:0,pt:0,vt:0,firstframeDuration:100,errorCode:0,errorMessage:"",codecType:"h264",resolution:"",url:""},a=null==e||null==(n=e.player)||null==(t=n.plugins)?void 0:t.xgVodLogger;if(null==a?void 0:a.getFinalInfo){var i=a.getFinalInfo();return(0,o._)({},r,i)}return r}},33751:function(e,t,n){n.d(t,{JX:function(){return l},ZQ:function(){return v},as:function(){return u}});var r=n(95170),a=n(79262),o=n(97623),i=3,l=function e(){var t=this;(0,r._)(this,e),this.preloadQueue=[],this.preloadStartIndex=-1,this.currentPage="",this.preloadUrlsPool=new Set,this.setPreloadQueue=function(e){e.length&&(t.preloadQueue=null!=e?e:[],e.forEach(function(e){var n=e.id;n&&t.preloadUrlsPool.add(n)}))},this.setPreloadIndex=function(e){e>=0&&(t.preloadStartIndex=e)},this.getPreloadUrls=function(){var e=t.preloadStartIndex;return t.preloadQueue.slice(e+1,e+i+1)},this.getPreloadedPool=function(){return t.preloadUrlsPool},this.reset=function(){t.preloadQueue=[],t.preloadStartIndex=-1,t.preloadUrlsPool.clear()},this.setCurrentPage=function(e){t.currentPage=e||"unknown"},this.clearAllVideoCaches=function(){t.currentPage&&t.preloadUrlsPool.clear()}};l=function(e,t,n,r){var o,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==("undefined"==typeof Reflect?"undefined":(0,a._)(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(l=(i<3?o(l):i>3?o(t,n,l):o(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}([(0,o._q)()],l);var u=function(e){i=e},d={byteLength:-1,duration:-1,type:-1,vid:"unknown"},c=function e(){var t=this;(0,r._)(this,e),this.preloadVideoId="",this.preloadVideoCache=d,this.setPreloadCacheInfo=function(e,n){e&&n&&e!==t.preloadVideoId&&(t.preloadVideoId=e,t.preloadVideoCache=n)},this.getPreloadCacheInfo=function(e){return e&&t.preloadVideoId&&e===t.preloadVideoId?t.preloadVideoCache:d}},s=null,v=function(){return s||(s=new c),s}}}]);