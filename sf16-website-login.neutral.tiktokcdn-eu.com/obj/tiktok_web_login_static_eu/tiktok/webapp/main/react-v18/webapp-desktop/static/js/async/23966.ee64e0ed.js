"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["23966"],{40277:function(e,t,r){r.d(t,{t:function(){return a}});var n,a=((n={}).H265="web_h265",n.H264="web_h264",n)},99377:function(e,t,r){r.d(t,{$l:function(){return s},AF:function(){return u},GH:function(){return p},gc:function(){return h}});var n,a=r(89134),o=r(22481),i=r(67500),c='video/mp4;codecs="hev1.1.6.L93.B0"';function s(e){return[3,4,31].includes(e)}function u(){return!(0,a.fU)()&&"undefined"!=typeof MediaSource&&(!!MediaSource.isTypeSupported(c)&&"probably"===document.createElement("video").canPlayType(c)||!1)}var d="hevc_support_key_v4",l="hevc_support_key_time";function h(){if((0,a.fU)())return!1;if(void 0!==n)return n;var e,t,r,s=(0,o._S)(d,""),h=Number((0,o._S)(l,"0"));if(Date.now()-h>12096e5||""===s){if(n=u(),(0,o.AP)(d,n?"1":"0"),(0,o.AP)(l,String(Date.now())),n){"v0"!==(null!=(e=(0,i.d)("page_stability_opt"))?e:"v0")?null==(r=navigator.mediaCapabilities)||null==(t=r.decodingInfo({type:"file",video:{contentType:c,width:1920,height:1080,bitrate:1e4,framerate:30}}))||t.then(function(e){var t=e.supported;n=t,(0,o.AP)(d,t?"1":"0")}).catch(function(e){return console.error(e)}):navigator.mediaCapabilities.decodingInfo({type:"file",video:{contentType:c,width:1920,height:1080,bitrate:1e4,framerate:30}}).then(function(e){var t=e.supported;n=t,(0,o.AP)(d,t?"1":"0")}).catch(function(e){return console.error(e)})}return n}return"1"===s}function p(){(0,o.AP)(d,"0"),(0,o.AP)(l,String(Date.now())),n=!1}},69216:function(e,t,r){r.d(t,{A:function(){return c}});var n=r(73628),a=r(89134),o=r(40277),i=r(99377);function c(){var e=(0,n.useMemo)(function(){return(0,i.gc)()},[]),t=(0,n.useMemo)(function(){return(0,a.fU)()?o.t.H264:e?o.t.H265:o.t.H264},[e]);return{openH265:t===o.t.H265,streamDeviceType:t,hevcSupport:e}}},53075:function(e,t,r){r.d(t,{AF:function(){return p},AP:function(){return _},CA:function(){return h},a8:function(){return S},hA:function(){return l},uJ:function(){return f}});var n=r(10874),a=r(36646),o=r(80660),i=r(10449),c=r(67500),s=r(21708),u=r(20458),d="abTestVersion",l=function(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion,r=null!=(e=(0,c.qt)(t,"search_bar_style_opt"))?e:"v1",n="v2"===r,a="v3"===r;return{isSearchBarStyleV1:"v1"===r,isSearchBarStyleV2:n,isSearchBarStyleV3:a,withNewStyle:n||a}},h=function(){var e,t=(0,n.useLocation)().pathname,r=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion,a=null!=(e=(0,c.qt)(r,"search_add_related_search"))?e:"v0";return{hasRelatedSearch:(0,s.ie)(t)||"v0"!==a}},p=function(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return"v2"===(null!=(e=(0,c.qt)(t,"search_keep_sug_show"))?e:"v1")};function f(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion,r=null!=(e=(0,c.qt)(t,"search_add_non_personalized_switch"))?e:"v1",n=(0,a.P)(u.L,{selector:function(e){var t;return{user:null==(t=e.appContext)?void 0:t.user}},dependencies:[]}).user;return{hasPersonalizedSwitch:"v2"===r&&!!n}}function S(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return{shouldRecomReduceIconRisk:"v1"===(null!=(e=(0,c.qt)(t,"should_recom_reduce_icon_risk"))?e:"v0")}}function _(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return{notificationShouldBeClickable:"v1"===(null!=(e=(0,c.qt)(t,"webapp_moderation"))?e:"v0")}}},82713:function(e,t,r){r.d(t,{rk:function(){return ea},cE:function(){return er},ol:function(){return en}});var n,a=r(73628),o=r(38794),i=r(79066),c=r(35383),s=r(5377),u=r(45996),d=r(72516),l=r(82887),h=r(66905),p=r(10625),f=r(90432),S=r(71952),_=r(37240),g=r(6754),v=r(40832),y=(n={},(0,c._)(n,o.nX.General,v.L.GeneralSearch),(0,c._)(n,o.nX.Video,v.L.SearchVideo),(0,c._)(n,o.nX.Live,v.L.SearchLive),(0,c._)(n,o.nX.User,v.L.SearchUser),(0,c._)(n,o.nX.Photo,v.L.SearchPhoto),n),m=r(44957),R=r(54149),P=function(e,t,r,n){if(!(e.length<10)){var a={enter_from:r,words_source:o.rU.RelatedSearch,search_position:f.f.commonParams.page_name,page_name:n};o.$G.handleTrendingShow((0,s._)({words_num:e.length,impr_id:t,raw_query:""},a)),e.forEach(function(e,r){var n,i;return o.$G.handleTrendingWordsShow((0,s._)({words_position:r,words_content:null!=(n=null==e?void 0:e.word)?n:"",group_id:null!=(i=null==e?void 0:e.group_id)?i:"",impr_id:t},a))})}},b=(0,l._)((0,p.p)("relatedSearchAtom@tiktok/webapp-atoms",{}),{rehydrationKey:"webapp.related-search"}),w=(0,h.i)(b,function(e,t){return{setShowRelatedSearchPanel:function(e,r){t(b,function(t){return(0,u._)((0,s._)({},t),(0,c._)({},e,(0,u._)((0,s._)({},t[e]),{shouldShowRelatedSearchPanel:r})))})},getRelatedSearchData:function(r,n){return(0,i._)(function(){var a,o,l,h,p,f,v;return(0,d.__generator)(this,function(w){switch(w.label){case 0:if(a=e(b)[r],o=!e(_.WH).isSearchPersonalized,null==a?void 0:a.isLoading)return[2];w.label=1;case 1:var L;return w.trys.push([1,3,,4]),t(b,function(e){return(0,u._)((0,s._)({},e),(0,c._)({},r,(0,u._)((0,s._)({},e[r]),{isLoading:!0})))}),[4,(L=(0,u._)((0,s._)({},n),{is_non_personalized_search:o?1:void 0}),(0,i._)(function(){return(0,d.__generator)(this,function(e){return[2,m.h.get("/api/search/suggest/guide/",{query:L,baseUrlType:R.Z4.FixedWww})]})})())];case 2:if((h=w.sent()).status_code!==S.s.Ok)throw Error();return f=(null!=(p=h.data)?p:[]).map(function(e){return(0,u._)((0,s._)({},e),{impr_id:h.log_id})}),v=null==(l=e(g.pg).searchGlobalParams)?void 0:l.rootEnterFrom,P(f,h.log_id,v,y[r]),t(b,function(e){return(0,u._)((0,s._)({},e),(0,c._)({},r,(0,u._)((0,s._)({},h),{data:f,shouldShowRelatedSearchPanel:!1})))}),[3,4];case 3:return console.warn({error:w.sent()}),[3,4];case 4:return t(b,function(e){return(0,u._)((0,s._)({},e),(0,c._)({},r,(0,u._)((0,s._)({},e[r]),{isLoading:!1})))}),[2]}})})()}}}),L=(w.useAtomService,w.getStaticApi,w.useServiceDispatchers),k=w.useServiceState,F=r(49339),T=r(62010),X=r(48748),V=r(95170),O=r(7120),D=r(6586),E=r(79262),A=r(23999),G=r(76435),U=r(19293),j=r(24451),z=r(62564),$=r(72916),M=r(95719),Z=r(68710),q=r(74690),I=r(78990),C=r(82379),H=r(95092),W=r(26273),B=r(69517),N=r(97623),J=r(10987);function Q(e,t){if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var x=function(){function e(t){(0,V._)(this,e),this.fetch=t}return e.prototype.getRelatedSearch=function(e){return this.fetch.get("/api/search/suggest/guide/",{query:e,baseUrlType:R.Z4.FixedWww})},e}();function K(e,t,r,n){var a,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function Y(e,t){if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}x=function(e,t,r,n){var a,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}([(0,N._q)(),Q("design:type",Function),Q("design:paramtypes",[void 0===J.p?Object:J.p])],x);var ee=function(e){function t(e,r,n){var a,i;return(0,V._)(this,t),(a=(0,X._)(this,t)).service=e,a.search=r,a.personalization=n,i={},(0,c._)(i,o.nX.General,{}),(0,c._)(i,o.nX.Video,{}),(0,c._)(i,o.nX.User,{}),(0,c._)(i,o.nX.Live,{}),(0,c._)(i,o.nX.Photo,{}),a.defaultState=i,a}(0,O._)(t,e);var r=t.prototype;return r.setGeneralState=function(e,t){e[o.nX.General]=t},r.setUserState=function(e,t){e[o.nX.User]=t},r.setVideoState=function(e,t){e[o.nX.Video]=t},r.setPhotoState=function(e,t){e[o.nX.Photo]=t},r.setLiveState=function(e,t){e[o.nX.Live]=t},r.setGeneralStateShowRelatedSearchPanel=function(e,t){e[o.nX.General]=(0,u._)((0,s._)({},e[o.nX.General]),{shouldShowRelatedSearchPanel:t})},r.setUserStateShowRelatedSearchPanel=function(e,t){e[o.nX.User]=(0,u._)((0,s._)({},e[o.nX.User]),{shouldShowRelatedSearchPanel:t})},r.setVideoStateShowRelatedSearchPanel=function(e,t){e[o.nX.Video]=(0,u._)((0,s._)({},e[o.nX.Video]),{shouldShowRelatedSearchPanel:t})},r.setPhotoStateShowRelatedSearchPanel=function(e,t){e[o.nX.Photo]=(0,u._)((0,s._)({},e[o.nX.Photo]),{shouldShowRelatedSearchPanel:t})},r.setLiveStateShowRelatedSearchPanel=function(e,t){e[o.nX.Live]=(0,u._)((0,s._)({},e[o.nX.Live]),{shouldShowRelatedSearchPanel:t})},r.getTopRelatedSearchData=function(e){var t=this;return e.pipe((0,j.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,D._)(e,3),r=t[0],n=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:r,rootEnterFrom:null==n?void 0:n.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var r=e.payload,n=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},r),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,M.M)(function(e){var r=e.data,a=e.log_id;t.reportTrendingShow(r,a,n,v.L.GeneralSearch)}),(0,Z.Z)(function(e){var r=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setGeneralState(r))}),(0,q.Z)(t.getActions().setGeneralState({})),(0,G.Q)(t.getAction$().dispose))}))},r.getVideoRelatedSearchData=function(e){var t=this;return e.pipe((0,j.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,D._)(e,3),r=t[0],n=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:r,rootEnterFrom:null==n?void 0:n.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var r=e.payload,n=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},r),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,M.M)(function(e){var r=e.data,a=e.log_id;t.reportTrendingShow(r,a,n,v.L.SearchVideo)}),(0,Z.Z)(function(e){var r=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setVideoState(r))}),(0,q.Z)(t.getActions().setVideoState({})),(0,G.Q)(t.getAction$().dispose))}))},r.getPhotoRelatedSearchData=function(e){var t=this;return e.pipe((0,j.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,D._)(e,3),r=t[0],n=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:r,rootEnterFrom:null==n?void 0:n.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var r=e.payload,n=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},r),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,M.M)(function(e){var r=e.data,a=e.log_id;t.reportTrendingShow(r,a,n,v.L.SearchPhoto)}),(0,Z.Z)(function(e){var r=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setPhotoState(r))}),(0,q.Z)(t.getActions().setPhotoState({})),(0,G.Q)(t.getAction$().dispose))}))},r.getUserRelatedSearchData=function(e){var t=this;return e.pipe((0,j.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,D._)(e,3),r=t[0],n=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:r,rootEnterFrom:null==n?void 0:n.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var r=e.payload,n=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},r),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,M.M)(function(e){var r=e.data,a=e.log_id;t.reportTrendingShow(r,a,n,v.L.SearchUser)}),(0,Z.Z)(function(e){var r=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setUserState(r))}),(0,q.Z)(t.getActions().setUserState({})),(0,G.Q)(t.getAction$().dispose))}))},r.getLiveRelatedSearchData=function(e){var t=this;return e.pipe((0,j.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,D._)(e,3),r=t[0],n=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:r,rootEnterFrom:null==n?void 0:n.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var r=e.payload,n=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},r),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,M.M)(function(e){var r=e.data,a=e.log_id;t.reportTrendingShow(r,a,n,v.L.SearchLive)}),(0,Z.Z)(function(e){var r=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setLiveState(r))}),(0,q.Z)(t.getActions().setLiveState({})),(0,G.Q)(t.getAction$().dispose))}))},r.handleRequestData=function(e){var t=e.status_code,r=e.data,n=void 0===r?[]:r,a=e.log_id,o=[];return t===S.s.Ok&&(null==n?void 0:n.length)&&(o=n.map(function(e){return(0,u._)((0,s._)({},e),{impr_id:a})})),(0,u._)((0,s._)({},e),{data:null!=o?o:[]})},r.reportTrendingShow=function(e,t,r,n){if(e&&e.length>=10){var a={enter_from:r,words_source:o.rU.RelatedSearch,search_position:f.f.commonParams.page_name,page_name:n};o.$G.handleTrendingShow((0,s._)({words_num:e.length,impr_id:null!=t?t:"",raw_query:""},a)),e.forEach(function(e,r){var n,i;return o.$G.handleTrendingWordsShow((0,s._)({words_position:r,words_content:null!=(n=null==e?void 0:e.word)?n:"",group_id:null!=(i=null==e?void 0:e.group_id)?i:"",impr_id:null!=t?t:""},a))})}},t}(I.E);K([(0,C.uk)(),Y("design:type",void 0===U.c?Object:U.c)],ee.prototype,"dispose",void 0),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setGeneralState",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setUserState",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setVideoState",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setPhotoState",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setLiveState",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setGeneralStateShowRelatedSearchPanel",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setUserStateShowRelatedSearchPanel",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setVideoStateShowRelatedSearchPanel",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setPhotoStateShowRelatedSearchPanel",null),K([(0,C.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setLiveStateShowRelatedSearchPanel",null),K([(0,C.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===U.c?Object:U.c]),Y("design:returntype",void 0)],ee.prototype,"getTopRelatedSearchData",null),K([(0,C.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===U.c?Object:U.c]),Y("design:returntype",void 0)],ee.prototype,"getVideoRelatedSearchData",null),K([(0,C.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===U.c?Object:U.c]),Y("design:returntype",void 0)],ee.prototype,"getPhotoRelatedSearchData",null),K([(0,C.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===U.c?Object:U.c]),Y("design:returntype",void 0)],ee.prototype,"getUserRelatedSearchData",null),K([(0,C.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===U.c?Object:U.c]),Y("design:returntype",void 0)],ee.prototype,"getLiveRelatedSearchData",null),ee=K([(0,H.nV)("RelatedSearch"),Y("design:type",Function),Y("design:paramtypes",[void 0===x?Object:x,void 0===B.tq?Object:B.tq,void 0===W.f?Object:W.f])],ee);var et=(0,T.K)(function(){return(0,F.XRV)().shouldUseSearchPageJotai},ee,{useServiceState:k,useServiceDispatchers:function(){var e=L();return(0,a.useMemo)(function(){return{setGeneralStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.General,t)},setVideoStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.Video,t)},setPhotoStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.Photo,t)},setUserStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.User,t)},setLiveStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.Live,t)},getTopRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.General,t)},getVideoRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.Video,t)},getUserRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.User,t)},getPhotoRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.Photo,t)},getLiveRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.Live,t)},dispose:function(){}}},[])}}),er=et.useSigiOrJotaiService,en=et.useSigiOrJotaiState,ea=et.useSigiOrJotaiDispatchers},51629:function(e,t,r){r.d(t,{Ae:function(){return A},DQ:function(){return U},Y6:function(){return G},gc:function(){return V},lC:function(){return O},nY:function(){return D},u5:function(){return X}});var n,a=r(35383),o=r(5377),i=r(45996),c=r(6586),s=r(90421),u=r(26869),d=r(73628),l=r(10874),h=r(3595),p=r(79178),f=r(38794),S=r(53069),_=r(42963),g=r(37240),v=r(10449),y=r(81047),m=r(67500),R=r(89485),P=r(69216),b=r(53075),w=r(80151),L=r(82713),k=r(70143),F=r(69517),T=r(36494);function X(){var e,t=(0,l.useLocation)(),r=t.search,n=t.state,a=null!=n?n:{},o=a.enterMethod,i=a.searchSource,c=a.enterFrom,s=a.fromSearchSubTab,d=a.imprId,h=a.blankpageEnterFrom,p=a.blankpageEnterMethod,f=a.videoPageType,S=a.preClickId,_=(0,u.parse)(r).q;return{enterMethod:o,searchSource:i,enterFrom:c,keyword:null!=(e=Array.isArray(_)?_.toString():_)?e:"",fromSearchSubTab:s,imprId:d,blankpageEnterFrom:h,blankpageEnterMethod:p,videoPageType:f,preClickId:S}}function V(e){var t,r,n=X(),a=n.keyword,o=n.enterMethod,i=n.searchSource,s=n.enterFrom,u=n.fromSearchSubTab,S=n.imprId,g=n.blankpageEnterFrom,m=n.blankpageEnterMethod,b=n.videoPageType,L=n.preClickId,V=null!=(t=(0,v.W)(function(){return["user","language","abTestVersion"]},[]))?t:{},O=V.user,D=V.language,E=void 0===D?"en":D,A=V.abTestVersion,U=null!=(r=(0,y.U)(function(){return["searchVideoForLoggedin","searchLiveForLoggedin"]},[]))?r:{},j=U.searchVideoForLoggedin,z=U.searchLiveForLoggedin,$=(0,l.useLocation)(),M=(0,P.A)().streamDeviceType,Z=$.pathname,q=!!O,I=(0,c._)((0,T.es)(function(t){var r;return{searchResult:t[e],rootEnterFrom:null==(r=t.searchGlobalParams)?void 0:r.rootEnterFrom}},R.bN),2),C=I[0],H=C.searchResult,W=C.rootEnterFrom,B=I[1],N=(0,p.w)(k.O),J=(0,p.w)(w.F),Q=Z===h.OZ.searchUser,x=G();return(0,d.useCallback)(function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=a!==(null==H?void 0:H.keyword)||t,c=a!==(null==H?void 0:H.keyword)||r,d=!j||q,l=!z||q,p={search_source:null!=i?i:f.Cy.SearchOuter,search_type:e,enter_method:o,from_search_subtab:u,enter_from:null!=s?s:W,pre_click_id:null!=S?S:L,pre_recom_show_id:S,blankpage_enter_from:g,blankpage_enter_method:m,video_page_type:b};switch(e){case f.nX.General:Z===h.OZ.searchHome&&n&&d&&(c&&(B.setSearchResult({key:f.nX.General,result:F.I4}),N.resetItemList({key:_.Lz.SearchTop,loading:!0})),B.getTopSearch({keyword:a,teaParams:p,user:O,language:E,abTestVersion:A,hasSearchLive:x,search_source:i,device_type:M}));break;case f.nX.User:Q&&n&&(c&&B.setSearchResult({key:f.nX.User,result:F.Fy}),B.getUserSearch({keyword:a,teaParams:p,user:O,language:E,abTestVersion:A}));break;case f.nX.Video:Z===h.OZ.searchVideo&&n&&d&&(c&&(B.setSearchResult({key:f.nX.Video,result:F.Fy}),N.resetItemList({key:_.Lz.SearchVideo,loading:!0})),B.getVideoSearch({keyword:a,teaParams:p,user:O,language:E,abTestVersion:A}));break;case f.nX.Live:Z===h.OZ.searchLive&&n&&l&&(c&&(B.setSearchResult({key:f.nX.Live,result:F.Fy}),J.resetLiveList({key:_.Lz.SearchLive,loading:!0})),B.getLiveSearch({keyword:a,teaParams:p,user:O,language:E,abTestVersion:A,device_type:M}));break;case f.nX.Photo:Z===h.OZ.searchPhoto&&n&&d&&(c&&(B.setSearchResult({key:f.nX.Photo,result:F.Fy}),N.resetItemList({key:_.Lz.SearchPhoto,loading:!0})),B.getPhotoSearch({keyword:a,teaParams:p,user:O,language:E,abTestVersion:A}))}},[M,a,null==H?void 0:H.keyword,j,q,o,i,e,Z,Q,B,O,E,A,N,x,J,z,u,W,S,g,m,L,b])}function O(){var e,t,r=X(),n=r.keyword,a=r.enterMethod,o=r.searchSource,i=r.enterFrom,s=r.fromSearchSubTab,u=r.imprId,l=r.blankpageEnterFrom,h=r.blankpageEnterMethod,S=r.videoPageType,g=r.preClickId,m=null!=(e=(0,v.W)(function(){return["user","language","abTestVersion"]},[]))?e:{},b=m.user,w=m.language,L=void 0===w?"en":w,V=m.abTestVersion,O=(null!=(t=(0,y.U)(function(){return["searchVideoForLoggedin"]},[]))?t:{}).searchVideoForLoggedin,D=(0,P.A)().streamDeviceType,E=!!b,A=f.nX.General,U=(0,c._)((0,T.es)(function(e){var t;return{searchResult:e[A],rootEnterFrom:null==(t=e.searchGlobalParams)?void 0:t.rootEnterFrom}},R.bN),2),j=U[0],z=j.searchResult,$=j.rootEnterFrom,M=U[1],Z=(0,p.w)(k.O),q=G();return(0,d.useCallback)(function(){var e,t,r=!(arguments.length>0)||void 0===arguments[0]||arguments[0],c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=arguments.length>2?arguments[2]:void 0;d&&""!==d.trim()?(e=r,t=c):(e=n!==(null==z?void 0:z.keyword)||r,t=n!==(null==z?void 0:z.keyword)||c);var p=!O||E,v={search_source:null!=o?o:f.Cy.SearchOuter,search_type:A,enter_method:a,from_search_subtab:s,enter_from:null!=i?i:$,pre_click_id:null!=u?u:g,pre_recom_show_id:u,blankpage_enter_from:l,blankpage_enter_method:h,video_page_type:S};e&&p&&(t&&(M.setSearchResult({key:f.nX.General,result:F.I4}),Z.resetItemList({key:_.Lz.SearchTop,loading:!0})),M.getTopSearch({keyword:d||n,teaParams:v,user:b,language:L,abTestVersion:V,hasSearchLive:q,search_source:o,device_type:D}))},[O,E,o,A,a,s,i,$,u,g,l,h,S,n,null==z?void 0:z.keyword,M,b,L,V,q,D,Z])}function D(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=X().keyword,n=(0,l.useLocation)(),a=(0,l.useHistory)(),s=n.state,u=n.pathname,p=!!(0,l.matchPath)(u,{path:h.OZ.searchHome}),S=(0,b.CA)().hasRelatedSearch,_=(0,c._)((0,T.es)(function(t){return{searchResult:t[e]}},R.bN),2),v=_[0].searchResult,y=_[1],m=(0,L.rk)(),P=(0,g.JW)(function(e){return e.isSearchPersonalized},R.bN),w=V(e);return(0,d.useEffect)(function(){if(p){var c,u,d,l,h,_=v.data?!v.error&&(null==(u=v.data)||null==(c=u.videoList)?void 0:c.length)===0&&(null==(l=v.data)||null==(d=l.otherDataList)?void 0:d.length)===0:(null==v||null==(h=v.items)?void 0:h.length)===0,g=r!==v.keyword||_;if(t&&a.replace((0,i._)((0,o._)({},n),{state:(0,o._)({},s)})),w(g),g&&S){var R={req_source:"related_search",search_source:e,keyword:r};switch(e){case f.nX.General:m.getTopRelatedSearchData(R);break;case f.nX.User:m.getUserRelatedSearchData(R);break;case f.nX.Video:m.getVideoRelatedSearchData(R);break;case f.nX.Photo:m.getPhotoRelatedSearchData(R);break;case f.nX.Live:m.getLiveRelatedSearchData(R)}}return function(){y.dispose(),m.dispose()}}},[r,S,e,P]),(0,i._)((0,o._)({},v),{keyword:r,handleSearch:w})}var E=(n={},(0,a._)(n,f.nX.General,h.OZ.searchHome),(0,a._)(n,f.nX.User,h.OZ.searchUser),(0,a._)(n,f.nX.Video,h.OZ.searchVideo),(0,a._)(n,f.nX.Live,h.OZ.searchLive),(0,a._)(n,f.nX.Photo,h.OZ.searchPhoto),n);function A(e,t){var r=(0,d.useRef)(0),n=(0,l.useHistory)(),a=(0,l.useLocation)(),o=X(),i=o.keyword,c=o.enterMethod,u=(0,T.IE)(function(e){return{searchGlobalParams:e.searchGlobalParams}},R.bN).searchGlobalParams,h=(0,S.GF)(),p=a.pathname;(0,d.useEffect)(function(){if((0,l.matchPath)(p,{path:E[t]}))return r.current||(r.current=Date.now()),n.listen(function(n){var a,o=n.pathname,d=Date.now()-r.current,l=null==(a=(0,s.A)(E))?void 0:a[o];f.$G.handleSearchSessionFinish({duration:d,impr_id:e,search_id:e,search_type:t,search_keyword:i,enter_method:c,enter_from:null==u?void 0:u.rootEnterFrom,group_id:h,next_tab:l})})},[e,t,u,h,c])}function G(){var e,t,r=null!=(e=(0,v.W)(function(){return["abTestVersion","user"]},[]))?e:{},n=r.abTestVersion,a=r.user;return"v2"===(0,m.qt)(n,"search_add_live")&&(null==(t=null==a?void 0:a.hasSearchLivePermission)||t)}function U(e){var t=(0,T.Pf)();(0,d.useEffect)(function(){t.setSearchGlobalParams({rootEnterFrom:e})},[t,e])}}}]);