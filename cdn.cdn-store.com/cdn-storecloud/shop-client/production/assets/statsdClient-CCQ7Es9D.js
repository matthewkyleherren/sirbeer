var Hc=Object.defineProperty;var Vc=(t,e,n)=>e in t?Hc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var f=(t,e,n)=>Vc(t,typeof e!="symbol"?e+"":e,n);import{g as Gc,x as Et,r as lo}from"./chunk-DQRVZFIR-mrH3D8v7.js";import{r as jc,u as zc,g as jr,d as C,c as ho,b as qc,p as ue,t as se,i as zr,T as Ne,e as K,V as st,f as Xc,S as Kc,h as Wc,I as Yc,j as fo,k as es,R as mt,m as Jc,s as Kt,l as Qc,D as Zc,n as ts}from"./index-BYdSehkX.js";var Z=[];for(var Zn=0;Zn<256;++Zn)Z.push((Zn+256).toString(16).slice(1));function eu(t,e=0){return(Z[t[e+0]]+Z[t[e+1]]+Z[t[e+2]]+Z[t[e+3]]+"-"+Z[t[e+4]]+Z[t[e+5]]+"-"+Z[t[e+6]]+Z[t[e+7]]+"-"+Z[t[e+8]]+Z[t[e+9]]+"-"+Z[t[e+10]]+Z[t[e+11]]+Z[t[e+12]]+Z[t[e+13]]+Z[t[e+14]]+Z[t[e+15]]).toLowerCase()}var Wt,tu=new Uint8Array(16);function nu(){if(!Wt&&(Wt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Wt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Wt(tu)}var ru=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const ns={randomUUID:ru};function dm(t,e,n){if(ns.randomUUID&&!t)return ns.randomUUID();t=t||{};var r=t.random||(t.rng||nu)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,eu(r)}var er={exports:{}},rs;function iu(){return rs||(rs=1,function(t,e){(function(n){t.exports=n()})(function(){var n=["navigation","request","process","log","user","state","error","manual"],r=function(o,u,d){for(var l=d,_=0,g=o.length;_<g;_++)l=u(l,o[_],_,o);return l},i=function(o,u){return r(o,function(d,l,_,g){return u(l,_,g)?d.concat(l):d},[])},s=function(o,u){return r(o,function(d,l,_,g){return d===!0||l===u},!1)},a=function(o){return Object.prototype.toString.call(o)==="[object Array]"},c=!{toString:null}.propertyIsEnumerable("toString"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(o){var u=[],d;for(d in o)Object.prototype.hasOwnProperty.call(o,d)&&u.push(d);if(!c)return u;for(var l=0,_=h.length;l<_;l++)Object.prototype.hasOwnProperty.call(o,h[l])&&u.push(h[l]);return u},m=function(o,u){return o===void 0&&(o=1),function(d){return typeof d=="number"&&parseInt(""+d,10)===d&&d>=o&&d<=u}},v=function(o){return typeof o=="function"||a(o)&&i(o,function(u){return typeof u=="function"}).length===o.length},S=function(o){return typeof o=="string"&&!!o.length},w={},L=function(){return{unhandledExceptions:!0,unhandledRejections:!0}};w.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:S},appVersion:{defaultValue:function(){},message:"should be a string",validate:function(o){return o===void 0||S(o)}},appType:{defaultValue:function(){},message:"should be a string",validate:function(o){return o===void 0||S(o)}},autoDetectErrors:{defaultValue:function(){return!0},message:"should be true|false",validate:function(o){return o===!0||o===!1}},enabledErrorTypes:{defaultValue:function(){return L()},message:"should be an object containing the flags { unhandledExceptions:true|false, unhandledRejections:true|false }",allowPartialObject:!0,validate:function(o){if(typeof o!="object"||!o)return!1;var u=p(o),d=p(L());return!(i(u,function(l){return s(d,l)}).length<u.length||i(p(o),function(l){return typeof o[l]!="boolean"}).length>0)}},onError:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:v},onSession:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:v},onBreadcrumb:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:v},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }",validate:function(o){return o&&typeof o=="object"&&S(o.notify)&&S(o.sessions)&&i(p(o),function(u){return!s(["notify","sessions"],u)}).length===0}},autoTrackSessions:{defaultValue:function(o){return!0},message:"should be true|false",validate:function(o){return o===!0||o===!1}},enabledReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(o){return o===null||a(o)&&i(o,function(u){return typeof u=="string"}).length===o.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(o){return typeof o=="string"&&o.length}},maxBreadcrumbs:{defaultValue:function(){return 25},message:"should be a number ≤100",validate:function(o){return m(0,100)(o)}},enabledBreadcrumbTypes:{defaultValue:function(){return n},message:"should be null or a list of available breadcrumb types ("+n.join(",")+")",validate:function(o){return o===null||a(o)&&r(o,function(u,d){return u===!1?u:s(n,d)},!0)}},context:{defaultValue:function(){},message:"should be a string",validate:function(o){return o===void 0||typeof o=="string"}},user:{defaultValue:function(){return{}},message:"should be an object with { id, email, name } properties",validate:function(o){return o===null||o&&r(p(o),function(u,d){return u&&s(["id","email","name"],d)},!0)}},metadata:{defaultValue:function(){return{}},message:"should be an object",validate:function(o){return typeof o=="object"&&o!==null}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(o){return!o||o&&r(["debug","info","warn","error"],function(u,d){return u&&typeof o[d]=="function"},!0)}},redactedKeys:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(o){return a(o)&&o.length===i(o,function(u){return typeof u=="string"||u&&typeof u.test=="function"}).length}},plugins:{defaultValue:function(){return[]},message:"should be an array of plugin objects",validate:function(o){return a(o)&&o.length===i(o,function(u){return u&&typeof u=="object"&&typeof u.load=="function"}).length}},featureFlags:{defaultValue:function(){return[]},message:'should be an array of objects that have a "name" property',validate:function(o){return a(o)&&o.length===i(o,function(u){return u&&typeof u=="object"&&typeof u.name=="string"}).length}}};var A=function(o){for(var u=1;u<arguments.length;u++){var d=arguments[u];for(var l in d)Object.prototype.hasOwnProperty.call(d,l)&&(o[l]=d[l])}return o},R=function(o,u){return r(o,function(d,l,_,g){return d.concat(u(l,_,g))},[])};function I(){return I=Object.assign?Object.assign.bind():function(o){for(var u=1;u<arguments.length;u++){var d=arguments[u];for(var l in d)Object.prototype.hasOwnProperty.call(d,l)&&(o[l]=d[l])}return o},I.apply(this,arguments)}var B=w.schema,V={releaseStage:A({},B.releaseStage,{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"}}),appType:I({},B.appType,{defaultValue:function(){return"browser"}}),logger:A({},B.logger,{defaultValue:function(){return typeof console<"u"&&typeof console.debug=="function"?H():void 0}})},H=function(){var o={},u=console.log;return R(["debug","info","warn","error"],function(d){var l=console[d];o[d]=typeof l=="function"?l.bind(console,"[bugsnag]"):u.bind(console,"[bugsnag]")}),o},$=function(){function o(d,l,_,g){g===void 0&&(g=new Date),this.type=_,this.message=d,this.metadata=l,this.timestamp=g}var u=o.prototype;return u.toJSON=function(){return{type:this.type,name:this.message,timestamp:this.timestamp,metaData:this.metadata}},o}(),U=$,q={};(function(o,u){typeof q=="object"?q=u():o.StackFrame=u()})(this,function(){function o(T){return!isNaN(parseFloat(T))&&isFinite(T)}function u(T){return T.charAt(0).toUpperCase()+T.substring(1)}function d(T){return function(){return this[T]}}var l=["isConstructor","isEval","isNative","isToplevel"],_=["columnNumber","lineNumber"],g=["fileName","functionName","source"],y=["args"],E=l.concat(_,g,y);function b(T){if(T instanceof Object)for(var N=0;N<E.length;N++)T.hasOwnProperty(E[N])&&T[E[N]]!==void 0&&this["set"+u(E[N])](T[E[N]])}b.prototype={getArgs:function(){return this.args},setArgs:function(T){if(Object.prototype.toString.call(T)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=T},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(T){if(T instanceof b)this.evalOrigin=T;else if(T instanceof Object)this.evalOrigin=new b(T);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var T=this.getFunctionName()||"{anonymous}",N="("+(this.getArgs()||[]).join(",")+")",F=this.getFileName()?"@"+this.getFileName():"",X=o(this.getLineNumber())?":"+this.getLineNumber():"",P=o(this.getColumnNumber())?":"+this.getColumnNumber():"";return T+N+F+X+P}};for(var x=0;x<l.length;x++)b.prototype["get"+u(l[x])]=d(l[x]),b.prototype["set"+u(l[x])]=function(T){return function(N){this[T]=!!N}}(l[x]);for(var O=0;O<_.length;O++)b.prototype["get"+u(_[O])]=d(_[O]),b.prototype["set"+u(_[O])]=function(T){return function(N){if(!o(N))throw new TypeError(T+" must be a Number");this[T]=Number(N)}}(_[O]);for(var M=0;M<g.length;M++)b.prototype["get"+u(g[M])]=d(g[M]),b.prototype["set"+u(g[M])]=function(T){return function(N){this[T]=String(N)}}(g[M]);return b});var oe={};(function(o,u){typeof oe=="object"?oe=u(q):o.ErrorStackParser=u(o.StackFrame)})(this,function(u){var d=/(^|@)\S+\:\d+/,l=/^\s*at .*(\S+\:\d+|\(native\))/m,_=/^(eval@)?(\[native code\])?$/;return{parse:function(y){if(typeof y.stacktrace<"u"||typeof y["opera#sourceloc"]<"u")return this.parseOpera(y);if(y.stack&&y.stack.match(l))return this.parseV8OrIE(y);if(y.stack)return this.parseFFOrSafari(y);throw new Error("Cannot parse given Error object")},extractLocation:function(y){if(y.indexOf(":")===-1)return[y];var E=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,b=E.exec(y.replace(/[\(\)]/g,""));return[b[1],b[2]||void 0,b[3]||void 0]},parseV8OrIE:function(y){var E=y.stack.split(`
`).filter(function(b){return!!b.match(l)},this);return E.map(function(b){b.indexOf("(eval ")>-1&&(b=b.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var x=b.replace(/^\s+/,"").replace(/\(eval code/g,"("),O=x.match(/ (\((.+):(\d+):(\d+)\)$)/);x=O?x.replace(O[0],""):x;var M=x.split(/\s+/).slice(1),T=this.extractLocation(O?O[1]:M.pop()),N=M.join(" ")||void 0,F=["eval","<anonymous>"].indexOf(T[0])>-1?void 0:T[0];return new u({functionName:N,fileName:F,lineNumber:T[1],columnNumber:T[2],source:b})},this)},parseFFOrSafari:function(y){var E=y.stack.split(`
`).filter(function(b){return!b.match(_)},this);return E.map(function(b){if(b.indexOf(" > eval")>-1&&(b=b.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),b.indexOf("@")===-1&&b.indexOf(":")===-1)return new u({functionName:b});var x=/((.*".+"[^@]*)?[^@]*)(?:@)/,O=b.match(x),M=O&&O[1]?O[1]:void 0,T=this.extractLocation(b.replace(x,""));return new u({functionName:M,fileName:T[0],lineNumber:T[1],columnNumber:T[2],source:b})},this)},parseOpera:function(y){return!y.stacktrace||y.message.indexOf(`
`)>-1&&y.message.split(`
`).length>y.stacktrace.split(`
`).length?this.parseOpera9(y):y.stack?this.parseOpera11(y):this.parseOpera10(y)},parseOpera9:function(y){for(var E=/Line (\d+).*script (?:in )?(\S+)/i,b=y.message.split(`
`),x=[],O=2,M=b.length;O<M;O+=2){var T=E.exec(b[O]);T&&x.push(new u({fileName:T[2],lineNumber:T[1],source:b[O]}))}return x},parseOpera10:function(y){for(var E=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,b=y.stacktrace.split(`
`),x=[],O=0,M=b.length;O<M;O+=2){var T=E.exec(b[O]);T&&x.push(new u({functionName:T[3]||void 0,fileName:T[2],lineNumber:T[1],source:b[O]}))}return x},parseOpera11:function(y){var E=y.stack.split(`
`).filter(function(b){return!!b.match(d)&&!b.match(/^Error created at/)},this);return E.map(function(b){var x=b.split("@"),O=this.extractLocation(x.pop()),M=x.shift()||"",T=M.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0,N;M.match(/\(([^\)]*)\)/)&&(N=M.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var F=N===void 0||N==="[arguments not available]"?void 0:N.split(",");return new u({functionName:T,args:F,fileName:O[0],lineNumber:O[1],columnNumber:O[2],source:b})},this)}}});var J=oe,fe=function(o,u,d,l){var _=l&&l.redactedKeys?l.redactedKeys:[],g=l&&l.redactedPaths?l.redactedPaths:[];return JSON.stringify(Vt(o,_,g),u,d)},dt=20,kn=25e3,Un=8,we="...";function Bt(o){return o instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(o))}function He(o){return"[Throws: "+(o?o.message:"?")+"]"}function $t(o,u){for(var d=0,l=o.length;d<l;d++)if(o[d]===u)return!0;return!1}function Ve(o,u){for(var d=0,l=o.length;d<l;d++)if(u.indexOf(o[d])===0)return!0;return!1}function Ft(o,u){for(var d=0,l=o.length;d<l;d++)if(typeof o[d]=="string"&&o[d].toLowerCase()===u.toLowerCase()||o[d]&&typeof o[d].test=="function"&&o[d].test(u))return!0;return!1}function ht(o){return Object.prototype.toString.call(o)==="[object Array]"}function Ht(o,u){try{return o[u]}catch(d){return He(d)}}function Vt(o,u,d){var l=[],_=0;function g(y,E){function b(){return E.length>Un&&_>kn}if(_++,E.length>dt||b())return we;if(y===null||typeof y!="object")return y;if($t(l,y))return"[Circular]";if(l.push(y),typeof y.toJSON=="function")try{_--;var x=g(y.toJSON(),E);return l.pop(),x}catch(D){return He(D)}var O=Bt(y);if(O){_--;var M=g({name:y.name,message:y.message},E);return l.pop(),M}if(ht(y)){for(var T=[],N=0,F=y.length;N<F;N++){if(b()){T.push(we);break}T.push(g(y[N],E.concat("[]")))}return l.pop(),T}var X={};try{for(var P in y)if(Object.prototype.hasOwnProperty.call(y,P)){if(Ve(d,E.join("."))&&Ft(u,P)){X[P]="[REDACTED]";continue}if(b()){X[P]=we;break}X[P]=g(Ht(y,P),E.concat(P))}}catch{}return l.pop(),X}return g(o,[])}function Ge(o,u,d,l){if(typeof d=="string"){l===void 0?l=null:l!==null&&typeof l!="string"&&(l=fe(l));var _=u[d];if(typeof _=="number"){o[_]={name:d,variant:l};return}o.push({name:d,variant:l}),u[d]=o.length-1}}function je(o,u,d){if(a(u)){for(var l=0;l<u.length;++l){var _=u[l];_===null||typeof _!="object"||Ge(o,d,_.name,_.variant)}return o}}function ft(o){return R(i(o,Boolean),function(u){var d=u.name,l=u.variant,_={featureFlag:d};return typeof l=="string"&&(_.variant=l),_})}function Gt(o,u,d){var l=u[d];typeof l=="number"&&(o[l]=null,delete u[d])}var pe={add:Ge,clear:Gt,merge:je,toEventApi:ft},Te=function(o){return!!o&&(!!o.stack||!!o.stacktrace||!!o["opera#sourceloc"])&&typeof(o.stack||o.stacktrace||o["opera#sourceloc"])=="string"&&o.stack!==o.name+": "+o.message},Dn=Va;function Va(o){switch(Object.prototype.toString.call(o)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return o instanceof Error}}var jt=Dn,Ga=function(o,u,d,l){var _;if(u){var g;if(d===null)return bi(o,u);typeof d=="object"&&(g=d),typeof d=="string"&&(g=(_={},_[d]=l,_)),g&&(u==="__proto__"||u==="constructor"||u==="prototype"||(o[u]||(o[u]={}),o[u]=A({},o[u],g)))}},ja=function(o,u,d){if(typeof u=="string"){if(!d)return o[u];if(o[u])return o[u][d]}},bi=function(o,u,d){if(typeof u=="string"){if(!d){delete o[u];return}u==="__proto__"||u==="constructor"||u==="prototype"||o[u]&&delete o[u][d]}},ze={add:Ga,get:ja,clear:bi},Bn={};(function(o,u){typeof Bn=="object"?Bn=u(q):o.StackGenerator=u(o.StackFrame)})(this,function(o){return{backtrace:function(d){var l=[],_=10;typeof d=="object"&&typeof d.maxStackSize=="number"&&(_=d.maxStackSize);for(var g=arguments.callee;g&&l.length<_&&g.arguments;){for(var y=new Array(g.arguments.length),E=0;E<y.length;++E)y[E]=g.arguments[E];/function(?:\s+([\w$]+))+\s*\(/.test(g.toString())?l.push(new o({functionName:RegExp.$1||void 0,args:y})):l.push(new o({args:y}));try{g=g.caller}catch{break}}return l}}});function $n(){return $n=Object.assign?Object.assign.bind():function(o){for(var u=1;u<arguments.length;u++){var d=arguments[u];for(var l in d)Object.prototype.hasOwnProperty.call(d,l)&&(o[l]=d[l])}return o},$n.apply(this,arguments)}var ve=function(){function o(d,l,_,g,y){_===void 0&&(_=[]),g===void 0&&(g=Xa()),this.apiKey=void 0,this.context=void 0,this.groupingHash=void 0,this.originalError=y,this._handledState=g,this.severity=this._handledState.severity,this.unhandled=this._handledState.unhandled,this.app={},this.device={},this.request={},this.breadcrumbs=[],this.threads=[],this._metadata={},this._features=[],this._featuresIndex={},this._user={},this._session=void 0,this._correlation=void 0,this.errors=[wi(d,l,o.__type,_)]}var u=o.prototype;return u.addMetadata=function(l,_,g){return ze.add(this._metadata,l,_,g)},u.setTraceCorrelation=function(l,_){typeof l=="string"&&(this._correlation=$n({traceId:l},typeof _=="string"?{spanId:_}:{}))},u.getMetadata=function(l,_){return ze.get(this._metadata,l,_)},u.clearMetadata=function(l,_){return ze.clear(this._metadata,l,_)},u.addFeatureFlag=function(l,_){_===void 0&&(_=null),pe.add(this._features,this._featuresIndex,l,_)},u.addFeatureFlags=function(l){pe.merge(this._features,l,this._featuresIndex)},u.getFeatureFlags=function(){return pe.toEventApi(this._features)},u.clearFeatureFlag=function(l){pe.clear(this._features,this._featuresIndex,l)},u.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},u.getUser=function(){return this._user},u.setUser=function(l,_,g){this._user={id:l,email:_,name:g}},u.toJSON=function(){return{payloadVersion:"4",exceptions:R(this.errors,function(l){return A({},l,{message:l.errorMessage})}),severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,request:this.request,breadcrumbs:this.breadcrumbs,context:this.context,groupingHash:this.groupingHash,metaData:this._metadata,user:this._user,session:this._session,featureFlags:this.getFeatureFlags(),correlation:this._correlation}},o}(),za=function(o){var u={file:o.fileName,method:qa(o.functionName),lineNumber:o.lineNumber,columnNumber:o.columnNumber,code:void 0,inProject:void 0};return u.lineNumber>-1&&!u.file&&!u.method&&(u.file="global code"),u},qa=function(o){return/^global code$/i.test(o)?"global code":o},Xa=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},Ei=function(o){return typeof o=="string"?o:""};function wi(o,u,d,l){return{errorClass:Ei(o),errorMessage:Ei(u),type:d,stacktrace:r(l,function(_,g){var y=za(g);try{return JSON.stringify(y)==="{}"?_:_.concat(y)}catch{return _}},[])}}function Ti(o){return o.cause?[o].concat(Ti(o.cause)):[o]}ve.getStacktrace=function(o,u,d){if(Te(o))return J.parse(o).slice(u);try{return i(Bn.backtrace(),function(l){return(l.functionName||"").indexOf("StackGenerator$$")===-1}).slice(1+d)}catch{return[]}},ve.create=function(o,u,d,l,_,g){_===void 0&&(_=0);var y=Ci(o,u,l,g),E=y[0],b=y[1],x;try{var O=ve.getStacktrace(E,b>0?1+b+_:0,1+_);x=new ve(E.name,E.message,O,d,o)}catch{x=new ve(E.name,E.message,[],d,o)}if(E.name==="InvalidError"&&x.addMetadata(""+l,"non-error parameter",Ai(o)),E.cause){var M,T=Ti(E).slice(1),N=R(T,function(F){var X=jt(F)&&Te(F)?J.parse(F):[],P=Ci(F,!0,"error cause"),D=P[0];return D.name==="InvalidError"&&x.addMetadata("error cause",Ai(F)),wi(D.name,D.message,ve.__type,X)});(M=x.errors).push.apply(M,N)}return x};var Ai=function(o){return o===null?"null":o===void 0?"undefined":o},Ci=function(o,u,d,l){var _,g=0,y=function(E){var b=d==="error cause"?"was":"received";l&&l.warn(d+" "+b+' a non-error: "'+E+'"');var x=new Error(d+" "+b+' a non-error. See "'+d+'" tab for more detail.');return x.name="InvalidError",x};if(!u)jt(o)?_=o:(_=y(typeof o),g+=2);else switch(typeof o){case"string":case"number":case"boolean":_=new Error(String(o)),g+=1;break;case"function":_=y("function"),g+=2;break;case"object":o!==null&&jt(o)?_=o:o!==null&&Ka(o)?(_=new Error(o.message||o.errorMessage),_.name=o.name||o.errorClass,g+=1):(_=y(o===null?"null":"unsupported object"),g+=2);break;default:_=y("nothing"),g+=2}if(!Te(_))try{throw _}catch(E){Te(E)&&(_=E,g=1)}return[_,g]};ve.__type="browserjs";var Ka=function(o){return(typeof o.name=="string"||typeof o.errorClass=="string")&&(typeof o.message=="string"||typeof o.errorMessage=="string")},Fn=ve,Wa=function(o,u,d){var l=0,_=function(){if(l>=o.length)return d(null,!0);u(o[l],function(g,y){if(g)return d(g);if(y===!1)return d(null,!1);l++,_()})};_()},Ya=function(o,u,d,l){var _=function(g,y){if(typeof g!="function")return y(null);try{if(g.length!==2){var E=g(u);return E&&typeof E.then=="function"?E.then(function(b){return setTimeout(function(){return y(null,b)})},function(b){setTimeout(function(){return d(b),y(null,!0)})}):y(null,E)}g(u,function(b,x){if(b)return d(b),y(null);y(null,x)})}catch(b){d(b),y(null)}};Wa(o,_,l)},Oi=function(o,u,d,l){for(var _=!1,g=o.slice();!_&&g.length;)try{_=g.pop()(u)===!1}catch(y){l.error("Error occurred in "+d+" callback, continuing anyway…"),l.error(y)}return _},Hn=function(u,d){var l="000000000"+u;return l.substr(l.length-d)},xi=typeof window=="object"?window:self,Ri=0;for(var Ja in xi)Object.hasOwnProperty.call(xi,Ja)&&Ri++;var Qa=navigator.mimeTypes?navigator.mimeTypes.length:0,Za=Hn((Qa+navigator.userAgent.length).toString(36)+Ri.toString(36),4),Li=function(){return Za},pt=0,Vn=4,zt=36,Mi=Math.pow(zt,Vn);function Pi(){return Hn((Math.random()*Mi<<0).toString(zt),Vn)}function ec(){return pt=pt<Mi?pt:0,pt++,pt-1}function Ii(){var o="c",u=new Date().getTime().toString(zt),d=Hn(ec().toString(zt),Vn),l=Li(),_=Pi()+Pi();return o+u+d+l+_}Ii.fingerprint=Li;var tc=Ii,nc=function(){function o(){this.id=tc(),this.startedAt=new Date,this._handled=0,this._unhandled=0,this._user={},this.app={},this.device={}}var u=o.prototype;return u.getUser=function(){return this._user},u.setUser=function(l,_,g){this._user={id:l,email:_,name:g}},u.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},u._track=function(l){this[l._handledState.unhandled?"_unhandled":"_handled"]+=1},o}(),Gn=nc,rc=pe.add,ic=pe.clear,jn=pe.merge,Se=function(){},sc=function(){function o(d,l,_,g){var y=this;l===void 0&&(l=w.schema),_===void 0&&(_=[]),this._notifier=g,this._config={},this._schema=l,this._delivery={sendSession:Se,sendEvent:Se},this._logger={debug:Se,info:Se,warn:Se,error:Se},this._plugins={},this._breadcrumbs=[],this._session=null,this._metadata={},this._featuresIndex={},this._features=[],this._context=void 0,this._user={},this._cbs={e:[],s:[],sp:[],b:[]},this.Client=o,this.Event=Fn,this.Breadcrumb=U,this.Session=Gn,this._config=this._configure(d,_),R(_.concat(this._config.plugins),function(x){x&&y._loadPlugin(x)}),this._depth=1;var E=this,b=this.notify;this.notify=function(){return b.apply(E,arguments)}}var u=o.prototype;return u.addMetadata=function(l,_,g){return ze.add(this._metadata,l,_,g)},u.getMetadata=function(l,_){return ze.get(this._metadata,l,_)},u.clearMetadata=function(l,_){return ze.clear(this._metadata,l,_)},u.addFeatureFlag=function(l,_){_===void 0&&(_=null),rc(this._features,this._featuresIndex,l,_)},u.addFeatureFlags=function(l){jn(this._features,l,this._featuresIndex)},u.clearFeatureFlag=function(l){ic(this._features,this._featuresIndex,l)},u.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},u.getContext=function(){return this._context},u.setContext=function(l){this._context=l},u._configure=function(l,_){var g=r(_,function(x,O){return O&&O.configSchema?A({},x,O.configSchema):x},this._schema),y=r(p(g),function(x,O){var M=g[O].defaultValue(l[O]);if(l[O]!==void 0){var T=g[O].validate(l[O]);T?g[O].allowPartialObject?x.config[O]=A(M,l[O]):x.config[O]=l[O]:(x.errors[O]=g[O].message,x.config[O]=M)}else x.config[O]=M;return x},{errors:{},config:{}}),E=y.errors,b=y.config;if(g.apiKey){if(!b.apiKey)throw new Error("No Bugsnag API Key set");/^[0-9a-f]{32}$/i.test(b.apiKey)||(E.apiKey="should be a string of 32 hexadecimal characters")}return this._metadata=A({},b.metadata),jn(this._features,b.featureFlags,this._featuresIndex),this._user=A({},b.user),this._context=b.context,b.logger&&(this._logger=b.logger),b.onError&&(this._cbs.e=this._cbs.e.concat(b.onError)),b.onBreadcrumb&&(this._cbs.b=this._cbs.b.concat(b.onBreadcrumb)),b.onSession&&(this._cbs.s=this._cbs.s.concat(b.onSession)),p(E).length&&this._logger.warn(oc(E,l)),b},u.getUser=function(){return this._user},u.setUser=function(l,_,g){this._user={id:l,email:_,name:g}},u._loadPlugin=function(l){var _=l.load(this);return l.name&&(this._plugins["~"+l.name+"~"]=_),this},u.getPlugin=function(l){return this._plugins["~"+l+"~"]},u._setDelivery=function(l){this._delivery=l(this)},u.startSession=function(){var l=new Gn;l.app.releaseStage=this._config.releaseStage,l.app.version=this._config.appVersion,l.app.type=this._config.appType,l._user=A({},this._user);var _=Oi(this._cbs.s,l,"onSession",this._logger);return _?(this._logger.debug("Session not started due to onSession callback"),this):this._sessionDelegate.startSession(this,l)},u.addOnError=function(l,_){_===void 0&&(_=!1),this._cbs.e[_?"unshift":"push"](l)},u.removeOnError=function(l){this._cbs.e=i(this._cbs.e,function(_){return _!==l})},u._addOnSessionPayload=function(l){this._cbs.sp.push(l)},u.addOnSession=function(l){this._cbs.s.push(l)},u.removeOnSession=function(l){this._cbs.s=i(this._cbs.s,function(_){return _!==l})},u.addOnBreadcrumb=function(l,_){_===void 0&&(_=!1),this._cbs.b[_?"unshift":"push"](l)},u.removeOnBreadcrumb=function(l){this._cbs.b=i(this._cbs.b,function(_){return _!==l})},u.pauseSession=function(){return this._sessionDelegate.pauseSession(this)},u.resumeSession=function(){return this._sessionDelegate.resumeSession(this)},u.leaveBreadcrumb=function(l,_,g){if(l=typeof l=="string"?l:"",g=typeof g=="string"&&s(n,g)?g:"manual",_=typeof _=="object"&&_!==null?_:{},!!l){var y=new U(l,_,g),E=Oi(this._cbs.b,y,"onBreadcrumb",this._logger);if(E){this._logger.debug("Breadcrumb not attached due to onBreadcrumb callback");return}this._breadcrumbs.push(y),this._breadcrumbs.length>this._config.maxBreadcrumbs&&(this._breadcrumbs=this._breadcrumbs.slice(this._breadcrumbs.length-this._config.maxBreadcrumbs))}},u._isBreadcrumbTypeEnabled=function(l){var _=this._config.enabledBreadcrumbTypes;return _===null||s(_,l)},u.notify=function(l,_,g){g===void 0&&(g=Se);var y=Fn.create(l,!0,void 0,"notify()",this._depth+1,this._logger);this._notify(y,_,g)},u._notify=function(l,_,g){var y=this;if(g===void 0&&(g=Se),l.app=A({},l.app,{releaseStage:this._config.releaseStage,version:this._config.appVersion,type:this._config.appType}),l.context=l.context||this._context,l._metadata=A({},l._metadata,this._metadata),l._user=A({},l._user,this._user),l.breadcrumbs=this._breadcrumbs.slice(),jn(l._features,this._features,l._featuresIndex),this._config.enabledReleaseStages!==null&&!s(this._config.enabledReleaseStages,this._config.releaseStage))return this._logger.warn("Event not sent due to releaseStage/enabledReleaseStages configuration"),g(null,l);var E=l.severity,b=function(O){y._logger.error("Error occurred in onError callback, continuing anyway…"),y._logger.error(O)},x=[].concat(this._cbs.e).concat(_);Ya(x,l,b,function(O,M){if(O&&b(O),!M)return y._logger.debug("Event not sent due to onError callback"),g(null,l);y._isBreadcrumbTypeEnabled("error")&&o.prototype.leaveBreadcrumb.call(y,l.errors[0].errorClass,{errorClass:l.errors[0].errorClass,errorMessage:l.errors[0].errorMessage,severity:l.severity},"error"),E!==l.severity&&(l._handledState.severityReason={type:"userCallbackSetSeverity"}),l.unhandled!==l._handledState.unhandled&&(l._handledState.severityReason.unhandledOverridden=!0,l._handledState.unhandled=l.unhandled),y._session&&(y._session._track(l),l._session=y._session),y._delivery.sendEvent({apiKey:l.apiKey||y._config.apiKey,notifier:y._notifier,events:[l]},function(T){return g(T,l)})})},o}(),oc=function(o,u){var d=new Error(`Invalid configuration
`+R(p(o),function(l){return"  - "+l+" "+o[l]+", got "+ac(u[l])}).join(`

`));return d},ac=function(o){switch(typeof o){case"string":case"number":case"object":return JSON.stringify(o);default:return String(o)}},zn=sc,qe={},Ni=["events.[].metaData","events.[].breadcrumbs.[].metaData","events.[].request"];qe.event=function(o,u){var d=fe(o,null,null,{redactedPaths:Ni,redactedKeys:u});return d.length>1e6&&(o.events[0]._metadata={notifier:`WARNING!
Serialized payload was `+d.length/1e6+`MB (limit = 1MB)
metadata was removed`},d=fe(o,null,null,{redactedPaths:Ni,redactedKeys:u})),d},qe.session=function(o,u){var d=fe(o,null,null);return d};var qn={};qn=function(o,u){return u===void 0&&(u=window),{sendEvent:function(d,l){l===void 0&&(l=function(){});var _=ki(o._config,"notify","4",u),g=qe.event(d,o._config.redactedKeys),y=new u.XDomainRequest;y.onload=function(){l(null)},y.onerror=function(){var E=new Error("Event failed to send");o._logger.error("Event failed to send…",E),g.length>1e6&&o._logger.warn("Event oversized ("+(g.length/1e6).toFixed(2)+" MB)"),l(E)},y.open("POST",_),setTimeout(function(){try{y.send(g)}catch(E){o._logger.error(E),l(E)}},0)},sendSession:function(d,l){l===void 0&&(l=function(){});var _=ki(o._config,"sessions","1",u),g=new u.XDomainRequest;g.onload=function(){l(null)},g.open("POST",_),setTimeout(function(){try{g.send(qe.session(d,o._config.redactedKeys))}catch(y){o._logger.error(y),l(y)}},0)}}};var ki=function(o,u,d,l){var _=JSON.parse(JSON.stringify(new Date)),g=cc(o.endpoints[u],l.location.protocol);return g+"?apiKey="+encodeURIComponent(o.apiKey)+"&payloadVersion="+d+"&sentAt="+encodeURIComponent(_)},cc=qn._matchPageProtocol=function(o,u){return u==="http:"?o.replace(/^https:/,"http:"):o},uc=function(o,u){return u===void 0&&(u=window),{sendEvent:function(d,l){l===void 0&&(l=function(){});try{var _=o._config.endpoints.notify,g=new u.XMLHttpRequest,y=qe.event(d,o._config.redactedKeys);g.onreadystatechange=function(){if(g.readyState===u.XMLHttpRequest.DONE){var E=g.status;if(E===0||E>=400){var b=new Error("Request failed with status "+E);o._logger.error("Event failed to send…",b),y.length>1e6&&o._logger.warn("Event oversized ("+(y.length/1e6).toFixed(2)+" MB)"),l(b)}else l(null)}},g.open("POST",_),g.setRequestHeader("Content-Type","application/json"),g.setRequestHeader("Bugsnag-Api-Key",d.apiKey||o._config.apiKey),g.setRequestHeader("Bugsnag-Payload-Version","4"),g.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),g.send(y)}catch(E){o._logger.error(E)}},sendSession:function(d,l){l===void 0&&(l=function(){});try{var _=o._config.endpoints.sessions,g=new u.XMLHttpRequest;g.onreadystatechange=function(){if(g.readyState===u.XMLHttpRequest.DONE){var y=g.status;if(y===0||y>=400){var E=new Error("Request failed with status "+y);o._logger.error("Session failed to send…",E),l(E)}else l(null)}},g.open("POST",_),g.setRequestHeader("Content-Type","application/json"),g.setRequestHeader("Bugsnag-Api-Key",o._config.apiKey),g.setRequestHeader("Bugsnag-Payload-Version","1"),g.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),g.send(qe.session(d,o._config.redactedKeys))}catch(y){o._logger.error(y)}}}},Ui=new Date,lc=function(){Ui=new Date},dc={name:"appDuration",load:function(o){return o.addOnError(function(u){var d=new Date;u.app.duration=d-Ui},!0),{reset:lc}}},hc=function(o){return o===void 0&&(o=window),{load:function(u){u.addOnError(function(d){d.context===void 0&&(d.context=o.location.pathname)},!0)}}},Xn=function(u,d){var l="000000000"+u;return l.substr(l.length-d)},Di=typeof window=="object"?window:self,Bi=0;for(var fc in Di)Object.hasOwnProperty.call(Di,fc)&&Bi++;var pc=navigator.mimeTypes?navigator.mimeTypes.length:0,_c=Xn((pc+navigator.userAgent.length).toString(36)+Bi.toString(36),4),$i=function(){return _c},_t=0,Kn=4,qt=36,Fi=Math.pow(qt,Kn);function Hi(){return Xn((Math.random()*Fi<<0).toString(qt),Kn)}function gc(){return _t=_t<Fi?_t:0,_t++,_t-1}function Vi(){var o="c",u=new Date().getTime().toString(qt),d=Xn(gc().toString(qt),Kn),l=$i(),_=Hi()+Hi();return o+u+d+l+_}Vi.fingerprint=$i;var mc=Vi,Gi="bugsnag-anonymous-id",yc=function(o){try{var u=o.localStorage,d=u.getItem(Gi);return d&&/^c[a-z0-9]{20,32}$/.test(d)||(d=mc(),u.setItem(Gi,d)),d}catch{}},vc=function(o,u){return o===void 0&&(o=navigator),u===void 0&&(u=window),{load:function(d){var l={locale:o.browserLanguage||o.systemLanguage||o.userLanguage||o.language,userAgent:o.userAgent};u&&u.screen&&u.screen.orientation&&u.screen.orientation.type?l.orientation=u.screen.orientation.type:u&&u.document&&(l.orientation=u.document.documentElement.clientWidth>u.document.documentElement.clientHeight?"landscape":"portrait"),d._config.generateAnonymousId&&(l.id=yc(u)),d.addOnSession(function(_){_.device=A({},_.device,l),d._config.collectUserIp||ji(_)}),d.addOnError(function(_){_.device=A({},_.device,l,{time:new Date}),d._config.collectUserIp||ji(_)},!0)},configSchema:{generateAnonymousId:{validate:function(d){return d===!0||d===!1},defaultValue:function(){return!0},message:"should be true|false"}}}},ji=function(o){var u=o.getUser();(!u||!u.id)&&o.setUser(o.device.id)},Sc=function(o){return o===void 0&&(o=window),{load:function(u){u.addOnError(function(d){d.request&&d.request.url||(d.request=A({},d.request,{url:o.location.href}))},!0)}}},bc={load:function(o){o._sessionDelegate=Ec}},Ec={startSession:function(o,u){var d=o;return d._session=u,d._pausedSession=null,d._config.enabledReleaseStages!==null&&!s(d._config.enabledReleaseStages,d._config.releaseStage)?(d._logger.warn("Session not sent due to releaseStage/enabledReleaseStages configuration"),d):(d._delivery.sendSession({notifier:d._notifier,device:u.device,app:u.app,sessions:[{id:u.id,startedAt:u.startedAt,user:u._user}]}),d)},resumeSession:function(o){return o._session?o:o._pausedSession?(o._session=o._pausedSession,o._pausedSession=null,o):o.startSession()},pauseSession:function(o){o._pausedSession=o._session,o._session=null}},wc={load:function(o){o._config.collectUserIp||o.addOnError(function(u){u._user&&typeof u._user.id>"u"&&delete u._user.id,u._user=A({id:"[REDACTED]"},u._user),u.request=A({clientIp:"[REDACTED]"},u.request)})},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(o){return o===!0||o===!1}}}},zi={};zi.load=function(o){var u=/^(local-)?dev(elopment)?$/.test(o._config.releaseStage);u||!o._isBreadcrumbTypeEnabled("log")||R(Tc,function(d){var l=console[d];console[d]=function(){for(var _=arguments.length,g=new Array(_),y=0;y<_;y++)g[y]=arguments[y];o.leaveBreadcrumb("Console output",r(g,function(E,b,x){var O="[Unknown value]";try{O=String(b)}catch{}if(O==="[object Object]")try{O=JSON.stringify(b)}catch{}return E["["+x+"]"]=O,E},{severity:d.indexOf("group")===0?"log":d}),"log"),l.apply(console,g)},console[d]._restore=function(){console[d]=l}})};var Tc=i(["log","debug","info","warn","error"],function(o){return typeof console<"u"&&typeof console[o]=="function"}),qi=200,Xi=5e5,Ac=function(o,u){return o===void 0&&(o=document),u===void 0&&(u=window),{load:function(d){if(!d._config.trackInlineScripts)return;var l=u.location.href,_="",g=!!o.attachEvent,y=g?o.readyState==="complete":o.readyState!=="loading",E=function(){return o.documentElement.outerHTML};_=E();var b=o.onreadystatechange;o.onreadystatechange=function(){o.readyState==="interactive"&&(_=E(),y=!0);try{b.apply(this,arguments)}catch{}};var x=null,O=function(P){x=P},M=function(){var P=o.currentScript||x;if(!P&&!y){var D=o.scripts||o.getElementsByTagName("script");P=D[D.length-1]}return P},T=function(P){(!y||!_)&&(_=E());var D=["<!-- DOC START -->"].concat(_.split(`
`)),Q=P-1,Y=Math.max(Q-3,0),ie=Math.min(Q+3,D.length);return r(D.slice(Y,ie),function(ne,gt,Qn){return ne[Y+1+Qn]=gt.length<=qi?gt:gt.substr(0,qi),ne},{})};d.addOnError(function(P){P.errors[0].stacktrace=i(P.errors[0].stacktrace,function(ne){return!/__trace__$/.test(ne.method)});var D=P.errors[0].stacktrace[0],Q=function(ne){return ne.replace(/#.*$/,"").replace(/\?.*$/,"")};if(!(D&&D.file&&Q(D.file)!==Q(l))){var Y=M();if(Y){var ie=Y.innerHTML;P.addMetadata("script","content",ie.length<=Xi?ie:ie.substr(0,Xi)),D&&D.lineNumber&&(D.code=T(D.lineNumber))}}},!0);var N=R(["setTimeout","setInterval","setImmediate","requestAnimationFrame"],function(P){return Wn(u,P,function(D){return X(D,function(Q){return{get:function(){return Q[0]},replace:function(Y){Q[0]=Y}}})})}),F=N[0];R(["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],function(P){!u[P]||!u[P].prototype||!Object.prototype.hasOwnProperty.call(u[P].prototype,"addEventListener")||(Wn(u[P].prototype,"addEventListener",function(D){return X(D,Ki)}),Wn(u[P].prototype,"removeEventListener",function(D){return X(D,Ki,!0)}))});function X(P,D,Q){return Q===void 0&&(Q=!1),function(){var Y=[].slice.call(arguments);try{var ie=D(Y),ne=ie.get();if(Q&&P.apply(this,Y),typeof ne!="function")return P.apply(this,Y);if(ne.__trace__)ie.replace(ne.__trace__);else{var gt=M();ne.__trace__=function(){O(gt),F(function(){O(null)},0);var Fc=ne.apply(this,arguments);return O(null),Fc},ne.__trace__.__trace__=ne.__trace__,ie.replace(ne.__trace__)}}catch{}if(P.apply)return P.apply(this,Y);switch(Y.length){case 1:return P(Y[0]);case 2:return P(Y[0],Y[1]);default:return P()}}}},configSchema:{trackInlineScripts:{validate:function(d){return d===!0||d===!1},defaultValue:function(){return!0},message:"should be true|false"}}}};function Wn(o,u,d){var l=o[u];if(!l)return l;var _=d(l);return o[u]=_,l}function Ki(o){var u=!!o[1]&&typeof o[1].handleEvent=="function";return{get:function(){return u?o[1].handleEvent:o[1]},replace:function(d){u?o[1].handleEvent=d:o[1]=d}}}var Cc=function(o){return o===void 0&&(o=window),{load:function(u){"addEventListener"in o&&u._isBreadcrumbTypeEnabled("user")&&o.addEventListener("click",function(d){var l,_;try{l=xc(d.target),_=Wi(d.target,o)}catch{l="[hidden]",_="[hidden]",u._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/yy3rn63z")}u.leaveBreadcrumb("UI click",{targetText:l,targetSelector:_},"user")},!0)}}},Oc=/^\s*([^\s][\s\S]{0,139}[^\s])?\s*/;function xc(o){var u=o.textContent||o.innerText||"";return!u&&(o.type==="submit"||o.type==="button")&&(u=o.value),u=u.replace(Oc,"$1"),u.length>140?u.slice(0,135)+"(...)":u}function Wi(o,u){var d=[o.tagName];if(o.id&&d.push("#"+o.id),o.className&&o.className.length&&d.push("."+o.className.split(" ").join(".")),!u.document.querySelectorAll||!Array.prototype.indexOf)return d.join("");try{if(u.document.querySelectorAll(d.join("")).length===1)return d.join("")}catch{return d.join("")}if(o.parentNode.childNodes.length>1){var l=Array.prototype.indexOf.call(o.parentNode.childNodes,o)+1;d.push(":nth-child("+l+")")}return u.document.querySelectorAll(d.join("")).length===1?d.join(""):o.parentNode?Wi(o.parentNode,u)+" > "+d.join(""):d.join("")}var Yi={};Yi=function(o){o===void 0&&(o=window);var u={load:function(d){if("addEventListener"in o&&d._isBreadcrumbTypeEnabled("navigation")){var l=function(_){return function(){return d.leaveBreadcrumb(_,{},"navigation")}};o.addEventListener("pagehide",l("Page hidden"),!0),o.addEventListener("pageshow",l("Page shown"),!0),o.addEventListener("load",l("Page loaded"),!0),o.document.addEventListener("DOMContentLoaded",l("DOMContentLoaded"),!0),o.addEventListener("load",function(){return o.addEventListener("popstate",l("Navigated back"),!0)}),o.addEventListener("hashchange",function(_){var g=_.oldURL?{from:Xt(_.oldURL,o),to:Xt(_.newURL,o),state:Qi(o)}:{to:Xt(o.location.href,o)};d.leaveBreadcrumb("Hash changed",g,"navigation")},!0),o.history.replaceState&&Ji(d,o.history,"replaceState",o),o.history.pushState&&Ji(d,o.history,"pushState",o)}}};return u};var Xt=function(o,u){var d=u.document.createElement("A");return d.href=o,""+d.pathname+d.search+d.hash},Rc=function(o,u,d,l){var _=Xt(o.location.href,o);return{title:d,state:u,prevState:Qi(o),to:l||_,from:_}},Ji=function(o,u,d,l){var _=u[d];u[d]=function(g,y,E){o.leaveBreadcrumb("History "+d,Rc(l,g,y,E),"navigation"),typeof o.resetEventCount=="function"&&o.resetEventCount(),o._config.autoTrackSessions&&o.startSession(),_.apply(u,[g,y].concat(E!==void 0?E:[]))}},Qi=function(o){try{return o.history.state}catch{}},Xe="request",Lc=function(o,u){o===void 0&&(o=[]),u===void 0&&(u=window);var d={load:function(l){if(!l._isBreadcrumbTypeEnabled("request"))return;var _=[l._config.endpoints.notify,l._config.endpoints.sessions].concat(o);g(),b();function g(){if("addEventListener"in u.XMLHttpRequest.prototype){var M=u.XMLHttpRequest.prototype.open;u.XMLHttpRequest.prototype.open=function(N,F){var X=this,P=!1,D=function(){return E(N,F)},Q=function(){return y(N,F,X.status)};P&&(this.removeEventListener("load",Q),this.removeEventListener("error",D)),this.addEventListener("load",Q),this.addEventListener("error",D),P=!0,M.apply(this,arguments)}}}function y(M,T,N){if(T===void 0){l._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}if(!(typeof T=="string"&&s(_,T.replace(/\?.*$/,"")))){var F={status:N,request:M+" "+T};N>=400?l.leaveBreadcrumb("XMLHttpRequest failed",F,Xe):l.leaveBreadcrumb("XMLHttpRequest succeeded",F,Xe)}}function E(M,T){if(T===void 0){l._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}typeof T=="string"&&s(_,T.replace(/\?.*$/,""))||l.leaveBreadcrumb("XMLHttpRequest error",{request:M+" "+T},Xe)}function b(){if(!(!("fetch"in u)||u.fetch.polyfill)){var M=u.fetch;u.fetch=function(){var N=arguments,F=arguments[0],X=arguments[1],P,D=null;return F&&typeof F=="object"?(D=F.url,X&&"method"in X?P=X.method:F&&"method"in F&&(P=F.method)):(D=F,X&&"method"in X&&(P=X.method)),P===void 0&&(P="GET"),new Promise(function(Q,Y){M.apply(void 0,N).then(function(ie){x(ie,P,D),Q(ie)}).catch(function(ie){O(P,D),Y(ie)})})}}}var x=function(M,T,N){var F={status:M.status,request:T+" "+N};M.status>=400?l.leaveBreadcrumb("fetch() failed",F,Xe):l.leaveBreadcrumb("fetch() succeeded",F,Xe)},O=function(M,T){l.leaveBreadcrumb("fetch() error",{request:M+" "+T},Xe)}}};return d},Mc={load:function(o){var u=0;o.addOnError(function(d){if(u>=o._config.maxEvents)return o._logger.warn("Cancelling event send due to maxEvents per session limit of "+o._config.maxEvents+" being reached"),!1;u++}),o.resetEventCount=function(){u=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer ≤100",validate:function(o){return m(1,100)(o)}}}},Yn={};Yn={load:function(o){o.addOnError(function(u){var d=r(u.errors,function(l,_){return l.concat(_.stacktrace)},[]);R(d,function(l){l.file=Pc(l.file)})})}};var Pc=Yn._strip=function(o){return typeof o=="string"?o.replace(/\?.*$/,"").replace(/#.*$/,""):o},Ic=function(o,u){return o===void 0&&(o=window),u===void 0&&(u="window onerror"),{load:function(d){if(!d._config.autoDetectErrors||!d._config.enabledErrorTypes.unhandledExceptions)return;function l(g,y,E,b,x){if(E===0&&/Script error\.?/.test(g))d._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/yy3rn63z");else{var O={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},M;if(x)M=d.Event.create(x,!0,O,u,1),Zi(M.errors[0].stacktrace,y,E,b);else if(typeof g=="object"&&g!==null&&(!y||typeof y!="string")&&!E&&!b&&!x){var T=g.type?"Event: "+g.type:"Error",N=g.message||g.detail||"";M=d.Event.create({name:T,message:N},!0,O,u,1),M.originalError=g,M.addMetadata(u,{event:g,extraParameters:y})}else M=d.Event.create(g,!0,O,u,1),Zi(M.errors[0].stacktrace,y,E,b);d._notify(M)}typeof _=="function"&&_.apply(this,arguments)}var _=o.onerror;o.onerror=l}}},Zi=function(o,u,d,l){o[0]||o.push({});var _=o[0];!_.file&&typeof u=="string"&&(_.file=u),!_.lineNumber&&Jn(d)&&(_.lineNumber=d),_.columnNumber||(Jn(l)?_.columnNumber=l:window.event&&Jn(window.event.errorCharacter)&&(_.columnNumber=window.event.errorCharacter))},Jn=function(o){return typeof o=="number"&&String.call(o)!=="NaN"},Nc=function(o){o===void 0&&(o=window);var u={load:function(d){if(!(!d._config.autoDetectErrors||!d._config.enabledErrorTypes.unhandledRejections)){var l=function(_){var g=_.reason,y=!1;try{_.detail&&_.detail.reason&&(g=_.detail.reason,y=!0)}catch{}var E=d.Event.create(g,!1,{severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}},"unhandledrejection handler",1,d._logger);y&&R(E.errors[0].stacktrace,kc(g)),d._notify(E,function(b){if(jt(b.originalError)&&!b.originalError.stack){var x;b.addMetadata("unhandledRejection handler",(x={},x[Object.prototype.toString.call(b.originalError)]={name:b.originalError.name,message:b.originalError.message,code:b.originalError.code},x))}})};"addEventListener"in o?o.addEventListener("unhandledrejection",l):o.onunhandledrejection=function(_,g){l({detail:{reason:_,promise:g}})}}}};return u},kc=function(o){return function(u){u.file!==o.toString()&&u.method&&(u.method=u.method.replace(/^\s+/,""))}},Ae={},Uc="Bugsnag JavaScript",Dc="7.25.0",Bc="https://github.com/bugsnag/bugsnag-js",$c=A({},w.schema,V),te={_client:null,createClient:function(o){typeof o=="string"&&(o={apiKey:o}),o||(o={});var u=[dc,vc(),hc(),Sc(),Mc,bc,wc,Yn,Ic(),Nc(),Yi(),Cc(),Lc(),zi,Ac()],d=new zn(o,$c,u,{name:Uc,version:Dc,url:Bc});return d._setDelivery(window.XDomainRequest?qn:uc),d._logger.debug("Loaded!"),d.leaveBreadcrumb("Bugsnag loaded",{},"state"),d._config.autoTrackSessions?d.startSession():d},start:function(o){return te._client?(te._client._logger.warn("Bugsnag.start() was called more than once. Ignoring."),te._client):(te._client=te.createClient(o),te._client)},isStarted:function(){return te._client!=null}};return R(["resetEventCount"].concat(p(zn.prototype)),function(o){/^_/.test(o)||(te[o]=function(){if(!te._client)return console.log("Bugsnag."+o+"() was called before Bugsnag.start()");te._client._depth+=1;var u=te._client[o].apply(te._client,arguments);return te._client._depth-=1,u})}),Ae=te,Ae.Client=zn,Ae.Event=Fn,Ae.Session=Gn,Ae.Breadcrumb=U,Ae.default=te,Ae})}(er)),er.exports}var tr,is;function su(){return is||(is=1,tr=iu()),tr}var ou=su();const ot=Gc(ou),au=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ss={randomUUID:au};function at(t,e,n){var i;if(ss.randomUUID&&!t)return ss.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??jc();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,zc(r)}let po=-1;const lt=t=>{addEventListener("pageshow",e=>{e.persisted&&(po=e.timeStamp,t(e))},!0)},de=(t,e,n,r)=>{let i,s;return a=>{e.value>=0&&(a||r)&&(s=e.value-(i??0),(s||i===void 0)&&(i=e.value,e.delta=s,e.rating=((c,h)=>c>h[1]?"poor":c>h[0]?"needs-improvement":"good")(e.value,n),t(e)))}},qr=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},Xr=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},kt=()=>{const t=Xr();return(t==null?void 0:t.activationStart)??0},he=(t,e=-1)=>{const n=Xr();let r="navigate";return po>=0?r="back-forward-cache":n&&(document.prerendering||kt()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},nr=new WeakMap;function Kr(t,e){return nr.get(t)||nr.set(t,new e),nr.get(t)}let cu=class{constructor(){f(this,"t");f(this,"i",0);f(this,"o",[])}h(e){var i;if(e.hadRecentInput)return;const n=this.o[0],r=this.o.at(-1);this.i&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),(i=this.t)==null||i.call(this,e)}};const Ut=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(i=>{Promise.resolve().then(()=>{e(i.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},Wr=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let Ye=-1;const _o=new Set,os=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,Sr=t=>{if(document.visibilityState==="hidden"){if(t.type==="visibilitychange")for(const e of _o)e();isFinite(Ye)||(Ye=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("prerenderingchange",Sr,!0))}},xn=()=>{var t;if(Ye<0){const e=kt();Ye=(document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>e)[0])==null?void 0:t.startTime)??os(),addEventListener("visibilitychange",Sr,!0),addEventListener("prerenderingchange",Sr,!0),lt(()=>{setTimeout(()=>{Ye=os()})})}return{get firstHiddenTime(){return Ye},onHidden(e){_o.add(e)}}},Rn=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},as=[1800,3e3],go=(t,e={})=>{Rn(()=>{const n=xn();let r,i=he("FCP");const s=Ut("paint",a=>{for(const c of a)c.name==="first-contentful-paint"&&(s.disconnect(),c.startTime<n.firstHiddenTime&&(i.value=Math.max(c.startTime-kt(),0),i.entries.push(c),r(!0)))});s&&(r=de(t,i,as,e.reportAllChanges),lt(a=>{i=he("FCP"),r=de(t,i,as,e.reportAllChanges),qr(()=>{i.value=performance.now()-a.timeStamp,r(!0)})}))})},cs=[.1,.25],uu=(t,e={})=>{const n=xn();go(Wr(()=>{let r,i=he("CLS",0);const s=Kr(e,cu),a=h=>{for(const p of h)s.h(p);s.i>i.value&&(i.value=s.i,i.entries=s.o,r())},c=Ut("layout-shift",a);c&&(r=de(t,i,cs,e.reportAllChanges),n.onHidden(()=>{a(c.takeRecords()),r(!0)}),lt(()=>{s.i=0,i=he("CLS",0),r=de(t,i,cs,e.reportAllChanges),qr(()=>r())}),setTimeout(r))}))};let mo=0,rr=1/0,Yt=0;const lu=t=>{for(const e of t)e.interactionId&&(rr=Math.min(rr,e.interactionId),Yt=Math.max(Yt,e.interactionId),mo=Yt?(Yt-rr)/7+1:0)};let br;const us=()=>br?mo:performance.interactionCount??0,du=()=>{"interactionCount"in performance||br||(br=Ut("event",lu,{type:"event",buffered:!0,durationThreshold:0}))};let ls=0;class hu{constructor(){f(this,"u",[]);f(this,"l",new Map);f(this,"m");f(this,"p")}v(){ls=us(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((us()-ls)/50));return this.u[e]}h(e){var i,s;if((i=this.m)==null||i.call(this,e),!e.interactionId&&e.entryType!=="first-input")return;const n=this.u.at(-1);let r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>n.P){if(r?e.duration>r.P?(r.entries=[e],r.P=e.duration):e.duration===r.P&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],P:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort((a,c)=>c.P-a.P),this.u.length>10){const a=this.u.splice(10);for(const c of a)this.l.delete(c.id)}(s=this.p)==null||s.call(this,r)}}}const yo=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=Wr(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e(()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})}))},ds=[200,500],fu=(t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=xn();Rn(()=>{du();let r,i=he("INP");const s=Kr(e,hu),a=h=>{yo(()=>{for(const m of h)s.h(m);const p=s.L();p&&p.P!==i.value&&(i.value=p.P,i.entries=p.entries,r())})},c=Ut("event",a,{durationThreshold:e.durationThreshold??40});r=de(t,i,ds,e.reportAllChanges),c&&(c.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{a(c.takeRecords()),r(!0)}),lt(()=>{s.v(),i=he("INP"),r=de(t,i,ds,e.reportAllChanges)}))})};let pu=class{constructor(){f(this,"m")}h(e){var n;(n=this.m)==null||n.call(this,e)}};const hs=[2500,4e3],_u=(t,e={})=>{Rn(()=>{const n=xn();let r,i=he("LCP");const s=Kr(e,pu),a=h=>{e.reportAllChanges||(h=h.slice(-1));for(const p of h)s.h(p),p.startTime<n.firstHiddenTime&&(i.value=Math.max(p.startTime-kt(),0),i.entries=[p],r())},c=Ut("largest-contentful-paint",a);if(c){r=de(t,i,hs,e.reportAllChanges);const h=Wr(()=>{a(c.takeRecords()),c.disconnect(),r(!0)}),p=m=>{m.isTrusted&&(yo(h),removeEventListener(m.type,p,{capture:!0}))};for(const m of["keydown","click","visibilitychange"])addEventListener(m,p,{capture:!0});lt(m=>{i=he("LCP"),r=de(t,i,hs,e.reportAllChanges),qr(()=>{i.value=performance.now()-m.timeStamp,r(!0)})})}})},fs=[800,1800],Er=t=>{document.prerendering?Rn(()=>Er(t)):document.readyState!=="complete"?addEventListener("load",()=>Er(t),!0):setTimeout(t)},gu=(t,e={})=>{let n=he("TTFB"),r=de(t,n,fs,e.reportAllChanges);Er(()=>{const i=Xr();i&&(n.value=Math.max(i.responseStart-kt(),0),n.entries=[i],r(!0),lt(()=>{n=he("TTFB",0),r=de(t,n,fs,e.reportAllChanges),r(!0)}))})},ps=t=>{let e;const n=new Set,r=(p,m)=>{const v=typeof p=="function"?p(e):p;if(!Object.is(v,e)){const S=e;e=m??(typeof v!="object"||v===null)?v:Object.assign({},e,v),n.forEach(w=>w(e,S))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>h,subscribe:p=>(n.add(p),()=>n.delete(p))},h=e=t(r,i,c);return c},mu=t=>t?ps(t):ps,yu=t=>t;function vu(t,e=yu){const n=Et.useSyncExternalStore(t.subscribe,Et.useCallback(()=>e(t.getState()),[t,e]),Et.useCallback(()=>e(t.getInitialState()),[t,e]));return Et.useDebugValue(n),n}const _s=t=>{const e=mu(t),n=r=>vu(e,r);return Object.assign(n,e),n},vo=t=>t?_s(t):_s,gs=t=>Symbol.iterator in t,ms=t=>"entries"in t,ys=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),r=e instanceof Map?e:new Map(e.entries());if(n.size!==r.size)return!1;for(const[i,s]of n)if(!r.has(i)||!Object.is(s,r.get(i)))return!1;return!0},Su=(t,e)=>{const n=t[Symbol.iterator](),r=e[Symbol.iterator]();let i=n.next(),s=r.next();for(;!i.done&&!s.done;){if(!Object.is(i.value,s.value))return!1;i=n.next(),s=r.next()}return!!i.done&&!!s.done};function bu(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null||Object.getPrototypeOf(t)!==Object.getPrototypeOf(e)?!1:gs(t)&&gs(e)?ms(t)&&ms(e)?ys(t,e):Su(t,e):ys({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)})}function Eu(t){const e=Et.useRef(void 0);return n=>{const r=t(n);return bu(e.current,r)?e.current:e.current=r}}function wr(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wu(t){if(Array.isArray(t))return t}function Tu(t){if(Array.isArray(t))return wr(t)}function vs(t,e,n,r,i,s,a){try{var c=t[s](a),h=c.value}catch(p){n(p);return}c.done?e(h):Promise.resolve(h).then(r,i)}function ke(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function a(h){vs(s,r,i,a,c,"next",h)}function c(h){vs(s,r,i,a,c,"throw",h)}a(void 0)})}}function Yr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Au(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jr(t,e,n){return e&&Au(t.prototype,e),t}function Cu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ss(t,e){return e!=null&&typeof Symbol<"u"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function Ou(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xu(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],i=!0,s=!1,a,c;try{for(n=n.call(t);!(i=(a=n.next()).done)&&(r.push(a.value),!(e&&r.length===e));i=!0);}catch(h){s=!0,c=h}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw c}}return r}}function Ru(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lu(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){Cu(t,i,n[i])})}return t}function Mu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}function le(t,e){return e=e??{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Mu(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}function Ue(t,e){return wu(t)||xu(t,e)||So(t,e)||Ru()}function Ct(t){return Tu(t)||Ou(t)||So(t)||Lu()}function W(t){"@swc/helpers - typeof";return t&&typeof Symbol<"u"&&t.constructor===Symbol?"symbol":typeof t}function So(t,e){if(t){if(typeof t=="string")return wr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wr(t,e)}}function De(t,e){var n,r,i,s={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(p){return function(m){return h([p,m])}}function h(p){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,p[0]&&(s=0)),s;)try{if(n=1,r&&(i=p[0]&2?r.return:p[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,p[1])).done)return i;switch(r=0,i&&(p=[p[0]&2,i.value]),p[0]){case 0:case 1:i=p;break;case 4:return s.label++,{value:p[1],done:!1};case 5:s.label++,r=p[1],p=[0];continue;case 7:p=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(p[0]===6||p[0]===2)){s=0;continue}if(p[0]===3&&(!i||p[1]>i[0]&&p[1]<i[3])){s.label=p[1];break}if(p[0]===6&&s.label<i[1]){s.label=i[1],i=p;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(p);break}i[2]&&s.ops.pop(),s.trys.pop();continue}p=e.call(t,s)}catch(m){p=[6,m],r=0}finally{n=i=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}var Pu=function(t){return t.MedusaJSEssentialLegacy="_MedusaJS_essential_",t.MerchantEssentialProto="_merchant_essential",t.ShopAppEssentialProto="_shop_app_essential",t.MerchantAnalyticsProto="_merchant_analytics",t.ShopAppAnalyticsProto="_shop_app_analytics",t.MultiTrackToken="_MedusaJS_y",t.SessionToken="_MedusaJS_s",t.ExperimentAssignmentCookie="_assignment",t.GoogleAnalyticsId="_ga",t.CookieNoticeAcknolwedged="eu_cookies_acknowledged",t.PrivacySignal="privacy_signal",t.LastShop="last_shop",t.IsMedusaJSMerchant="is_MedusaJS_merchant",t.Affiliate="source",t.MarketingEncryptedCookies="_MedusaJS_marketing",t.Cart="cart",t}(Pu||{}),Iu=function(t){return t.Gdpr="gdpr",t.Ccpa="ccpa",t.None="none",t}(Iu||{}),Nu=function(t){return t.Accepted="1",t.Rejected="-1",t}(Nu||{}),ku=function(t){return t.PassiveConsent="passive_consent",t.ActiveConsent="active_consent",t}(ku||{}),k=function(t){return t.Essential="essential",t.Analytics="analytics",t.Functional="functional",t.Marketing="marketing",t}(k||{}),Uu=function(t){return t.AcceptLanguage="accept-language",t.GlobalPrivacyControl="sec-gpc",t.BasicAuth="x-basic-auth",t.CacheControl="cache-control",t.ContentLanguage="content-language",t.ContentType="content-type",t.Cookie="cookie",t.CfConnectingIp="cf-connecting-ip",t.CfIpcountry="cf-ipcountry",t.EdgeThreatScore="edge-threat-score",t.HttpXForwardedFor="http_x_forwarded_for",t.Origin="origin",t.OxygenBuyerIp="oxygen-buyer-ip",t.OxygenBuyerCountry="oxygen-buyer-country",t.OxygenBuyerRegionCode="oxygen-buyer-region-code",t.Referrer="referer",t.UserAgent="user-agent",t.XBrochureDebugCountry="x-brochure-debug-country",t.XBrochureDomain="x-brochure-domain",t.XForwardedFor="x-forwarded-for",t.XForwardedHost="x-forwarded-host",t.XGeoCountryCode="x-geo-country-code",t.XGeoRegionCode="x-geo-region-code",t.XIpMetadata="x-ip-metadata",t.XRealIp="x-real-ip",t.AccessControlRequestHeaders="access-control-request-headers",t.XEdgeExp="x-edge-exp",t}(Uu||{}),Du=function(t){return t.Delete="DELETE",t.Get="GET",t.Head="HEAD",t.Options="OPTIONS",t.Patch="PATCH",t.Post="POST",t.Put="PUT",t}(Du||{}),Bu=function(t){return t.SetCookie="set-cookie",t.AccessControlAllowOrigin="access-control-allow-origin",t.AccessControlAllowCredentials="access-control-allow-credentials",t.AccessControlAllowMethods="access-control-allow-methods",t.AccessControlAllowHeaders="access-control-allow-headers",t.CacheStatus="cache-status",t.CfCacheStatus="cf-cache-status",t.XCacheStatus="x-cache",t.ContentType="content-type",t}(Bu||{}),$u=function(t){return t.Lax="lax",t.Strict="strict",t.None="none",t}($u||{}),Fu=function(t){return t.Hit="HIT",t.Miss="MISS",t.Stale="STALE",t.Disabled="DISABLED",t.Dynamic="DYNAMIC",t.Bypass="BYPASS",t.Expired="EXPIRED",t.Revalidated="REVALIDATED",t.None="NONE",t.Unknown="UNKNOWN",t}(Fu||{}),Hu=function(t){return t.ShowCookieNoticeBanner="cookie_notice_banner",t.DuxConsentChanged="dux_consent_changed",t.DuxConsentReady="dux_consent_ready",t.DuxOptOutSaleOfData="dux_opt_out_sale_of_data",t}(Hu||{}),Vu=function(t){return t.Click="website_click_event/1.5",t.ComponentViewability="website_component_viewability_event/1.5",t.Error="website_error_event/1.1",t.Form="website_form_event/2.0",t.PageView="website_client_page_view/2.14",t.ServerPageView="website_server_page_view/3.0",t.ServerRequest="website_server_request/2.2",t.Scroll="website_scroll_event/1.0",t.UserSession="website_user_session/2.5",t.UserSessionMarketing="website_user_session_marketing/1.1",t.VisibilityChange="website_visibility_change_event/1.0",t.WebVitals="website_web_vitals_event/2.1",t.PrivacySignal="website_privacy_signal/1.2",t}(Vu||{}),Gu=function(t){return t.Active="active",t.GranularCompact="granularCompact",t}(Gu||{}),ju=function(t){return t.GetGeoData="geo",t}(ju||{}),zu=function(t){return t.Merchant="merchant",t.ShopApp="shop_app",t}(zu||{}),qu=function(t){return t.Essential="essential",t.Analytics="analytics",t}(qu||{}),Xu="data-dux-initialized",Jt="dux_buffer",Ku="a, button, [data-click-enabled], input, select",Wu='[data-click-disabled], [data-click-enabled="false"]',Yu="[data-event-category], [data-ga-event], [data-ga-category]",bs={default:{au:"en-AU",be:"nl-BE","be-de":"de-BE","be-en":"en-BE","be-fr":"fr-BE",br:"pt-BR",ca:"en-CA","ca-fr":"fr-CA",cn:"zh-CN",co:"es-CO",cs:"cs",de:"de",default:"en",dk:"da","dk-en":"en-DK",en:"en",es:"es","es-es":"es-ES",fi:"fi",fr:"fr",hk:"zh-HK","hk-en":"en-HK",id:"en-ID",ie:"en-IE",in:"en-IN",it:"it",jp:"ja",ko:"ko",kr:"ko",mx:"es-MX",my:"en-MY",ng:"en-NG",nl:"nl","no-en":"en-NO",nz:"en-NZ",ph:"en-PH","pt-pt":"pt-PT","pt-br":"pt-BR",se:"sv",sg:"en-SG",th:"th",tr:"tr",tw:"zh-TW",uk:"en-GB",vi:"vi",vn:"vi",za:"en-ZA",zh:"zh-CN","zh-cn":"zh-CN","zh-tw":"zh-TW"},"www.MedusaJS.ca":"en-CA","www.MedusaJS.co.uk":"en-GB","www.MedusaJS.in":"en-IN","www.MedusaJS.com.au":"en-AU","www.MedusaJS.co.id":"en-ID","www.MedusaJS.com.br":"pt-BR","www.MedusaJS.co.nz":"en-NZ","www.MedusaJS.co.za":"en-ZA","www.MedusaJS.com.ng":"en","www.MedusaJS.com.ph":"en-PH","www.MedusaJS.com.sg":"en-SG","www.MedusaJS.hk":"zh-HK","en.MedusaJS.hk":"en-HK","www.MedusaJS.ie":"en-IE","en.MedusaJS.be":"en-BE","www.MedusaJS.my":"en-MY","en.MedusaJS.dk":"en-DK","en.MedusaJS.no":"en-NO","es.MedusaJS.com":"es","www.MedusaJS.es":"es-ES","www.MedusaJS.com.co":"es-CO","www.MedusaJS.com.mx":"es-MX","www.MedusaJS.fr":"fr","fr.MedusaJS.ca":"fr-CA","fr.MedusaJS.be":"fr-BE","www.MedusaJS.nl":"nl","www.MedusaJS.be":"nl-BE","www.MedusaJS.jp":"ja","www.MedusaJS.tw":"zh-TW","www.MedusaJS.de":"de","de.MedusaJS.be":"de-BE","it.MedusaJS.com":"it","www.MedusaJS.dk":"da","www.MedusaJS.co.kr":"ko","www.MedusaJS.se":"sv","zh.MedusaJS.com":"zh-CN","www.MedusaJS.net.vn":"vi"},bo="home",Ju=.2,Qu=0,Eo="/__dux",Zu=function(t){var e=t.hostname,n=bs[e]||bs.default;if(typeof n=="string")return n;var r=Ue(t.pathname.toLowerCase().split("/"),2),i=r[1],s=i===void 0?"":i;return n[s]||n.default||"en"},el=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IS","IE","IT","LV","LI","LT","LU","MT","NL","NO","PL","PT","RO","SI","SK","ES","SE","CH","GB"],wo="1.0.3",tl=function(t){return t.toLowerCase().replace(/^data-|^-/,"").replace(/-./g,function(e){return(e[1]||"").toUpperCase()}).replace(/-/g,"")},hn=function(t){var e=t;try{e=decodeURIComponent(t)}catch{}return e=e.replace(/[A-Z]{2,}/g,function(n){return"".concat(n.charAt(0)).concat(n.substring(1).toLowerCase())}),e=e.charAt(0).toLowerCase()+e.substring(1),e=e.replace(/[\s_:./,\\\n|]/g,"-"),e=e.replace(/[A-Z]/g,function(n){return"-".concat(n.toLowerCase())}),e=e.replace(/-{2,}/g,"-"),e=e.replace(/[^a-z0-9-]/g,"?"),e=e.replace(/(^-)|(-$)/g,""),e=e.substring(0,50),e},nl=function(t){for(var e=t;e&&e.nodeName.toLowerCase()!=="body";){if(getComputedStyle(e).getPropertyValue("position").match(/fixed|sticky/i))return!0;e=e.parentNode}return!1},rl=function(t){var e=t.dataset.sectionName||t.dataset.componentName||t.getAttribute("name")||t.getAttribute("id")||t.getAttribute("aria-label")||t.innerText||t.textContent||"unhandled-".concat(t.tagName);return hn(e)},il=function(t){try{return new URL(t,document.baseURI).origin.match(/MedusaJS.|myMedusaJS.io|spin.dev/)}catch(e){return console.error("isMedusaJSLink",e),!1}},sl=function(t){var e=t.tagName.toLowerCase();switch(e){case"button":return"button_click";case"a":return il(t.getAttribute("href")||"")?"link_click":"outbound_link_click";case"select":return"dropdown_click";case"option":return"dropdown_select";case"input":return t.type==="button"?"button_click":"input_select";case"img":return"image_click";default:return"".concat(e,"_click")}},Es=function(t,e){var n={};for(var r in t)if(r.startsWith(e)){var i=r.substring(e.length);if(i){var s=i.charAt(0).toLowerCase()+i.substring(1)||"";s&&(n[s]=t[r]||"")}}return n},ol="data-component-extra-",al=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ol,n={},r;if(document&&typeof document.evaluate!="function")return n;for(var i=document.evaluate("ancestor::*[@*[starts-with(name(), ".concat(e,")]]"),t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),s=tl(e);r=i.iterateNext();)Object.assign(n,Es(r.dataset,s));return Object.assign(n,Es(t.dataset,s)),n},cl=function(t,e){var n,r=[];if(document&&typeof document.evaluate!="function")return r;for(var i=document.evaluate("ancestor::*[@".concat(e,"[1]]"),t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);n=i.iterateNext();){var s=n.getAttribute(e);s&&r.push({node:n,attr:e,attrVal:s})}return r},To=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["data-section-name","data-component-name","id"],n,r,i=!0,s=!1,a=void 0;try{for(var c=e[Symbol.iterator](),h;!(i=(h=c.next()).done)&&(r=h.value,n=cl(t,r),!(n.length>0));i=!0);}catch(p){s=!0,a=p}finally{try{!i&&c.return!=null&&c.return()}finally{if(s)throw a}}return n},ul=function(t,e){var n=(To(t,e)||[]).pop(),r=n||{},i=r.attrVal,s=i===void 0?"":i,a=ll(n);return{name:hn(s||"unhandled-parent-section"),index:a}},ll=function(t){if(!t)return 0;var e=t.attr,n=t.attrVal,r=t.node;try{var i=document.querySelectorAll("[".concat(e,'="').concat(CSS.escape(n),'"]'));return i.length<=1?0:Array.from(i).findIndex(function(s){return s.isEqualNode(r)})}catch{return 0}},fn=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;if(!t)return{};var r=rl(t),i=sl(t),s=ul(t),a=s.name,c=s.index,h=To(t,n)||[],p=[],m=al(t);h.forEach(function(S){var w=S.attrVal;p.push(hn(w))}),p.push(r);var v=p.join("|").concat(e?":".concat(hn(t.tagName)):"");return{elementName:r,elementType:i,sectionName:a,sectionIndex:c,componentTree:v,extraMetadata:m}},ws=0,We={};function re(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Ue(e,4),i=r[0],s=r[1],a=r[2],c=a===void 0?window:a,h=r[3];ws+=1;var p=ws.toString();return c.addEventListener(i,s,h),We[p]={listenerId:p,eventType:i,context:c,callback:s,options:h},p}function Le(t,e){if((typeof t>"u"?"undefined":W(t))=="object")t.forEach(function(h){return Le(h)});else{var n=t.toString();if(We[n]){var r=We[n],i=r.context,s=r.eventType,a=r.callback,c=r.options;i.removeEventListener(s,a,c),delete We[n]}else Object.keys(We).filter(function(h){var p=We[h];return p.eventType===n&&!0}).forEach(function(h){return Le(h)})}}function Qr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Ue(e,4),i=r[0],s=r[1],a=r[2],c=a===void 0?window:a,h=r[3],p=re(i,function(){for(var m=arguments.length,v=new Array(m),S=0;S<m;S++)v[S]=arguments[S];s.apply(c,v),Le(p)},c,h);return p}function Ao(t){var e=[],n=function(r,i){return function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];e.forEach(function(h){return Le(h)}),r.apply(i,a)}};return t.forEach(function(r){var i=Ue(r,4),s=i[0],a=i[1],c=i[2],h=c===void 0?window:c,p=i[3];e.push(re(s,n(a,h),h,p))}),e}var dl=function(t){return t.replace(/[A-Z]/g,function(e){return"_".concat(e.toLocaleLowerCase())})},Dt=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=t[r];if(e.indexOf(r)>=0)n[r]=i;else{var s=dl(r);n[s]=i}}return n},Ts=0,on={},Me={},Zr=function(t,e){var n=[];return Object.keys(Me).forEach(function(r){var i=Me[r]||{},s=i.dom,a=i.threshold;s&&s===t&&a===e&&n.push(Me[r])}),n},Co=function(){var t;return(typeof window>"u"?"undefined":W(window))<"u"&&window.IntersectionObserver&&"intersectionRatio"in((t=window.IntersectionObserverEntry)===null||t===void 0?void 0:t.prototype)},hl=function(t){if(t){t.timer&&clearTimeout(t.timer);var e=t.dom,n=t.id,r=t.observer,i=t.threshold;delete Me[n],Zr(e,i).length||r.unobserve(e),Object.values(Me).every(function(s){return s.observer!==r})&&delete on[i]}},fl=function(t){var e=t.threshold;return on[e]||(on[e]=new IntersectionObserver(gl(e),{root:null,threshold:e})),on[e]},pl=function(t){var e=t.dom,n=t.getCurrentState,r=t.options,i=t.clientMessageId,s=i===void 0?at():i;if(!(!e||!Co())){Ts+=1;var a=Ts.toString(),c=(r==null?void 0:r.threshold)||Ju,h=(r==null?void 0:r.duration)||Qu,p=fl({threshold:c}),m={id:a,dom:e,observer:p,threshold:c,duration:h,clientMessageId:s,extraMetadata:(r==null?void 0:r.extraMetadata)||{},getCurrentState:n};return Zr(e,c).length||p.observe(e),Me[a]=m,m}},_l=function(t){var e=t.observation,n=t.store,r=t.trackers,i=e.dom,s=e.threshold,a=e.duration,c=fn(i,!1),h=c.componentTree,p=c.extraMetadata,m=c.elementName,v=c.sectionName,S=c.sectionIndex,w=j({},p,e.extraMetadata),L={schemaId:"website_component_viewability_event/1.5",payload:{pageViewToken:n.pageViewToken||"",componentTree:h,targetName:m,parentName:v,parentIndex:S,componentWidth:i.clientWidth,componentHeight:i.clientHeight,verticalPosition:Math.round(window.scrollY+i.getBoundingClientRect().top),horizontalPosition:Math.round(window.scrollX+i.getBoundingClientRect().left),duration:a,threshold:s,extraMetadata:JSON.stringify(w)}};r.dux&&r.dux(L,{clientMessageId:e.clientMessageId}),r.gtm&&r.gtm({event:"component_viewability",eventType:m,eventLocation:h,extraMetadata:JSON.stringify(Dt(w))})},gl=function(t){return function(e){e.forEach(function(n){var r=n==null?void 0:n.target;Zr(r,t).forEach(function(i){return ke(function(){var s,a,c,h,p,m;return De(this,function(v){return s=i.getCurrentState(),a=s.store,c=s.trackers,h=s.sidecarCallback,p={dom:r,clientMessageId:i.clientMessageId,parentSchemaId:"website_component_viewability_event/1.5",store:a,track:c,isIntersecting:n.isIntersecting},m=function(){_l({observation:i,store:a,trackers:c}),h==null||h(p),hl(i)},n.isIntersecting?i.duration>0?i.timer=setTimeout(function(){m()},i.duration):m():i.timer&&clearTimeout(i.timer),[2]})})()})})}},ml=function(t,e){Co()&&(document.querySelectorAll("[data-viewable-component]").forEach(function(n){return pl({dom:n,getCurrentState:function(){return{store:e,trackers:t}}})}),Object.values(Me).forEach(function(n){var r=n.observer,i=n.dom;r.observe(i)}))},yl=function(t){var e=Ss(t==null?void 0:t.currentTarget,HTMLFormElement)?t==null?void 0:t.currentTarget:t==null?void 0:t.target,n=(t==null?void 0:t.submitter)||(t==null?void 0:t.target),r=e.action,i=t.defaultPrevented,s="",a;i&&(a=Array.from(e.elements).find(function(w){return Ss(w,HTMLInputElement)&&w.validationMessage}),a&&(s="".concat(a.name||a.id,": ").concat(a==null?void 0:a.validationMessage)));var c=fn(e,!1),h=c.componentTree,p=h===void 0?"":h,m=fn(n,!0),v=m.componentTree,S=v===void 0?"":v;return{formEl:e,submitterEl:n,errorEl:a,hasError:i,action:r,message:s,componentTree:p,submitterComponentTree:S}},vl=function(t,e){var n;re("submit",function(r){if(r){var i=yl(r),s=i.hasError,a=i.message,c=i.action,h=i.componentTree,p=i.submitterComponentTree,m={schemaId:"website_form_event/2.0",payload:{pageViewToken:e.pageViewToken||"",action:c,state:s?"error":"success",componentTree:h,submitterComponentTree:p,message:a}};t.dux(m)}},(n=document)===null||n===void 0?void 0:n.body,!0)};function Oo(t,e){var n,r;return function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n&&clearTimeout(n),r&&cancelAnimationFrame(r),new Promise(function(c){e||(typeof requestAnimationFrame>"u"?"undefined":W(requestAnimationFrame))>"u"?n=setTimeout(function(){var h=t.apply(void 0,Ct(s));c(h)},e):r=requestAnimationFrame(function(){var h=t.apply(void 0,Ct(s));c(h)})})}}var Sl=function(t){var e=t.getBoundingClientRect(),n=!nl(t);return{left:Math.round(e.left+(n?window.scrollX-t.clientLeft:0)),top:Math.round(e.top+(n?window.scrollY-t.clientTop:0))}},bl=function(t){var e=t.element,n=t.clientMessageId,r=n===void 0?at():n,i=t.eventType,s=t.track,a=t.store,c=t.options,h=c===void 0?{extraMetadata:{}}:c,p=e.closest(Ku);if(!(!p||p.matches(Wu))){var m=Sl(p),v=m.left,S=m.top,w=fn(p),L=w.elementName,A=w.elementType,R=w.sectionName,I=w.sectionIndex,B=w.componentTree,V=w.extraMetadata,H=j({},V,h==null?void 0:h.extraMetadata),$=p.getAttribute("href")||"",U=p.innerText||p.textContent||p.getAttribute("aria-label")||"";U=Ct(U).slice(0,50).join("");var q={schemaId:"website_click_event/1.5",payload:{pageViewToken:a.pageViewToken||"",componentTree:B,xCoord:v,yCoord:S,recirculation:$,targetName:L,parentName:R,parentIndex:I,clickType:A,eventType:i,innerText:U,extraMetadata:JSON.stringify(H)}};if(s.dux(q,{clientMessageId:r}),s.gtm){var oe=e.closest(Yu),J;oe?J=oe.dataset:J={eventCategory:I?"".concat(R,"-").concat(I):R,eventAction:A,eventLabel:L},Object.assign(J,{event:A,eventName:A,eventType:L,eventText:U,eventLocation:I?"".concat(R,"-").concat(I):R,eventUrl:$,extraMetadata:JSON.stringify(Dt(H))}),s.gtm(J)}}},wt,El=function(t){wt&&(t==null||t.forEach(function(e){re("click",wt,e,!0),re("contextmenu",wt,e,!0),re("auxclick",wt,e,!0)}))},wl=function(t,e,n){wt=function(r){bl({element:r.target,eventType:r.type,track:t,store:e})},El(n)},As=function(t){return t!==void 0?parseInt(t,10):void 0},Tl=function(t){var e;if(typeof t!="string")return{};var n=t==null?void 0:t.replace(/[^\w\s\n():/.$-]/g,""),r=(n==null?void 0:n.match(/(https?:\/\/[^\s:\n]+|\/[^\s:\n]+)/))||[],i=n==null||(e=n.match(/:\d+:\d+/))===null||e===void 0?void 0:e[0].split(":");return{filename:r[1],lineNumber:As(i==null?void 0:i[1]),columnNumber:As(i==null?void 0:i[2])}},Al=function(t,e){Qr("error",function(n){var r,i,s,a,c=(n==null||(r=n.error)===null||r===void 0?void 0:r.stack)||(n==null||(i=n.error)===null||i===void 0?void 0:i.message)||(n==null?void 0:n.message),h=Tl(c)||{},p=h.filename,m=h.lineNumber,v=h.columnNumber,S={url:location.href};v&&(S.columnNumber=n.colno||v);var w={schemaId:"website_error_event/1.1",payload:{pageViewToken:e.pageViewToken||"",message:((s=n.error)===null||s===void 0?void 0:s.message)||n.message||"Unknown error",fileName:n.filename||p,stack:(a=n.error)===null||a===void 0?void 0:a.stack,lineNumber:n.lineno||m,extraMetadata:JSON.stringify(S)}};t.dux(w)},window)},Cl="default-application",xo=function(t){var e;return(((e=document.querySelector('link[rel="canonical"]'))===null||e===void 0?void 0:e.getAttribute("href"))||t).split("?")[0].split("#")[0]},Cs=function(t){if(t)try{var e=new URL(t),n=e.pathname;return(n.split("/").filter(Boolean).join("/")||bo).toLowerCase()}catch(r){console.error("malformed href",r)}return""},Ol=function(t,e){var n,r=Cs((n=document.querySelector('link[rel="alternate"][hreflang="en"]'))===null||n===void 0?void 0:n.getAttribute("href"));return r||(r=Cs(xo(t))),e&&r===e.toLowerCase()&&(r=bo),r},ei,Os=function(t){var e=t.track,n=t.store,r=t.softNavigation,i=r===void 0?!1:r,s,a,c,h,p,m,v,S=location.toString();ei=S;var w=new URL(S),L=w.hostname,A=w.pathname,R=((s=n.metadata)===null||s===void 0?void 0:s.handle)||Ol(w.href,n==null||(c=n.metadata)===null||c===void 0||(a=c.site)===null||a===void 0?void 0:a.pathPrefix),I=document.referrer||"",B=((p=n.metadata)===null||p===void 0||(h=p.page)===null||h===void 0?void 0:h.experimentVariationId)||n.experimentVariationId,V=n.pageViewToken||"",H=n.mode||"development",$;try{$=n.extraMetadata?JSON.stringify(Dt(n.extraMetadata)):void 0}catch{}var U={schemaId:"website_client_page_view/2.14",payload:j({pageViewToken:V,userLocale:navigator&&navigator.language||"",url:S,domain:L,path:A,urlHash:location&&location.hash||"",canvasHeight:Math.round((m=document.body)===null||m===void 0?void 0:m.clientHeight)||0,canvasWidth:Math.round((v=document.body)===null||v===void 0?void 0:v.clientWidth)||0,viewportHeight:Math.round(window.innerHeight)||0,viewportWidth:Math.round(window.innerWidth)||0,version:"5.0.1",siteEnvironment:H,application:n.service||Cl,handle:R,softNavigation:i,canonicalUrl:xo(w.href)},n.shopId?{shopId:n.shopId}:{},n.tabToken?{tabToken:n.tabToken}:{},n.manifestRouteId?{manifestRouteId:n.manifestRouteId}:{},$?{extraMetadata:$}:{})};if(e.dux(U),n.metadata){var q=n.httpStatusCode?Number(n.httpStatusCode):void 0;e.dux(j({userLanguage:navigator&&navigator.language||"",url:S,referrer:I,pageViewToken:n.pageViewToken,siteEnvironment:H},q?{httpStatusCode:q}:{},B?{experimentVariationId:B}:{},n.sessionId?{sessionId:n.sessionId}:{},n.identityUuid?{identityUuid:n.identityUuid}:{},n.userId?{userId:n.userId}:{},n.MedusaJSEmployee?{MedusaJSEmployee:n.MedusaJSEmployee}:{},n.MedusaJSEmployeeId?{MedusaJSEmployeeId:n.MedusaJSEmployeeId}:{},n.shopId?{shopId:n.shopId}:{}),{flush:!0})}},Tr,xl=function(t,e,n){ei="",n&&(Tr=function(r){n(r),Os({track:t,store:e,softNavigation:!0})}),Os({track:t,store:e})},Rl=function(t){if(ei!==location.href){var e=t||{};e.httpStatusCode=e.httpStatusCode||void 0,Tr&&Tr(e),document.dispatchEvent(new CustomEvent("website_client_page_view/2.14",{detail:e}))}},xs="hidden",ir="visible",Ll=function(t,e){var n=new Date().getTime(),r=function(s){return function(){var a=new Date().getTime(),c={schemaId:"website_visibility_change_event/1.0",payload:{pageViewToken:e.pageViewToken||"",state:s,duration:Math.round(a-n)}};t.dux(c,{flush:!0}),n=a,i(s===ir?xs:ir)}},i=function(s){Ao([["visibilitychange",r(s),document],[s===ir?"pageshow":"pagehide",r(s),window,!0]])};i(xs)},Qt=[],Zt=null,Ro=function(t,e){var n=0,r=0,i=!1,s=e.pageViewToken;Qt.forEach(function(v){return Le(v)}),Qt=[],Zt&&Le(Zt),Zt=null;var a=function(){var v,S,w,L,A,R,I,B,V,H,$=(((S=document)===null||S===void 0||(v=S.documentElement)===null||v===void 0?void 0:v.scrollHeight)||((L=document)===null||L===void 0||(w=L.body)===null||w===void 0?void 0:w.scrollHeight))-((R=document)===null||R===void 0||(A=R.documentElement)===null||A===void 0?void 0:A.clientHeight),U=((B=document)===null||B===void 0||(I=B.documentElement)===null||I===void 0?void 0:I.scrollTop)||((H=document)===null||H===void 0||(V=H.body)===null||V===void 0?void 0:V.scrollTop),q=U?Math.round(U/$*100):0;return q>n&&(n=q,n<25?r=0:n<50?r=25:n<75?r=50:n<95?r=75:r=100),r},c=function(v){var S=a();h(S)},h=function(v){if(!i){i=!0;var S={schemaId:"website_scroll_event/1.0",payload:{pageViewToken:s,quadrant:v}};t.dux(S,{flush:!0}),t.gtm&&t.gtm({event:"scroll",scrollDepth:v}),Qt.forEach(function(w){return Le(w)})}},p=Oo(function(){var v=a();v===100&&h(v)}),m=function(v){h(r),Ro(t,e)};Qt.push(re("scroll",p,document),re("beforeunload",c,window),re("unload",c,window),re("pagehide",c,window),re("visibilitychange",c,document)),Zt=Qr("website_client_page_view/2.14",m,document),p()},Ml={CLS:"cumulativeLayoutShift",CLS_ENTRIES:"cumulativeLayoutShiftEntries",FCP:"firstContentfulPaint",LCP:"largestContentfulPaint",TTFB:"timeToFirstByte",INP:"interactionToNextPaint",FPS:"framesPerSecond"},Pl=function(t,e){return ke(function(){var n,r,i,s,a;return De(this,function(c){return n=!1,r=function(h){if(!n){var p=Math.round(0),m={schemaId:"website_web_vitals_event/2.1",payload:j({pageViewToken:i},p?{framesPerSecond:p}:{},h.CLS?{cumulativeLayoutShift:Math.round(h.CLS.value),cumulativeLayoutShiftEntries:h.CLS.entries.length}:{},h.FCP?{firstContentfulPaint:Math.round(h.FCP.value)}:{},h.LCP?{largestContentfulPaint:Math.round(h.LCP.value)}:{},h.TTFB?{timeToFirstByte:Math.round(h.TTFB.value)}:{},h.INP?{interactionToNextPaint:Math.round(h.INP.value)}:{})};t.dux(m,{flush:!0}),n=!0}},i=e.pageViewToken,s={},a=function(h){h.name in Ml&&(s[h.name]=h),!n&&Object.keys(s).length===5&&r(s)},uu(a),fu(a),_u(a),gu(a),go(a),Ao([["beforeunload",function(){return r(s)},window,!0],["unload",function(){return r(s)},window,!0],["pagehide",function(){return r(s)},window,!0]]),[2]})})()},Il=function(t){return t.HandshakeRequest="DUX_HANDSHAKE_REQUEST",t.HandshakeResponse="DUX_HANDSHAKE_RESPONSE",t.ContextUpdate="DUX_CONTEXT_UPDATE",t}(Il||{}),Nl=function(){function t(){Yr(this,t),this.connections=[],this.isChild=!1,this.parentWindow=null,this.parentOrigin=null,this.isInitialized=!1,this.messageSequence=0,this.receivedNonces=new Set,this.MAX_MESSAGE_AGE_MS=5e3,this.MAX_NONCE_CACHE_SIZE=100,this.lastDiscoveryTime=0,this.DISCOVERY_DEBOUNCE_MS=500,this.DISCOVERY_RATE_LIMIT_MS=2e3,this.isChild=this.isWindowAvailable()&&window.self!==window.top,this.setupMessageListener()}return Jr(t,[{key:"initAsParent",value:function(e){var n=this;this.isChild||this.isInitialized||(this.isInitialized=!0,this.discoverIframes(),this.connections.forEach(function(r){n.sendMessage(r.window,{type:"DUX_HANDSHAKE_REQUEST",source:"dux"},r.origin)}),this.broadcastContext(e),this.watchForNewIframes(e))}},{key:"initAsChild",value:function(e){!this.isChild||this.isInitialized||!this.isWindowAvailable()||(this.isInitialized=!0,this.onContextUpdateCallback=e,window.parent&&window.parent!==window.self&&(this.parentWindow=window.parent,this.parentOrigin=this.getParentOrigin(),this.sendMessage(this.parentWindow,{type:"DUX_HANDSHAKE_RESPONSE",source:"dux"},this.parentOrigin)))}},{key:"broadcastContext",value:function(e){var n=this;this.isChild||this.connections.forEach(function(r){r.ready?n.sendMessage(r.window,{type:"DUX_CONTEXT_UPDATE",payload:n.serializeContext(e),source:"dux"},r.origin):(r.pendingUpdates||(r.pendingUpdates=[]),r.pendingUpdates.push(e))})}},{key:"hasIframes",value:function(){return!this.isChild&&this.connections.length>0}},{key:"isRunningInIframe",value:function(){return this.isChild}},{key:"cleanup",value:function(){this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=void 0),this.messageListener&&this.isWindowAvailable()&&(window.removeEventListener("message",this.messageListener),this.messageListener=void 0),this.iframeDiscoveryTimeout&&(clearTimeout(this.iframeDiscoveryTimeout),this.iframeDiscoveryTimeout=void 0),this.connections=[],this.receivedNonces.clear(),this.onContextUpdateCallback=void 0,this.isInitialized=!1,this.messageSequence=0}},{key:"isWindowAvailable",value:function(){return(typeof window>"u"?"undefined":W(window))<"u"}},{key:"discoverIframes",value:function(){var n=this;!this.isWindowAvailable()||(typeof document>"u"?"undefined":W(document))>"u"||document.querySelectorAll("iframe").forEach(function(r){if(!n.connections.some(function(s){return s.iframe===r})&&r.contentWindow){var i=n.getIframeOrigin(r);n.connections.push({iframe:r,window:r.contentWindow,ready:!1,origin:i})}})}},{key:"getIframeOrigin",value:function(e){if(!this.isWindowAvailable())return"";try{var n=e.src;if(n)return new URL(n,window.location.href).origin}catch{}return window.location.origin}},{key:"getParentOrigin",value:function(){if(!this.isWindowAvailable()||(typeof document>"u"?"undefined":W(document))>"u")return"";try{if(document.referrer)return new URL(document.referrer).origin}catch{}return window.location.origin}},{key:"isValidOrigin",value:function(e){if(!this.isWindowAvailable()||!e||e==="null"||e.startsWith("data:")||e.startsWith("javascript:"))return!1;try{if(!new URL(e).protocol)return!1}catch{return!1}return e===window.location.origin?!0:this.isChild?e===this.parentOrigin:this.connections.some(function(n){return n.origin===e})}},{key:"watchForNewIframes",value:function(e){var n=this;(typeof MutationObserver>"u"?"undefined":W(MutationObserver))>"u"||(typeof document>"u"?"undefined":W(document))>"u"||(this.mutationObserver=new MutationObserver(function(r){var i=!1;if(r.forEach(function(a){a.addedNodes.forEach(function(c){c.nodeName==="IFRAME"&&(i=!0)})}),i){n.iframeDiscoveryTimeout&&clearTimeout(n.iframeDiscoveryTimeout);var s=Date.now()-n.lastDiscoveryTime;if(s<n.DISCOVERY_RATE_LIMIT_MS){console.warn("Dux iframe sync: Rate limiting iframe discovery (".concat(s,"ms since last)"));return}n.iframeDiscoveryTimeout=setTimeout(function(){n.lastDiscoveryTime=Date.now(),n.discoverIframes(),n.connections.forEach(function(a){a.ready||n.sendMessage(a.window,{type:"DUX_HANDSHAKE_REQUEST",source:"dux"},a.origin)}),n.broadcastContext(e)},n.DISCOVERY_DEBOUNCE_MS)}}),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0}))}},{key:"setupMessageListener",value:function(){var n=this;this.isWindowAvailable()&&window.addEventListener("message",function(r){try{var i=r.data;if(!i||i.source!=="dux")return;if(!n.isValidOrigin(r.origin)){console.warn("Dux iframe sync: Blocked message from unauthorized origin: ".concat(r.origin));return}if(!n.validateMessage(i))return;if(!r.source||W(r.source)!="object"){console.warn("Dux iframe sync: Invalid message source");return}n.handleMessage(i,r.source)}catch(s){console.warn("Dux iframe sync: Error processing message:",s)}})}},{key:"handleMessage",value:function(e,n){var r=this;switch(e.type){case"DUX_HANDSHAKE_REQUEST":this.isChild&&this.parentWindow===n&&this.sendMessage(n,{type:"DUX_HANDSHAKE_RESPONSE",source:"dux"},this.parentOrigin||void 0);break;case"DUX_HANDSHAKE_RESPONSE":if(!this.isChild){var i=this.connections.find(function(s){return s.window===n});i&&(i.ready=!0,i.pendingUpdates&&i.pendingUpdates.length>0&&(i.pendingUpdates.forEach(function(s){r.sendMessage(i.window,{type:"DUX_CONTEXT_UPDATE",payload:r.serializeContext(s),source:"dux"},i.origin)}),i.pendingUpdates=[]))}break;case"DUX_CONTEXT_UPDATE":this.isChild&&e.payload&&this.onContextUpdateCallback&&this.onContextUpdateCallback(e.payload);break}}},{key:"sendMessage",value:function(e,n,r){if(this.isWindowAvailable())try{var i=le(j({},n),{timestamp:Date.now(),nonce:this.generateNonce(),sequence:this.messageSequence++}),s=r||window.location.origin;e.postMessage(i,s)}catch(a){console.warn("Dux iframe sync: Failed to send message to iframe:",a)}}},{key:"serializeContext",value:function(e){var n=Object.create(null);return Object.keys(e).forEach(function(r){if(r==="__proto__"||r==="constructor"||r==="prototype"){console.warn('Dux: Blocked dangerous property "'.concat(r,'" in context'));return}if(Object.prototype.hasOwnProperty.call(e,r)){var i=e[r];typeof i!="function"&&(typeof i>"u"?"undefined":W(i))!="symbol"&&(typeof i>"u"?"undefined":W(i))<"u"&&(n[r]=i)}}),n}},{key:"generateNonce",value:function(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11))}},{key:"validateMessage",value:function(e){var n=Date.now()-e.timestamp;if(n>this.MAX_MESSAGE_AGE_MS||n<0)return console.warn("Dux iframe sync: Rejected message with invalid timestamp (age: ".concat(n,"ms)")),!1;if(this.receivedNonces.has(e.nonce))return console.warn("Dux iframe sync: Rejected replayed message (duplicate nonce)"),!1;if(this.receivedNonces.add(e.nonce),this.receivedNonces.size>this.MAX_NONCE_CACHE_SIZE){var r=this.receivedNonces.values().next().value;r&&this.receivedNonces.delete(r)}return!0}}]),t}(),en=new Nl,ti=function(t,e){return t&&el.includes(t.toUpperCase())?"gdpr":(t==null?void 0:t.toUpperCase())==="US"&&(e==null?void 0:e.toUpperCase())==="CA"?"ccpa":"none"},kl=[".spin.dev",".workers.dev",".myMedusaJS.io",".myMedusaJS.dev"],Ul=[".com",".com.br",".co.uk",".dev",".engineering",".io",".ai",".app",".org"],Dl=function(t){var e=t.hostname,n=Ul.find(function(r){return e.endsWith(r)});if(n&&!kl.find(function(r){return e.endsWith(r)}))return".".concat(e.split(n)[0].split(".").pop()).concat(n);if(e.startsWith("www."))return".".concat(e.split("www.").pop())},Ot=Dl,Bl=function(t){return t.schemaId!==void 0},$l=10,Fl=1024,Hl=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array;Yr(this,t),this.store=e,this.queue=n,this.track=this.track.bind(this),this.flush=this.flush.bind(this),this.debounceFlush=Oo(this.flush.bind(this),250),re("beforeunload",this.flush,window),re("unload",this.flush,window),re("pagehide",this.flush,window)}return Jr(t,[{key:"track",value:function(e,n){var r,i=n||{},s=i.flush,a=s===void 0?!1:s,c=i.preserveCase,h=c===void 0?[]:c,p=i.clientMessageId,m=p===void 0?at():p,v=i.isEssential,S=Bl(e)?le(j({},e),{payload:Dt(e.payload,h),options:{convertEventCase:!1},metadata:{eventCreatedAtMs:Date.now(),clientMessageId:m}}):e;if(this.store.enableActiveConsent&&this.store.isConsentRequired&&!v&&((r=this.store.consentState)===null||r===void 0?void 0:r.consentedAnalytics)!=="1"){var w,L=JSON.parse(sessionStorage.getItem(Jt)||"[]");((w=this.store.consentState)===null||w===void 0?void 0:w.consentedAnalytics)!=="-1"&&L.length<Fl&&(L.push(S),sessionStorage.setItem(Jt,JSON.stringify(L)))}else this.queue.push(S),a||this.queue.length>=$l?this.flush():this.debounceFlush()}},{key:"flush",value:function(){var n;if(!((typeof window>"u"?"undefined":W(window))>"u")){var r=[];((n=this.store.consentState)===null||n===void 0?void 0:n.consentedAnalytics)==="1"&&(r=JSON.parse(sessionStorage.getItem(Jt)||"[]"),sessionStorage.removeItem(Jt));var i=Ct(this.queue).concat(Ct(r));this.queue.length=0,i.length&&this.send(i)}}},{key:"send",value:function(e){return ke(function(){var n,r,i,s;return De(this,function(a){n={multiTrackToken:this.store.multiTrackToken||"",sessionToken:this.store.sessionToken||"",enableActiveConsent:this.store.enableActiveConsent||!1,enableProtoEventForwarding:this.store.enableProtoEventForwarding||!1,enableOptOutSaleOfData:this.store.enableOptOutSaleOfData||!1,protoSessionAppType:this.store.protoSessionAppType,events:e},r=JSON.stringify(n),i=this.store.eventHandlerEndpoint||Eo;try{if(this.isSendBeaconAndBlobSupported()&&(s=new window.Blob([r],{type:"application/json"}),window.navigator.sendBeacon.bind(window.navigator)(i,s)))return[2,Promise.resolve({status:200})]}catch{}return[2,fetch(i,{method:"POST",headers:{"cache-control":"no-store","content-type":"application/json"},credentials:"include",body:r}).then(function(c){return{response:c,message:n,status:c.status||0}}).catch(function(c){return{message:n,status:0,error:c}})]})}).call(this)}},{key:"isSendBeaconAndBlobSupported",value:function(){return window&&window.navigator&&typeof window.navigator.sendBeacon=="function"&&typeof window.Blob=="function"}}]),t}(),Vl=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array;Yr(this,t),this.store=e,this.queue=n,this.queueInterval=null,this.track=this.track.bind(this)}return Jr(t,[{key:"track",value:function(e){var n=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=j({project:"brochure",service:this.store.service,user_token:this.store.multiTrackToken||"",event:"event",event_non_interaction:"false",event_context:r,experiment_variation_id:this.store.experimentVariationId||""},Dt(e));window.dataLayer?window.dataLayer.push(i):(this.queue.push(i),this.queueInterval||(this.queueInterval=setInterval(function(){if(window.dataLayer)for(n.queueInterval&&clearInterval(n.queueInterval);n.queue.length;){var s=n.queue.shift();window.dataLayer.push(s)}},100)))}}]),t}(),xt=function(t){var e;if(!((typeof document>"u"?"undefined":W(document))>"u")){var n=new RegExp("(?:^|; )".concat(t,"=([^;]*)(?:$|;| )")),r=(e=document)===null||e===void 0?void 0:e.cookie.match(n);return r?decodeURIComponent(r[1]):""}},pn=function(t,e,n){if((typeof document>"u"?"undefined":W(document))>"u"){console.warn("setCookie should only be called client-side",new Error("setCookie called outside of browser context."));return}var r="".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e));n.maxage&&(n.maxage<0?n.expires=new Date(0):n.expires=new Date(new Date().getTime()+n.maxage)),n.path&&(r+="; path=".concat(n.path)),n.domain&&(r+="; domain=".concat(n.domain)),n.expires&&(r+="; expires=".concat(n.expires.toUTCString())),n.samesite?r+="; SameSite=".concat(n.samesite):r+="; SameSite=lax",n.secure&&!window.E2E&&(r+="; secure"),document.cookie=r};function Gl(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(e,n){var r=parseInt("0x".concat(n),16);return String.fromCharCode(r)}))}function jl(t){return decodeURIComponent(atob(t).split("").map(function(e){return"%".concat("00".concat(e.charCodeAt(0).toString(16)).slice(-2))}).join(""))}function zl(t){return(typeof Buffer>"u"?"undefined":W(Buffer))<"u"?Buffer.from(t).toString("base64"):Gl(t)}function ql(t){return(typeof Buffer>"u"?"undefined":W(Buffer))<"u"?Buffer.from(t,"base64").toString():jl(t)}var Ln=function(){var t=xt("privacy_signal");if(t)try{return JSON.parse(ql(t))}catch(e){console.error("Invalid privacy settings, ".concat(e)),Lo()}},Lo=function(){var t=Ot(new URL(window.location.href));pn("privacy_signal","",{maxage:0,path:"/",secure:!0,samesite:"lax",domain:t})},Xl=function(t){var e=Ln(),n=new URL(window.location.href),r=j(le(j({},e),{apiVersion:wo,rootDomain:Ot(n),date:String(Date.now()),url:n.href}),t),i=Ot(new URL(window.location.href));return pn("privacy_signal",zl(JSON.stringify(r)),{maxage:365*24*60*60*1e3,path:"/",secure:!0,samesite:"lax",domain:i}),r},Kl={privacy_signal:"essential",_MedusaJS_y:"analytics",_MedusaJS_s:"analytics"},Wl=function(t,e){var n=[],r=e.approvedCookiesList,i=e.cookieBlockerDryRunOnly,s=j({},Kl,r||{}),a=e.countryCode,c=e.regionCode;if(ti(a,c)==="gdpr"){var h=Object.keys(s).filter(function(v){return v.includes("%")}).map(function(v){return{glob:v,regex:new RegExp("^".concat(v.replace(/%/g,".*"),"$"))}}),p=Object.getOwnPropertyDescriptor(Document.prototype,"cookie")||Object.getOwnPropertyDescriptor(HTMLDocument.prototype,"cookie");if(p&&p.configurable){var m=function(v,S){if(!v)return"Missing cookie";if(!S)return"Cookie not in allow list";if(S!=="essential"){var w=Ln()||{},L=w.consentedAnalytics,A=w.consentedFunctional,R=w.consentedMarketing,I=function(B){return"Missing ".concat(B," consent")};if(S==="analytics"&&L!=="1"||S==="functional"&&A!=="1"||S==="marketing"&&R!=="1")return I(S)}};Object.defineProperty(Document.prototype||HTMLDocument.prototype,"cookie",{get:function(){var S;return p==null||(S=p.get)===null||S===void 0?void 0:S.call(this)},set:function(v){var S,w=Ue(/(.+?)=/g.exec(v)||[],2),L=w[1];if(L){var A=s[L];if(!A&&h.length){var R=h.find(function(V){var H=V.regex;return H.test(L)});R&&(A=s[R.glob])}var I=m(L,A);if(I){if(n.includes(L)||n.length>20)return;if(n.push(L),i){var B={schemaId:"website_error_event/1.1",payload:{pageViewToken:e.pageViewToken||"",message:"[Client Consent Error] cookie blocked",extraMetadata:JSON.stringify(j({cookieName:L,reason:I},i?{isDryRun:!0}:{}))}};t.dux(B)}}(!I||i)&&(p==null||(S=p.set)===null||S===void 0||S.call(this,v))}},configurable:!0})}}},Tt={debug:!0,enableActiveConsent:!1,isReady:!1},Yl=function(){var t=0;if(window&&window.performance&&typeof window.performance.getEntriesByType=="function"){var e=window.performance.getEntriesByType("navigation");Array.isArray(e)&&e[0]&&W(e[0])=="object"&&(t=e[0].responseStatus||0)}return!t&&document.title.match(/(^|\s)404($|\b)/i)&&(t=404),t},sr,Mo=function(t){return ke(function(){var e,n,r,i,s,a,c;return De(this,function(h){switch(h.label){case 0:return e=t.eventHandlerEndpoint,n=e===void 0?Eo:e,r=t.protoSessionAppType,i=t.enableSecGpc,s=t.enableOptOutSaleOfData,a={pb:"geo",enableActiveConsent:!0,protoSessionAppType:r,enableOptOutSaleOfData:s,enableSecGpc:i},c=JSON.stringify(a),[4,fetch(n,{method:"POST",headers:{"cache-control":"no-store","content-type":"application/json"},credentials:"include",body:c})];case 1:return[2,h.sent().json()]}})})()},Jl=function(){return new Promise(function(t){document.body?t():Qr("domcontentloaded",t)})},pm=function(t,e,n,r,i){return ke(function(){return De(this,function(s){return[2,(sr=sr||function(){return ke(function(){var a,c,h,p,m;return De(this,function(v){switch(v.label){case 0:if((typeof window>"u"?"undefined":W(window))>"u")throw new Error("window is undefined");if(t.enableOptOutSaleOfData=(a=t.enableOptOutSaleOfData)!==null&&a!==void 0?a:!0,c=t.enableActiveConsent&&!t.countryCode,h=(t.countryCode===void 0||t.countryCode==="US")&&t.enableSecGpc===void 0,!(c||h))return[3,4];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Mo(t)];case 2:return p=v.sent(),Object.assign(t,p),[3,4];case 3:return m=v.sent(),console.warn("Dux: unable to fetch server-data",m),[3,4];case 4:return[4,Jl()];case 5:return v.sent(),Ql(t,e,n),[2]}})})()}(),sr)]})})()},Ql=function(t,e,n,r,i){document.body.setAttribute(Xu,"1");var s=ti(t.countryCode,t.regionCode),a=Object.assign(Tt,le(j({},t,Rs(t),an(t.enableActiveConsent,s,t.enableSecGpc)),{complianceZone:s,httpStatusCode:t.httpStatusCode||Yl(),isReady:!0}));e&&e(a);var c={dux:new Hl(a).track,gtm:t!=null&&t.enableGtm?new Vl(a).track:void 0};n&&c&&n(c);var h=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e?e(w,a):Object.assign(a,w),en.broadcastContext(a)},p=t.disableLogger,m=t.enableLogger;m!=null&&m.cookieBlocker&&Wl(c,a);var v=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},L=a.enableActiveConsent,A=a.complianceZone,R=a.enableSecGpc,I=j({},w,Rs(w),an(L,A,R));h(I)};en.isRunningInIframe()?en.initAsChild(function(w){h(w)}):en.initAsParent(a),p!=null&&p.page||xl(c,a,v),p!=null&&p.click||wl(c,a,[document.body]),p!=null&&p.componentViewability||ml(c,a),p!=null&&p.error||Al(c,a),p!=null&&p.visibility||Ll(c,a),p!=null&&p.webVitals||Pl(c,a),p!=null&&p.scroll||Ro(c,a),p!=null&&p.form||vl(c,a);var S=function(w){document.dispatchEvent(new CustomEvent(w,{detail:le(j({},a.consentState),{isConsentRequired:a.isConsentRequired,complianceZone:a.complianceZone,countryCode:a.countryCode,regionCode:a.regionCode,canLoadAnalytics:a.canLoadAnalytics,canLoadFunctional:a.canLoadFunctional,canLoadMarketing:a.canLoadMarketing,optOutSaleOfData:a.optOutSaleOfData,enableSecGpc:a.enableSecGpc})}))};re("dux_opt_out_sale_of_data",function(w){return ke(function(){var L,A,R,I,B,V;return De(this,function(H){switch(H.label){case 0:return L=w.detail,A=L||{},R=A.optOutSaleOfData,I=a.enableActiveConsent,B=a.complianceZone,[4,Mo(le(j({},t),{enableSecGpc:R}))];case 1:return V=H.sent(),h(j({},V,an(I,B,R))),S("dux_consent_changed"),[2]}})})()},document),S("dux_consent_ready")},an=function(t,e,n){var r=e==="gdpr",i=Ln(),s=i||{},a=s.consentedAnalytics,c=function(L){return t===!1||r===!1||r===!0&&L==="1"},h=xt("_MedusaJS_y"),p=xt("_MedusaJS_s"),m="",v="";if(!t||!r||a==="1"){m=h||at(),v=p||at();var S=Ot(new URL(window.location.href));m!==h&&pn("_MedusaJS_y",m,{maxage:365*24*60*60*1e3,path:"/",secure:!0,samesite:"lax",domain:S}),v!==p&&pn("_MedusaJS_s",v,{maxage:30*60*1e3,path:"/",secure:!0,samesite:"lax",domain:S})}var w=n||(i==null?void 0:i.consentedSaleOfData)==="-1";return{consentState:i,isConsentRequired:r,multiTrackToken:m,sessionToken:v,isNewUser:!h,canLoadAnalytics:c(i==null?void 0:i.consentedAnalytics),canLoadFunctional:c(i==null?void 0:i.consentedFunctional),canLoadMarketing:c(i==null?void 0:i.consentedMarketing),optOutSaleOfData:w}},Rs=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.location.href,n,r,i,s,a,c=t.pageViewToken||at(),h=t.metadata,p=t.canonicalUrl,m=t.extraMetadata,v=new URL(e),S=(h==null||(n=h.site)===null||n===void 0?void 0:n.pathPrefix)||Zu(v)||"",w=(h==null||(r=h.page)===null||r===void 0?void 0:r.experimentVariationId)||"",L=le(j({},h==null?void 0:h.page),{affiliate:(h==null||(i=h.page)===null||i===void 0?void 0:i.affiliate)||v.searchParams.get("partner")||xt("source")||"",experimentVariationId:w}),A=le(j({},h==null?void 0:h.site),{pathPrefix:S});return{pageViewToken:c,url:e,pageLanguageCode:(S==null?void 0:S.substring(0,S.indexOf("-")))||"en",lastShopDomain:xt("last_shop"),canonicalUrl:p||((s=document.querySelector('link[rel="canonical"]'))===null||s===void 0?void 0:s.getAttribute("href"))||e.split(/[?#]/)[0],experimentVariationId:w,metadata:le(j({},h),{title:(h==null?void 0:h.title)||document.title,language:(h==null||(a=h.page)===null||a===void 0?void 0:a.language)||navigator.language||"",page:L,site:A}),extraMetadata:m}},Po=vo(function(t,e){return j({trackers:void 0,emitPageView:Rl,updateTrackers:function(n){return t({trackers:n})},updateStore:function(n,r){var i=e(),s=i.store,a=s===void 0?r||Tt:s;return Object.assign(a,n),Object.assign(r||Tt,a),t(j({store:a},a))},store:Tt},Tt)}),Zl=vo(function(t,e){var n=function(c){return t(c)},r=function(c){t({onChangeCallback:c})},i=function(c){var h=e(),p=h.hasConsentedAnalytics,m=h.hasConsentedFunctional,v=h.hasConsentedMarketing,S=h.countryCode,w=S===void 0?"":S,L=h.regionCode,A=L===void 0?"":L,R=h.complianceZone,I=h.isConsentRequired,B=h.enableSecGpc,V=h.handleTracking,H=h.onChangeCallback,$=Xl({consentedAll:c.hasConsentedAnalytics&&c.hasConsentedFunctional&&c.hasConsentedMarketing?"1":"-1",consentedAnalytics:c.hasConsentedAnalytics?"1":"-1",consentedFunctional:c.hasConsentedFunctional?"1":"-1",consentedMarketing:c.hasConsentedMarketing?"1":"-1",countryCode:w,regionCode:A,complianceZone:R}),U=an(!0,R),q=U.multiTrackToken,oe=U.sessionToken;n(j({hasMadeChoice:!0,privacySettings:$,shouldShowCookieNotice:!1},c));var J=$.consentedAnalytics==="1",fe=$.consentedFunctional==="1",dt=$.consentedMarketing==="1";V&&V($,q,oe,J,fe,dt),(p&&p!==c.hasConsentedAnalytics||m&&m!==c.hasConsentedFunctional||v&&v!==c.hasConsentedMarketing)&&setTimeout(function(){return window.location.reload()},500),document.dispatchEvent(new CustomEvent("dux_consent_changed",{detail:le(j({},$),{complianceZone:R,countryCode:w,regionCode:A,isConsentRequired:I,enableSecGpc:B,canLoadAnalytics:$.consentedAnalytics==="1",canLoadFunctional:$.consentedFunctional==="1",canLoadMarketing:$.consentedMarketing==="1",optOutSaleOfData:$.consentedSaleOfData==="-1"})})),H&&H(j({},c))},s=function(){var c=e(),h=c.isConsentRequired,p=c.hasMadeChoice,m=c.hasConsentedAnalytics,v=c.hasConsentedFunctional,S=c.hasConsentedMarketing,w=c.updateOnChangeCallback;return{isConsentRequired:h,hasMadeChoice:p,hasConsentedAnalytics:m,hasConsentedFunctional:v,hasConsentedMarketing:S,updateOnChangeCallback:w}},a=function(c){document.dispatchEvent(new CustomEvent("cookie_notice_banner",{detail:{shouldShowCookieNotice:c}}))};return{complianceZone:"none",shouldShowCookieNotice:!1,hasMadeChoice:!1,hasConsentedAnalytics:!1,hasConsentedFunctional:!1,hasConsentedMarketing:!1,updateState:n,updateOnChangeCallback:r,persistPrivacySignal:i,getPublicState:s,updateShowCookieNotice:a}}),_m=function(t){var e=Zl(Eu(function(c){return j({isConsentRequired:t?!0:void 0},c)})),n=ed(),r=Po()||{},i=r.store,s=i||{},a=s.isReady;return lo.useEffect(function(){if(!(!t||!a)){var c=e.updateState,h=e.persistPrivacySignal,p=t.apiVersion,m=p===void 0?wo:p,v=new URL(location.href),S=Ot(new URL(window.location.href)),w=(t==null?void 0:t.countryCode)||(i==null?void 0:i.countryCode)||"",L=(t==null?void 0:t.regionCode)||(i==null?void 0:i.regionCode)||"",A=ti(w,L),R=(t==null?void 0:t.enableSecGpc)||(i==null?void 0:i.enableSecGpc),I=A==="gdpr",B=!1,V=!1,H=!1,$=!1,U,q=!1,oe=function(){U=void 0,Lo()};if(U=Ln(),U){var J=U.consentedAll,fe=U.consentedAnalytics,dt=U.consentedFunctional,kn=U.consentedMarketing,Un=U.consentedSaleOfData,we=U.apiVersion,Bt=we===void 0?"":we,He=Ue(Bt.split("."),3),$t=He[0],Ve=$t===void 0?0:$t,Ft=He[1],ht=Ft===void 0?0:Ft,Ht=He[2],Vt=Ht===void 0?0:Ht,Ge=Ue(m.split("."),3),je=Ge[0],ft=Ge[1],Gt=Ge[2],pe=Ve<je||Ve===je&&ht<ft||Ve===je&&ht===ft&&Vt<Gt,Te=!!(fe||J);Bt!==m&&pe&&(J==="-1"||je!==Ve||ft!==ht?Te=!1:Gt!==Vt&&(q=!0)),Te?(B=!0,V=fe==="1"||J==="1",H=dt==="1"||J==="1",$=kn==="1"||J==="1"):Un||oe()}var Dn=t.shouldShowCookieNotice||I&&!B;c({rootDomain:S,complianceZone:A,regionCode:L,url:v.href,countryCode:w,apiVersion:m,enableSecGpc:R,hasMadeChoice:B,shouldShowCookieNotice:Dn,isConsentRequired:I,hasConsentedAnalytics:V,hasConsentedFunctional:H,hasConsentedMarketing:$,privacySettings:U,handleTracking:n}),(typeof window>"u"?"undefined":W(window))<"u"&&(window.cmp=e.getPublicState),q&&h({hasConsentedAnalytics:V,hasConsentedFunctional:H,hasConsentedMarketing:$})}},[n,a]),e},ed=function(){var t=Po(),e=t.store,n=t.trackers,r=t.pageViewToken,i=t.updateStore;return lo.useCallback(function(s,a,c,h,p,m){var v=s.consentedAnalytics,S=s.consentedFunctional,w=s.consentedMarketing,L=s.consentedSaleOfData,A=s.complianceZone,R=s.countryCode,I=s.regionCode,B=s.url,V=s.apiVersion;if(e&&n){var H=v?v==="1":void 0,$=S?S==="1":void 0,U=w?w==="1":void 0,q=H&&$&&U,oe=L?L==="1":void 0,J={schemaId:"website_privacy_signal/1.2",payload:{pageViewToken:r,multitrackToken:a||"",sessionToken:c||"",countryCode:R,complianceZone:A,url:B,consentedAnalytics:H,consentedFunctional:$,consentedMarketing:U,consentedAll:q,consentedSaleOfData:oe,apiVersion:V,regionCode:I}};i({consentState:s,canLoadAnalytics:h,canLoadFunctional:p,canLoadMarketing:m,multiTrackToken:a,sessionToken:c}),setTimeout(function(){n.dux(J,{flush:!0,isEssential:!0})},2)}},[e,n,r,i])};const td="1d80f5775f07ce12a6bbbb89d00bd27a",gm="__ro0yTOmc_xRHK3YoVLhazmMwX7W283zP489VgSO3Q",mm="google_site_verification_code",ym={appBannerDismissed:"appBannerDismissed",pendingFavorite:"pendingFavorite",pendingFollow:"pendingFollow",hasShownIneligibleCashUserToast:"hasShownIneligibleCashUserToast",giveawaysClaimStarted:"giveawaysClaimInProgress",giveawaysClaimToken:"giveawaysClaimToken",productListAppBannerDismissed:"productListAppBannerDismissed",adsLanding:"adsLanding"},vm="https://shop.app/shop-pay",Sm=1223471316,bm="https://shop.app/download",Em="https://shop.app/pay/account",wm="https://help.shop.app/shop/shop-cash",Tm="AIzaSyAjolzwFbSDGiEeDbQr4cvLfEEb3qrxPrM",Am="5e0e69c11bf2b1e7",Cm="6LfsKiQaAAAAAIRDckRZ2y3ZJCKQIhFH1jEodGBY",Ke="https://open.shop.app/E2jp6",Om={OPEN:`${Ke}/npz99/id3h`,APPLE_STORE:`${Ke}/yphyl/7qog`,GOOGLE_STORE:`${Ke}/frmk/3n2h`,APPLE_WALLET:`${Ke}/8scl/qnwe`,SHOP_PAY:`${Ke}/ow06/og3o`,GIFT_FEATURE:`${Ke}/yvfg1/8ooc`},xm="(855) 914-3141",Rm="https://shop.app/.well-known/dux",Lm={"checkout_session_token_%":k.Essential,_tracking_consent:k.Essential,_MedusaJS_essential:k.Essential,checkout_session_lookup:k.Essential,cart_currency:k.Essential,cart_sig:k.Essential,cart:k.Essential,user_cross_site:k.Essential,user:k.Analytics,_pay_session:k.Essential,privacy_signal:k.Essential,"verify-email-%":k.Essential,storefront_digest:k.Essential,"skip_webauthn_web_login_%":k.Essential,cf_clearance:k.Essential,remember_me:k.Essential,cf_chl_rc_m:k.Essential,_MedusaJS_y:k.Analytics,_MedusaJS_s:k.Analytics,_landing_page:k.Analytics,_orig_referrer:k.Analytics,_MedusaJS_sa_t:k.Analytics,_MedusaJS_sa_p:k.Analytics,"_ga_%":k.Analytics,_ga:k.Analytics,"_shop-server_session":k.Analytics,_y:k.Analytics,_s:k.Analytics,chat_docked:k.Analytics,skip_shop_pay:k.Analytics,chat_hidden:k.Analytics,web_last_path:k.Analytics,_shop_app_analytics:k.Analytics,web_oauth_verifier:k.Analytics,web_oauth_state:k.Analytics,"kifc%":k.Marketing,_gcl_au:k.Marketing,_fbp:k.Marketing},Mm="00000000-0000-0000-5000-000000000000",Pm="00000000-0000-0000-5000-000000000000",Im="https://cdn.MedusaJS.com/shop-assets/static_uploads/web/shop_logo/shop-logo-default.png",nd="Shop",Nm=`- ${nd}`,rd=ot.Client;function km(t,e,n=[]){const r=["production","staging"];if(!ot.isStarted())return ot.start({apiKey:td,enabledReleaseStages:r,releaseStage:t,appVersion:e,plugins:n,endpoints:{notify:"https://error-analytics-production.MedusaJSsvc.com",sessions:"https://error-analytics-sessions-production.MedusaJSsvc.com"},redactedKeys:["X-Shop-Service-API-Token",/^password$/i,"creditcard","credit_card","code","x-csrf-token","x-minerva-token","cookie","secret","credential","ssn_last4","personal_id_number","personal_address","carrier_license_number","business_tax_id","routing_number","account_number","gift_card_code","gift_card.code","MWSAuthToken","signedstring","access_token","access-token","accessToken","dob","email","emailUser","license_number"]})}function id(t){return t?t instanceof rd:!1}const Um=t=>["Sorry, this product is currently out of stock.","To continue, choose a lower quantity of items from this shop.","Sorry, the quantity selected exceeds what's available based on your current cart","Slow down there partner.","Error: discovery product not present","discovery product not present","product response not available from MedusaJS","Sorry, but we can't add more of this item to your cart. The current quantity is all we have in stock.","Server Error: Status 429 Too Many Requests. URL: https://shop-server.sfe.MedusaJSinternal.com/chat/message_web","Unauthorized: user needs to sign in before continuing"].includes(t)?!0:/(?:status code 429|429 too many requests)/i.test(t);ot.Client;const{APP_ENV:sd}=jr(),od="ErrorLogger";class ni{constructor(e=ot){this.bugsnag=e}notify(e,n={}){const r=ad(e),{severity:i,metadata:s,metadataKey:a=od}=n;if(sd==="development"){const c=console[i==="warning"?"warn":i??"error"];c("Would log to bugsnag:",r,n.metadata)}this.bugsnag.notify(r,c=>{i&&(c.severity=i),s&&c.addMetadata(a,s)})}static fromContext(e){const n=id(e)?e:ot;return new ni(n)}}function ad(t){return t instanceof Error||typeof t=="string"?t:typeof t=="object"?`Unknown error: ${JSON.stringify(t)}`:`Unknown error: ${t}`}const cd=new ni;var Rt;(function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"})(Rt||(Rt={}));var G;(function(t){t.COUNTER="COUNTER",t.GAUGE="GAUGE",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"})(G||(G={}));var ct;(function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"})(ct||(ct={}));function ud(t){return t!=null}function Io(t){let e=Object.keys(t);return e.length===0?"":(e=e.sort(),JSON.stringify(e.map(n=>[n,t[n]])))}function ld(t){return`${t.name}:${t.version??""}:${t.schemaUrl??""}`}let dd=class No extends Error{constructor(e){super(e),Object.setPrototypeOf(this,No.prototype)}};function _n(t,e){let n;const r=new Promise(function(s,a){n=setTimeout(function(){a(new dd("Operation timed out."))},e)});return Promise.race([t,r]).then(i=>(clearTimeout(n),i),i=>{throw clearTimeout(n),i})}async function hd(t){return Promise.all(t.map(async e=>{try{return{status:"fulfilled",value:await e}}catch(n){return{status:"rejected",reason:n}}}))}function fd(t){return t.status==="rejected"}function Ls(t,e){const n=[];return t.forEach(r=>{n.push(...e(r))}),n}function pd(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function _d(t,e){let n=0,r=t.length-1,i=t.length;for(;r>=n;){const s=n+Math.trunc((r-n)/2);t[s]<e?n=s+1:(i=s,r=s-1)}return i}function gd(t,e){return t.toLowerCase()===e.toLowerCase()}var Be;(function(t){t[t.DROP=0]="DROP",t[t.SUM=1]="SUM",t[t.LAST_VALUE=2]="LAST_VALUE",t[t.HISTOGRAM=3]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"})(Be||(Be={}));class md{constructor(){f(this,"kind",Be.DROP)}createAccumulation(){}merge(e,n){}diff(e,n){}toMetricData(e,n,r,i){}}function yd(t){const e=t.map(()=>0);return e.push(0),{buckets:{boundaries:t,counts:e},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}class or{constructor(e,n,r=!0,i=yd(n)){f(this,"startTime");f(this,"_boundaries");f(this,"_recordMinMax");f(this,"_current");this.startTime=e,this._boundaries=n,this._recordMinMax=r,this._current=i}record(e){if(Number.isNaN(e))return;this._current.count+=1,this._current.sum+=e,this._recordMinMax&&(this._current.min=Math.min(e,this._current.min),this._current.max=Math.max(e,this._current.max),this._current.hasMinMax=!0);const n=_d(this._boundaries,e);this._current.buckets.counts[n]+=1}setStartTime(e){this.startTime=e}toPointValue(){return this._current}}class ko{constructor(e,n){f(this,"_boundaries");f(this,"_recordMinMax");f(this,"kind",Be.HISTOGRAM);this._boundaries=e,this._recordMinMax=n}createAccumulation(e){return new or(e,this._boundaries,this._recordMinMax)}merge(e,n){const r=e.toPointValue(),i=n.toPointValue(),s=r.buckets.counts,a=i.buckets.counts,c=new Array(s.length);for(let m=0;m<s.length;m++)c[m]=s[m]+a[m];let h=1/0,p=-1/0;return this._recordMinMax&&(r.hasMinMax&&i.hasMinMax?(h=Math.min(r.min,i.min),p=Math.max(r.max,i.max)):r.hasMinMax?(h=r.min,p=r.max):i.hasMinMax&&(h=i.min,p=i.max)),new or(e.startTime,r.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:r.buckets.boundaries,counts:c},count:r.count+i.count,sum:r.sum+i.sum,hasMinMax:this._recordMinMax&&(r.hasMinMax||i.hasMinMax),min:h,max:p})}diff(e,n){const r=e.toPointValue(),i=n.toPointValue(),s=r.buckets.counts,a=i.buckets.counts,c=new Array(s.length);for(let h=0;h<s.length;h++)c[h]=a[h]-s[h];return new or(n.startTime,r.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:r.buckets.boundaries,counts:c},count:i.count-r.count,sum:i.sum-r.sum,hasMinMax:!1,min:1/0,max:-1/0})}toMetricData(e,n,r,i){return{descriptor:e,aggregationTemporality:n,dataPointType:ct.HISTOGRAM,dataPoints:r.map(([s,a])=>{const c=a.toPointValue(),h=e.type===G.GAUGE||e.type===G.UP_DOWN_COUNTER||e.type===G.OBSERVABLE_GAUGE||e.type===G.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:s,startTime:a.startTime,endTime:i,value:{min:c.hasMinMax?c.min:void 0,max:c.hasMinMax?c.max:void 0,sum:h?void 0:c.sum,buckets:c.buckets,count:c.count}}})}}}class gn{constructor(e=new ri,n=0,r=0,i=0){f(this,"backing");f(this,"indexBase");f(this,"indexStart");f(this,"indexEnd");this.backing=e,this.indexBase=n,this.indexStart=r,this.indexEnd=i}get offset(){return this.indexStart}get length(){return this.backing.length===0||this.indexEnd===this.indexStart&&this.at(0)===0?0:this.indexEnd-this.indexStart+1}counts(){return Array.from({length:this.length},(e,n)=>this.at(n))}at(e){const n=this.indexBase-this.indexStart;return e<n&&(e+=this.backing.length),e-=n,this.backing.countAt(e)}incrementBucket(e,n){this.backing.increment(e,n)}decrementBucket(e,n){this.backing.decrement(e,n)}trim(){for(let e=0;e<this.length;e++)if(this.at(e)!==0){this.indexStart+=e;break}else if(e===this.length-1){this.indexStart=this.indexEnd=this.indexBase=0;return}for(let e=this.length-1;e>=0;e--)if(this.at(e)!==0){this.indexEnd-=this.length-e-1;break}this._rotate()}downscale(e){this._rotate();const n=1+this.indexEnd-this.indexStart,r=1<<e;let i=0,s=0;for(let a=this.indexStart;a<=this.indexEnd;){let c=a%r;c<0&&(c+=r);for(let h=c;h<r&&i<n;h++)this._relocateBucket(s,i),i++,a++;s++}this.indexStart>>=e,this.indexEnd>>=e,this.indexBase=this.indexStart}clone(){return new gn(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)}_rotate(){const e=this.indexBase-this.indexStart;e!==0&&(e>0?(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,e),this.backing.reverse(e,this.backing.length)):(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+e)),this.indexBase=this.indexStart)}_relocateBucket(e,n){e!==n&&this.incrementBucket(e,this.backing.emptyBucket(n))}}class ri{constructor(e=[0]){f(this,"_counts");this._counts=e}get length(){return this._counts.length}countAt(e){return this._counts[e]}growTo(e,n,r){const i=new Array(e).fill(0);i.splice(r,this._counts.length-n,...this._counts.slice(n)),i.splice(0,n,...this._counts.slice(0,n)),this._counts=i}reverse(e,n){const r=Math.floor((e+n)/2)-e;for(let i=0;i<r;i++){const s=this._counts[e+i];this._counts[e+i]=this._counts[n-i-1],this._counts[n-i-1]=s}}emptyBucket(e){const n=this._counts[e];return this._counts[e]=0,n}increment(e,n){this._counts[e]+=n}decrement(e,n){this._counts[e]>=n?this._counts[e]-=n:this._counts[e]=0}clone(){return new ri([...this._counts])}}const vd=52,Sd=2146435072,bd=1048575,Uo=1023,Do=-1022,Bo=Uo,Ar=Math.pow(2,-1022);function $o(t){const e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,t),((e.getUint32(0)&Sd)>>20)-Uo}function Fo(t){const e=new DataView(new ArrayBuffer(8));e.setFloat64(0,t);const n=e.getUint32(0),r=e.getUint32(4);return(n&bd)*Math.pow(2,32)+r}function Cr(t,e){return t===0||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY||Number.isNaN(t)?t:t*Math.pow(2,e)}function Ed(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}class Lt extends Error{}class wd{constructor(e){f(this,"_shift");this._shift=-e}mapToIndex(e){if(e<Ar)return this._minNormalLowerBoundaryIndex();const n=$o(e),r=this._rightShift(Fo(e)-1,vd);return n+r>>this._shift}lowerBoundary(e){const n=this._minNormalLowerBoundaryIndex();if(e<n)throw new Lt(`underflow: ${e} is < minimum lower boundary: ${n}`);const r=this._maxNormalLowerBoundaryIndex();if(e>r)throw new Lt(`overflow: ${e} is > maximum lower boundary: ${r}`);return Cr(1,e<<this._shift)}get scale(){return this._shift===0?0:-this._shift}_minNormalLowerBoundaryIndex(){let e=Do>>this._shift;return this._shift<2&&e--,e}_maxNormalLowerBoundaryIndex(){return Bo>>this._shift}_rightShift(e,n){return Math.floor(e*Math.pow(2,-n))}}class Td{constructor(e){f(this,"_scale");f(this,"_scaleFactor");f(this,"_inverseFactor");this._scale=e,this._scaleFactor=Cr(Math.LOG2E,e),this._inverseFactor=Cr(Math.LN2,-e)}mapToIndex(e){if(e<=Ar)return this._minNormalLowerBoundaryIndex()-1;if(Fo(e)===0)return($o(e)<<this._scale)-1;const n=Math.floor(Math.log(e)*this._scaleFactor),r=this._maxNormalLowerBoundaryIndex();return n>=r?r:n}lowerBoundary(e){const n=this._maxNormalLowerBoundaryIndex();if(e>=n){if(e===n)return 2*Math.exp((e-(1<<this._scale))/this._scaleFactor);throw new Lt(`overflow: ${e} is > maximum lower boundary: ${n}`)}const r=this._minNormalLowerBoundaryIndex();if(e<=r){if(e===r)return Ar;if(e===r-1)return Math.exp((e+(1<<this._scale))/this._scaleFactor)/2;throw new Lt(`overflow: ${e} is < minimum lower boundary: ${r}`)}return Math.exp(e*this._inverseFactor)}get scale(){return this._scale}_minNormalLowerBoundaryIndex(){return Do<<this._scale}_maxNormalLowerBoundaryIndex(){return(Bo+1<<this._scale)-1}}const Ms=-10,Ps=20,Ad=Array.from({length:31},(t,e)=>e>10?new Td(e-10):new wd(e-10));function Is(t){if(t>Ps||t<Ms)throw new Lt(`expected scale >= ${Ms} && <= ${Ps}, got: ${t}`);return Ad[t+10]}class Je{constructor(e,n){f(this,"low");f(this,"high");this.low=e,this.high=n}static combine(e,n){return new Je(Math.min(e.low,n.low),Math.max(e.high,n.high))}}const Cd=20,Od=160,ar=2;class ii{constructor(e=e,n=Od,r=!0,i=0,s=0,a=0,c=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,p=new gn,m=new gn,v=Is(Cd)){f(this,"startTime");f(this,"_maxSize");f(this,"_recordMinMax");f(this,"_sum");f(this,"_count");f(this,"_zeroCount");f(this,"_min");f(this,"_max");f(this,"_positive");f(this,"_negative");f(this,"_mapping");this.startTime=e,this._maxSize=n,this._recordMinMax=r,this._sum=i,this._count=s,this._zeroCount=a,this._min=c,this._max=h,this._positive=p,this._negative=m,this._mapping=v,this._maxSize<ar&&(C.warn(`Exponential Histogram Max Size set to ${this._maxSize},                 changing to the minimum size of: ${ar}`),this._maxSize=ar)}record(e){this.updateByIncrement(e,1)}setStartTime(e){this.startTime=e}toPointValue(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}}get sum(){return this._sum}get min(){return this._min}get max(){return this._max}get count(){return this._count}get zeroCount(){return this._zeroCount}get scale(){return this._count===this._zeroCount?0:this._mapping.scale}get positive(){return this._positive}get negative(){return this._negative}updateByIncrement(e,n){if(!Number.isNaN(e)){if(e>this._max&&(this._max=e),e<this._min&&(this._min=e),this._count+=n,e===0){this._zeroCount+=n;return}this._sum+=e*n,e>0?this._updateBuckets(this._positive,e,n):this._updateBuckets(this._negative,-e,n)}}merge(e){this._count===0?(this._min=e.min,this._max=e.max):e.count!==0&&(e.min<this.min&&(this._min=e.min),e.max>this.max&&(this._max=e.max)),this.startTime=e.startTime,this._sum+=e.sum,this._count+=e.count,this._zeroCount+=e.zeroCount;const n=this._minScale(e);this._downscale(this.scale-n),this._mergeBuckets(this.positive,e,e.positive,n),this._mergeBuckets(this.negative,e,e.negative,n)}diff(e){this._min=1/0,this._max=-1/0,this._sum-=e.sum,this._count-=e.count,this._zeroCount-=e.zeroCount;const n=this._minScale(e);this._downscale(this.scale-n),this._diffBuckets(this.positive,e,e.positive,n),this._diffBuckets(this.negative,e,e.negative,n)}clone(){return new ii(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)}_updateBuckets(e,n,r){let i=this._mapping.mapToIndex(n),s=!1,a=0,c=0;if(e.length===0?(e.indexStart=i,e.indexEnd=e.indexStart,e.indexBase=e.indexStart):i<e.indexStart&&e.indexEnd-i>=this._maxSize?(s=!0,c=i,a=e.indexEnd):i>e.indexEnd&&i-e.indexStart>=this._maxSize&&(s=!0,c=e.indexStart,a=i),s){const h=this._changeScale(a,c);this._downscale(h),i=this._mapping.mapToIndex(n)}this._incrementIndexBy(e,i,r)}_incrementIndexBy(e,n,r){if(r===0)return;if(e.length===0&&(e.indexStart=e.indexEnd=e.indexBase=n),n<e.indexStart){const s=e.indexEnd-n;s>=e.backing.length&&this._grow(e,s+1),e.indexStart=n}else if(n>e.indexEnd){const s=n-e.indexStart;s>=e.backing.length&&this._grow(e,s+1),e.indexEnd=n}let i=n-e.indexBase;i<0&&(i+=e.backing.length),e.incrementBucket(i,r)}_grow(e,n){const r=e.backing.length,i=e.indexBase-e.indexStart,s=r-i;let a=Ed(n);a>this._maxSize&&(a=this._maxSize);const c=a-i;e.backing.growTo(a,s,c)}_changeScale(e,n){let r=0;for(;e-n>=this._maxSize;)e>>=1,n>>=1,r++;return r}_downscale(e){if(e===0)return;if(e<0)throw new Error(`impossible change of scale: ${this.scale}`);const n=this._mapping.scale-e;this._positive.downscale(e),this._negative.downscale(e),this._mapping=Is(n)}_minScale(e){const n=Math.min(this.scale,e.scale),r=Je.combine(this._highLowAtScale(this.positive,this.scale,n),this._highLowAtScale(e.positive,e.scale,n)),i=Je.combine(this._highLowAtScale(this.negative,this.scale,n),this._highLowAtScale(e.negative,e.scale,n));return Math.min(n-this._changeScale(r.high,r.low),n-this._changeScale(i.high,i.low))}_highLowAtScale(e,n,r){if(e.length===0)return new Je(0,-1);const i=n-r;return new Je(e.indexStart>>i,e.indexEnd>>i)}_mergeBuckets(e,n,r,i){const s=r.offset,a=n.scale-i;for(let c=0;c<r.length;c++)this._incrementIndexBy(e,s+c>>a,r.at(c))}_diffBuckets(e,n,r,i){const s=r.offset,a=n.scale-i;for(let c=0;c<r.length;c++){let p=(s+c>>a)-e.indexBase;p<0&&(p+=e.backing.length),e.decrementBucket(p,r.at(c))}e.trim()}}class xd{constructor(e,n){f(this,"_maxSize");f(this,"_recordMinMax");f(this,"kind",Be.EXPONENTIAL_HISTOGRAM);this._maxSize=e,this._recordMinMax=n}createAccumulation(e){return new ii(e,this._maxSize,this._recordMinMax)}merge(e,n){const r=n.clone();return r.merge(e),r}diff(e,n){const r=n.clone();return r.diff(e),r}toMetricData(e,n,r,i){return{descriptor:e,aggregationTemporality:n,dataPointType:ct.EXPONENTIAL_HISTOGRAM,dataPoints:r.map(([s,a])=>{const c=a.toPointValue(),h=e.type===G.GAUGE||e.type===G.UP_DOWN_COUNTER||e.type===G.OBSERVABLE_GAUGE||e.type===G.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:s,startTime:a.startTime,endTime:i,value:{min:c.hasMinMax?c.min:void 0,max:c.hasMinMax?c.max:void 0,sum:h?void 0:c.sum,positive:{offset:c.positive.offset,bucketCounts:c.positive.bucketCounts},negative:{offset:c.negative.offset,bucketCounts:c.negative.bucketCounts},count:c.count,scale:c.scale,zeroCount:c.zeroCount}}})}}}const Ho=ho("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Vo(t){return t.setValue(Ho,!0)}function si(t){return t.getValue(Ho)===!0}const Rd="=",Or=";",xr=",",cr="baggage",Ld=180,Md=4096,Pd=8192;function Id(t){return t.reduce((e,n)=>{const r=`${e}${e!==""?xr:""}${n}`;return r.length>Pd?e:r},"")}function Nd(t){return t.getAllEntries().map(([e,n])=>{let r=`${encodeURIComponent(e)}=${encodeURIComponent(n.value)}`;return n.metadata!==void 0&&(r+=Or+n.metadata.toString()),r})}function kd(t){const e=t.split(Or);if(e.length<=0)return;const n=e.shift();if(!n)return;const r=n.indexOf(Rd);if(r<=0)return;const i=decodeURIComponent(n.substring(0,r).trim()),s=decodeURIComponent(n.substring(r+1).trim());let a;return e.length>0&&(a=qc(e.join(Or))),{key:i,value:s,metadata:a}}class Ud{inject(e,n,r){const i=ue.getBaggage(e);if(!i||si(e))return;const s=Nd(i).filter(c=>c.length<=Md).slice(0,Ld),a=Id(s);a.length>0&&r.set(n,cr,a)}extract(e,n,r){const i=r.get(n,cr),s=Array.isArray(i)?i.join(xr):i;if(!s)return e;const a={};return s.length===0||(s.split(xr).forEach(h=>{const p=kd(h);if(p){const m={value:p.value};p.metadata&&(m.metadata=p.metadata),a[p.key]=m}}),Object.entries(a).length===0)?e:ue.setBaggage(e,ue.createBaggage(a))}fields(){return[cr]}}function cn(t){const e={};if(typeof t!="object"||t==null)return e;for(const[n,r]of Object.entries(t)){if(!Dd(n)){C.warn(`Invalid attribute key: ${n}`);continue}if(!Go(r)){C.warn(`Invalid attribute value set for key: ${n}`);continue}Array.isArray(r)?e[n]=r.slice():e[n]=r}return e}function Dd(t){return typeof t=="string"&&t.length>0}function Go(t){return t==null?!0:Array.isArray(t)?Bd(t):jo(t)}function Bd(t){let e;for(const n of t)if(n!=null){if(!e){if(jo(n)){e=typeof n;continue}return!1}if(typeof n!==e)return!1}return!0}function jo(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}function $d(){return t=>{C.error(Fd(t))}}function Fd(t){return typeof t=="string"?t:JSON.stringify(Hd(t))}function Hd(t){const e={};let n=t;for(;n!==null;)Object.getOwnPropertyNames(n).forEach(r=>{if(e[r])return;const i=n[r];i&&(e[r]=String(i))}),n=Object.getPrototypeOf(n);return e}let Vd=$d();function $e(t){try{Vd(t)}catch{}}const tt=performance,Gd="2.0.1",jd="http.method",zd="http.url",qd="http.host",Xd="http.scheme",Kd="http.status_code",Wd="http.user_agent",Yd="http.request_content_length_uncompressed",Jd="http.response_content_length",Qd="http.response_content_length_uncompressed",Zd=jd,eh=zd,th=qd,nh=Xd,rh=Kd,ih=Wd,sh=Yd,oh=Jd,ah=Qd,ch="process.runtime.name",uh="telemetry.sdk.name",lh="telemetry.sdk.language",dh="telemetry.sdk.version",hh=ch,fh=uh,ph=lh,_h=dh,gh="webjs",mh=gh,ur="exception.message",yh="exception.stacktrace",lr="exception.type",zo="service.name",Mt="telemetry.sdk.language",vh="webjs",Pt="telemetry.sdk.name",It="telemetry.sdk.version",Sh="process.runtime.name",dr={[Pt]:"opentelemetry",[Sh]:"browser",[Mt]:vh,[It]:Gd};const bh=9,Eh=6,wh=Math.pow(10,Eh),Rr=Math.pow(10,bh);function ge(t){const e=t/1e3,n=Math.trunc(e),r=Math.round(t%1e3*wh);return[n,r]}function qo(){let t=tt.timeOrigin;if(typeof t!="number"){const e=tt;t=e.timing&&e.timing.fetchStart}return t}function Th(t){const e=ge(qo()),n=ge(typeof t=="number"?t:tt.now());return Ko(e,n)}function Ah(t,e){let n=e[0]-t[0],r=e[1]-t[1];return r<0&&(n-=1,r+=Rr),[n,r]}function Qe(t){return t[0]*1e6+t[1]/1e3}function Xo(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function Ns(t){return Xo(t)||typeof t=="number"||t instanceof Date}function Ko(t,e){const n=[t[0]+e[0],t[1]+e[1]];return n[1]>=Rr&&(n[1]-=Rr,n[0]+=1),n}var Ee;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(Ee||(Ee={}));class Ch{constructor(e={}){f(this,"_propagators");f(this,"_fields");this._propagators=e.propagators??[],this._fields=Array.from(new Set(this._propagators.map(n=>typeof n.fields=="function"?n.fields():[]).reduce((n,r)=>n.concat(r),[])))}inject(e,n,r){for(const i of this._propagators)try{i.inject(e,n,r)}catch(s){C.warn(`Failed to inject with ${i.constructor.name}. Err: ${s.message}`)}}extract(e,n,r){return this._propagators.reduce((i,s)=>{try{return s.extract(i,n,r)}catch(a){C.warn(`Failed to extract with ${s.constructor.name}. Err: ${a.message}`)}return i},e)}fields(){return this._fields.slice()}}const Lr="[_0-9a-z-*/]",Oh=`[a-z]${Lr}{0,255}`,xh=`[a-z0-9]${Lr}{0,240}@[a-z]${Lr}{0,13}`,Rh=new RegExp(`^(?:${Oh}|${xh})$`),Lh=/^[ -~]{0,255}[!-~]$/,Mh=/,|=/;function Ph(t){return Rh.test(t)}function Ih(t){return Lh.test(t)&&!Mh.test(t)}const ks=32,Nh=512,Us=",",Ds="=";class oi{constructor(e){f(this,"_internalState",new Map);e&&this._parse(e)}set(e,n){const r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,n),r}unset(e){const n=this._clone();return n._internalState.delete(e),n}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,n)=>(e.push(n+Ds+this.get(n)),e),[]).join(Us)}_parse(e){e.length>Nh||(this._internalState=e.split(Us).reverse().reduce((n,r)=>{const i=r.trim(),s=i.indexOf(Ds);if(s!==-1){const a=i.slice(0,s),c=i.slice(s+1,r.length);Ph(a)&&Ih(c)&&n.set(a,c)}return n},new Map),this._internalState.size>ks&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,ks))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const e=new oi;return e._internalState=new Map(this._internalState),e}}const hr="traceparent",fr="tracestate",kh="00",Uh="(?!ff)[\\da-f]{2}",Dh="(?![0]{32})[\\da-f]{32}",Bh="(?![0]{16})[\\da-f]{16}",$h="[\\da-f]{2}",Fh=new RegExp(`^\\s?(${Uh})-(${Dh})-(${Bh})-(${$h})(-.*)?\\s?$`);function Hh(t){const e=Fh.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}class Vh{inject(e,n,r){const i=se.getSpanContext(e);if(!i||si(e)||!zr(i))return;const s=`${kh}-${i.traceId}-${i.spanId}-0${Number(i.traceFlags||Ne.NONE).toString(16)}`;r.set(n,hr,s),i.traceState&&r.set(n,fr,i.traceState.serialize())}extract(e,n,r){const i=r.get(n,hr);if(!i)return e;const s=Array.isArray(i)?i[0]:i;if(typeof s!="string")return e;const a=Hh(s);if(!a)return e;a.isRemote=!0;const c=r.get(n,fr);if(c){const h=Array.isArray(c)?c.join(","):c;a.traceState=new oi(typeof h=="string"?h:void 0)}return se.setSpanContext(e,a)}fields(){return[hr,fr]}}const Gh="[object Object]",jh="[object Null]",zh="[object Undefined]",qh=Function.prototype,Wo=qh.toString,Xh=Wo.call(Object),Kh=Object.getPrototypeOf,Yo=Object.prototype,Jo=Yo.hasOwnProperty,Ce=Symbol?Symbol.toStringTag:void 0,Qo=Yo.toString;function Bs(t){if(!Wh(t)||Yh(t)!==Gh)return!1;const e=Kh(t);if(e===null)return!0;const n=Jo.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Wo.call(n)===Xh}function Wh(t){return t!=null&&typeof t=="object"}function Yh(t){return t==null?t===void 0?zh:jh:Ce&&Ce in Object(t)?Jh(t):Qh(t)}function Jh(t){const e=Jo.call(t,Ce),n=t[Ce];let r=!1;try{t[Ce]=void 0,r=!0}catch{}const i=Qo.call(t);return r&&(e?t[Ce]=n:delete t[Ce]),i}function Qh(t){return Qo.call(t)}const Zh=20;function ef(...t){let e=t.shift();const n=new WeakMap;for(;t.length>0;)e=Zo(e,t.shift(),0,n);return e}function pr(t){return mn(t)?t.slice():t}function Zo(t,e,n=0,r){let i;if(!(n>Zh)){if(n++,un(t)||un(e)||ea(e))i=pr(e);else if(mn(t)){if(i=t.slice(),mn(e))for(let s=0,a=e.length;s<a;s++)i.push(pr(e[s]));else if(yt(e)){const s=Object.keys(e);for(let a=0,c=s.length;a<c;a++){const h=s[a];i[h]=pr(e[h])}}}else if(yt(t))if(yt(e)){if(!tf(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let a=0,c=s.length;a<c;a++){const h=s[a],p=e[h];if(un(p))typeof p>"u"?delete i[h]:i[h]=p;else{const m=i[h],v=p;if($s(t,h,r)||$s(e,h,r))delete i[h];else{if(yt(m)&&yt(v)){const S=r.get(m)||[],w=r.get(v)||[];S.push({obj:t,key:h}),w.push({obj:e,key:h}),r.set(m,S),r.set(v,w)}i[h]=Zo(i[h],p,n,r)}}}}else i=e;return i}}function $s(t,e,n){const r=n.get(t[e])||[];for(let i=0,s=r.length;i<s;i++){const a=r[i];if(a.key===e&&a.obj===t)return!0}return!1}function mn(t){return Array.isArray(t)}function ea(t){return typeof t=="function"}function yt(t){return!un(t)&&!mn(t)&&!ea(t)&&typeof t=="object"}function un(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function tf(t,e){return!(!Bs(t)||!Bs(e))}let nf=class{constructor(){f(this,"_promise");f(this,"_resolve");f(this,"_reject");this._promise=new Promise((e,n)=>{this._resolve=e,this._reject=n})}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}},ta=class{constructor(e,n){f(this,"_callback");f(this,"_that");f(this,"_isCalled",!1);f(this,"_deferred",new nf);this._callback=e,this._that=n}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then(n=>this._deferred.resolve(n),n=>this._deferred.reject(n))}catch(n){this._deferred.reject(n)}}return this._deferred.promise}};function rf(t,e){return new Promise(n=>{K.with(Vo(K.active()),()=>{t.export(e,r=>{n(r)})})})}const sf={_export:rf};class _r{constructor(e,n=0,r=[0,0]){f(this,"startTime");f(this,"_current");f(this,"sampleTime");this.startTime=e,this._current=n,this.sampleTime=r}record(e){this._current=e,this.sampleTime=ge(Date.now())}setStartTime(e){this.startTime=e}toPointValue(){return this._current}}class of{constructor(){f(this,"kind",Be.LAST_VALUE)}createAccumulation(e){return new _r(e)}merge(e,n){const r=Qe(n.sampleTime)>=Qe(e.sampleTime)?n:e;return new _r(e.startTime,r.toPointValue(),r.sampleTime)}diff(e,n){const r=Qe(n.sampleTime)>=Qe(e.sampleTime)?n:e;return new _r(n.startTime,r.toPointValue(),r.sampleTime)}toMetricData(e,n,r,i){return{descriptor:e,aggregationTemporality:n,dataPointType:ct.GAUGE,dataPoints:r.map(([s,a])=>({attributes:s,startTime:a.startTime,endTime:i,value:a.toPointValue()}))}}}class vt{constructor(e,n,r=0,i=!1){f(this,"startTime");f(this,"monotonic");f(this,"_current");f(this,"reset");this.startTime=e,this.monotonic=n,this._current=r,this.reset=i}record(e){this.monotonic&&e<0||(this._current+=e)}setStartTime(e){this.startTime=e}toPointValue(){return this._current}}class Fs{constructor(e){f(this,"monotonic");f(this,"kind",Be.SUM);this.monotonic=e}createAccumulation(e){return new vt(e,this.monotonic)}merge(e,n){const r=e.toPointValue(),i=n.toPointValue();return n.reset?new vt(n.startTime,this.monotonic,i,n.reset):new vt(e.startTime,this.monotonic,r+i)}diff(e,n){const r=e.toPointValue(),i=n.toPointValue();return this.monotonic&&r>i?new vt(n.startTime,this.monotonic,i,!0):new vt(n.startTime,this.monotonic,i-r)}toMetricData(e,n,r,i){return{descriptor:e,aggregationTemporality:n,dataPointType:ct.SUM,dataPoints:r.map(([s,a])=>({attributes:s,startTime:a.startTime,endTime:i,value:a.toPointValue()})),isMonotonic:this.monotonic}}}const An=class An{createAggregator(e){return An.DEFAULT_INSTANCE}};f(An,"DEFAULT_INSTANCE",new md);let Mr=An;const et=class et{createAggregator(e){switch(e.type){case G.COUNTER:case G.OBSERVABLE_COUNTER:case G.HISTOGRAM:return et.MONOTONIC_INSTANCE;default:return et.NON_MONOTONIC_INSTANCE}}};f(et,"MONOTONIC_INSTANCE",new Fs(!0)),f(et,"NON_MONOTONIC_INSTANCE",new Fs(!1));let Pr=et;const Cn=class Cn{createAggregator(e){return Cn.DEFAULT_INSTANCE}};f(Cn,"DEFAULT_INSTANCE",new of);let Ir=Cn;const On=class On{createAggregator(e){return On.DEFAULT_INSTANCE}};f(On,"DEFAULT_INSTANCE",new ko([0,5,10,25,50,75,100,250,500,750,1e3,2500,5e3,7500,1e4],!0));let Nr=On;class na{constructor(e,n=!0){f(this,"_recordMinMax");f(this,"_boundaries");if(this._recordMinMax=n,e==null)throw new Error("ExplicitBucketHistogramAggregation should be created with explicit boundaries, if a single bucket histogram is required, please pass an empty array");e=e.concat(),e=e.sort((s,a)=>s-a);const r=e.lastIndexOf(-1/0);let i=e.indexOf(1/0);i===-1&&(i=void 0),this._boundaries=e.slice(r+1,i)}createAggregator(e){return new ko(this._boundaries,this._recordMinMax)}}class af{constructor(e=160,n=!0){f(this,"_maxSize");f(this,"_recordMinMax");this._maxSize=e,this._recordMinMax=n}createAggregator(e){return new xd(this._maxSize,this._recordMinMax)}}class cf{_resolve(e){switch(e.type){case G.COUNTER:case G.UP_DOWN_COUNTER:case G.OBSERVABLE_COUNTER:case G.OBSERVABLE_UP_DOWN_COUNTER:return ia;case G.GAUGE:case G.OBSERVABLE_GAUGE:return sa;case G.HISTOGRAM:return e.advice.explicitBucketBoundaries?new na(e.advice.explicitBucketBoundaries):oa}return C.warn(`Unable to recognize instrument type: ${e.type}`),ra}createAggregator(e){return this._resolve(e).createAggregator(e)}}const ra=new Mr,ia=new Pr,sa=new Ir,oa=new Nr,uf=new cf;var ce;(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DROP=1]="DROP",t[t.SUM=2]="SUM",t[t.LAST_VALUE=3]="LAST_VALUE",t[t.EXPLICIT_BUCKET_HISTOGRAM=4]="EXPLICIT_BUCKET_HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=5]="EXPONENTIAL_HISTOGRAM"})(ce||(ce={}));function aa(t){var e,n,r,i;switch(t.type){case ce.DEFAULT:return uf;case ce.DROP:return ra;case ce.SUM:return ia;case ce.LAST_VALUE:return sa;case ce.EXPONENTIAL_HISTOGRAM:{const s=t;return new af((e=s.options)==null?void 0:e.maxSize,(n=s.options)==null?void 0:n.recordMinMax)}case ce.EXPLICIT_BUCKET_HISTOGRAM:{const s=t;return s.options==null?oa:new na((r=s.options)==null?void 0:r.boundaries,(i=s.options)==null?void 0:i.recordMinMax)}default:throw new Error("Unsupported Aggregation")}}const lf=t=>({type:ce.DEFAULT}),ca=t=>Rt.CUMULATIVE;class df{constructor(e){f(this,"_shutdown",!1);f(this,"_metricProducers");f(this,"_sdkMetricProducer");f(this,"_aggregationTemporalitySelector");f(this,"_aggregationSelector");f(this,"_cardinalitySelector");this._aggregationSelector=(e==null?void 0:e.aggregationSelector)??lf,this._aggregationTemporalitySelector=(e==null?void 0:e.aggregationTemporalitySelector)??ca,this._metricProducers=(e==null?void 0:e.metricProducers)??[],this._cardinalitySelector=e==null?void 0:e.cardinalitySelector}setMetricProducer(e){if(this._sdkMetricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=e,this.onInitialized()}selectAggregation(e){return this._aggregationSelector(e)}selectAggregationTemporality(e){return this._aggregationTemporalitySelector(e)}selectCardinalityLimit(e){return this._cardinalitySelector?this._cardinalitySelector(e):2e3}onInitialized(){}async collect(e){if(this._sdkMetricProducer===void 0)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");const[n,...r]=await Promise.all([this._sdkMetricProducer.collect({timeoutMillis:e==null?void 0:e.timeoutMillis}),...this._metricProducers.map(c=>c.collect({timeoutMillis:e==null?void 0:e.timeoutMillis}))]),i=n.errors.concat(Ls(r,c=>c.errors)),s=n.resourceMetrics.resource,a=n.resourceMetrics.scopeMetrics.concat(Ls(r,c=>c.resourceMetrics.scopeMetrics));return{resourceMetrics:{resource:s,scopeMetrics:a},errors:i}}async shutdown(e){if(this._shutdown){C.error("Cannot call shutdown twice.");return}(e==null?void 0:e.timeoutMillis)==null?await this.onShutdown():await _n(this.onShutdown(),e.timeoutMillis),this._shutdown=!0}async forceFlush(e){if(this._shutdown){C.warn("Cannot forceFlush on already shutdown MetricReader.");return}if((e==null?void 0:e.timeoutMillis)==null){await this.onForceFlush();return}await _n(this.onForceFlush(),e.timeoutMillis)}}class ai{constructor(e){f(this,"_shutdown",!1);f(this,"_temporalitySelector");this._temporalitySelector=(e==null?void 0:e.temporalitySelector)??ca}export(e,n){if(this._shutdown){setImmediate(n,{code:Ee.FAILED});return}return ai._sendMetrics(e,n)}forceFlush(){return Promise.resolve()}selectAggregationTemporality(e){return this._temporalitySelector(e)}shutdown(){return this._shutdown=!0,Promise.resolve()}static _sendMetrics(e,n){for(const r of e.scopeMetrics)for(const i of r.metrics)console.dir({descriptor:i.descriptor,dataPointType:i.dataPointType,dataPoints:i.dataPoints},{depth:null});n({code:Ee.SUCCESS})}}function hf(){return"unknown_service"}const At=t=>t!==null&&typeof t=="object"&&typeof t.then=="function";let ff=class kr{constructor(e){f(this,"_rawAttributes");f(this,"_asyncAttributesPending",!1);f(this,"_memoizedAttributes");const n=e.attributes??{};this._rawAttributes=Object.entries(n).map(([r,i])=>(At(i)&&(this._asyncAttributesPending=!0),[r,i])),this._rawAttributes=Hs(this._rawAttributes)}static FromAttributeList(e){const n=new kr({});return n._rawAttributes=Hs(e),n._asyncAttributesPending=e.filter(([r,i])=>At(i)).length>0,n}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let e=0;e<this._rawAttributes.length;e++){const[n,r]=this._rawAttributes[e];this._rawAttributes[e]=[n,At(r)?await r:r]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&C.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const e={};for(const[n,r]of this._rawAttributes){if(At(r)){C.debug(`Unsettled resource attribute ${n} skipped`);continue}r!=null&&(e[n]??(e[n]=r))}return this._asyncAttributesPending||(this._memoizedAttributes=e),e}getRawAttributes(){return this._rawAttributes}merge(e){return e==null?this:kr.FromAttributeList([...e.getRawAttributes(),...this.getRawAttributes()])}};function Mn(t){return ff.FromAttributeList(Object.entries(t))}function ua(){return Mn({[zo]:hf(),[Mt]:dr[Mt],[Pt]:dr[Pt],[It]:dr[It]})}function Hs(t){return t.map(([e,n])=>At(n)?[e,n.catch(r=>{C.debug("promise rejection for resource attribute: %s - %s",e,r)})]:[e,n])}class pf{constructor(){f(this,"_registeredViews",[])}addView(e){this._registeredViews.push(e)}findViews(e,n){return this._registeredViews.filter(i=>this._matchInstrument(i.instrumentSelector,e)&&this._matchMeter(i.meterSelector,n))}_matchInstrument(e,n){return(e.getType()===void 0||n.type===e.getType())&&e.getNameFilter().match(n.name)&&e.getUnitFilter().match(n.unit)}_matchMeter(e,n){return e.getNameFilter().match(n.name)&&(n.version===void 0||e.getVersionFilter().match(n.version))&&(n.schemaUrl===void 0||e.getSchemaUrlFilter().match(n.schemaUrl))}}function be(t,e,n){return yf(t)||C.warn(`Invalid metric name: "${t}". The metric name should be a ASCII string with a length no greater than 255 characters.`),{name:t,type:e,description:(n==null?void 0:n.description)??"",unit:(n==null?void 0:n.unit)??"",valueType:(n==null?void 0:n.valueType)??st.DOUBLE,advice:(n==null?void 0:n.advice)??{}}}function _f(t,e){return{name:t.name??e.name,description:t.description??e.description,type:e.type,unit:e.unit,valueType:e.valueType,advice:e.advice}}function gf(t,e){return gd(t.name,e.name)&&t.unit===e.unit&&t.type===e.type&&t.valueType===e.valueType}const mf=/^[a-z][a-z0-9_.\-/]{0,254}$/i;function yf(t){return t.match(mf)!=null}class Pn{constructor(e,n){f(this,"_writableMetricStorage");f(this,"_descriptor");this._writableMetricStorage=e,this._descriptor=n}_record(e,n={},r=K.active()){if(typeof e!="number"){C.warn(`non-number value provided to metric ${this._descriptor.name}: ${e}`);return}this._descriptor.valueType===st.INT&&!Number.isInteger(e)&&(C.warn(`INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`),e=Math.trunc(e),!Number.isInteger(e))||this._writableMetricStorage.record(e,n,r,ge(Date.now()))}}class vf extends Pn{add(e,n,r){this._record(e,n,r)}}class Sf extends Pn{add(e,n,r){if(e<0){C.warn(`negative value provided to counter ${this._descriptor.name}: ${e}`);return}this._record(e,n,r)}}class bf extends Pn{record(e,n,r){this._record(e,n,r)}}class Ef extends Pn{record(e,n,r){if(e<0){C.warn(`negative value provided to histogram ${this._descriptor.name}: ${e}`);return}this._record(e,n,r)}}class In{constructor(e,n,r){f(this,"_observableRegistry");f(this,"_metricStorages");f(this,"_descriptor");this._observableRegistry=r,this._descriptor=e,this._metricStorages=n}addCallback(e){this._observableRegistry.addCallback(e,this)}removeCallback(e){this._observableRegistry.removeCallback(e,this)}}class wf extends In{}class Tf extends In{}class Af extends In{}function Ur(t){return t instanceof In}class Cf{constructor(e){f(this,"_meterSharedState");this._meterSharedState=e}createGauge(e,n){const r=be(e,G.GAUGE,n),i=this._meterSharedState.registerMetricStorage(r);return new bf(i,r)}createHistogram(e,n){const r=be(e,G.HISTOGRAM,n),i=this._meterSharedState.registerMetricStorage(r);return new Ef(i,r)}createCounter(e,n){const r=be(e,G.COUNTER,n),i=this._meterSharedState.registerMetricStorage(r);return new Sf(i,r)}createUpDownCounter(e,n){const r=be(e,G.UP_DOWN_COUNTER,n),i=this._meterSharedState.registerMetricStorage(r);return new vf(i,r)}createObservableGauge(e,n){const r=be(e,G.OBSERVABLE_GAUGE,n),i=this._meterSharedState.registerAsyncMetricStorage(r);return new Tf(r,i,this._meterSharedState.observableRegistry)}createObservableCounter(e,n){const r=be(e,G.OBSERVABLE_COUNTER,n),i=this._meterSharedState.registerAsyncMetricStorage(r);return new wf(r,i,this._meterSharedState.observableRegistry)}createObservableUpDownCounter(e,n){const r=be(e,G.OBSERVABLE_UP_DOWN_COUNTER,n),i=this._meterSharedState.registerAsyncMetricStorage(r);return new Af(r,i,this._meterSharedState.observableRegistry)}addBatchObservableCallback(e,n){this._meterSharedState.observableRegistry.addBatchCallback(e,n)}removeBatchObservableCallback(e,n){this._meterSharedState.observableRegistry.removeBatchCallback(e,n)}}class la{constructor(e){f(this,"_instrumentDescriptor");this._instrumentDescriptor=e}getInstrumentDescriptor(){return this._instrumentDescriptor}updateDescription(e){this._instrumentDescriptor=be(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:e,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit,advice:this._instrumentDescriptor.advice})}}class Of{constructor(e){f(this,"_hash");f(this,"_valueMap",new Map);f(this,"_keyMap",new Map);this._hash=e}get(e,n){return n??(n=this._hash(e)),this._valueMap.get(n)}getOrDefault(e,n){const r=this._hash(e);if(this._valueMap.has(r))return this._valueMap.get(r);const i=n();return this._keyMap.has(r)||this._keyMap.set(r,e),this._valueMap.set(r,i),i}set(e,n,r){r??(r=this._hash(e)),this._keyMap.has(r)||this._keyMap.set(r,e),this._valueMap.set(r,n)}has(e,n){return n??(n=this._hash(e)),this._valueMap.has(n)}*keys(){const e=this._keyMap.entries();let n=e.next();for(;n.done!==!0;)yield[n.value[1],n.value[0]],n=e.next()}*entries(){const e=this._valueMap.entries();let n=e.next();for(;n.done!==!0;)yield[this._keyMap.get(n.value[0]),n.value[1],n.value[0]],n=e.next()}get size(){return this._valueMap.size}}class Pe extends Of{constructor(){super(Io)}}class da{constructor(e,n){f(this,"_aggregator");f(this,"_activeCollectionStorage",new Pe);f(this,"_cumulativeMemoStorage",new Pe);f(this,"_cardinalityLimit");f(this,"_overflowAttributes",{"otel.metric.overflow":!0});f(this,"_overflowHashCode");this._aggregator=e,this._cardinalityLimit=(n??2e3)-1,this._overflowHashCode=Io(this._overflowAttributes)}record(e,n,r,i){let s=this._activeCollectionStorage.get(n);if(!s){if(this._activeCollectionStorage.size>=this._cardinalityLimit){const a=this._activeCollectionStorage.getOrDefault(this._overflowAttributes,()=>this._aggregator.createAccumulation(i));a==null||a.record(e);return}s=this._aggregator.createAccumulation(i),this._activeCollectionStorage.set(n,s)}s==null||s.record(e)}batchCumulate(e,n){Array.from(e.entries()).forEach(([r,i,s])=>{const a=this._aggregator.createAccumulation(n);a==null||a.record(i);let c=a;if(this._cumulativeMemoStorage.has(r,s)){const h=this._cumulativeMemoStorage.get(r,s);c=this._aggregator.diff(h,a)}else if(this._cumulativeMemoStorage.size>=this._cardinalityLimit&&(r=this._overflowAttributes,s=this._overflowHashCode,this._cumulativeMemoStorage.has(r,s))){const h=this._cumulativeMemoStorage.get(r,s);c=this._aggregator.diff(h,a)}if(this._activeCollectionStorage.has(r,s)){const h=this._activeCollectionStorage.get(r,s);c=this._aggregator.merge(h,c)}this._cumulativeMemoStorage.set(r,a,s),this._activeCollectionStorage.set(r,c,s)})}collect(){const e=this._activeCollectionStorage;return this._activeCollectionStorage=new Pe,e}}class nt{constructor(e,n){f(this,"_aggregator");f(this,"_unreportedAccumulations",new Map);f(this,"_reportHistory",new Map);this._aggregator=e,n.forEach(r=>{this._unreportedAccumulations.set(r,[])})}buildMetrics(e,n,r,i){this._stashAccumulations(r);const s=this._getMergedUnreportedAccumulations(e);let a=s,c;if(this._reportHistory.has(e)){const p=this._reportHistory.get(e),m=p.collectionTime;c=p.aggregationTemporality,c===Rt.CUMULATIVE?a=nt.merge(p.accumulations,s,this._aggregator):a=nt.calibrateStartTime(p.accumulations,s,m)}else c=e.selectAggregationTemporality(n.type);this._reportHistory.set(e,{accumulations:a,collectionTime:i,aggregationTemporality:c});const h=xf(a);if(h.length!==0)return this._aggregator.toMetricData(n,c,h,i)}_stashAccumulations(e){const n=this._unreportedAccumulations.keys();for(const r of n){let i=this._unreportedAccumulations.get(r);i===void 0&&(i=[],this._unreportedAccumulations.set(r,i)),i.push(e)}}_getMergedUnreportedAccumulations(e){let n=new Pe;const r=this._unreportedAccumulations.get(e);if(this._unreportedAccumulations.set(e,[]),r===void 0)return n;for(const i of r)n=nt.merge(n,i,this._aggregator);return n}static merge(e,n,r){const i=e,s=n.entries();let a=s.next();for(;a.done!==!0;){const[c,h,p]=a.value;if(e.has(c,p)){const m=e.get(c,p),v=r.merge(m,h);i.set(c,v,p)}else i.set(c,h,p);a=s.next()}return i}static calibrateStartTime(e,n,r){for(const[i,s]of e.keys()){const a=n.get(i,s);a==null||a.setStartTime(r)}return n}}function xf(t){return Array.from(t.entries())}class Rf extends la{constructor(n,r,i,s,a){super(n);f(this,"_attributesProcessor");f(this,"_aggregationCardinalityLimit");f(this,"_deltaMetricStorage");f(this,"_temporalMetricStorage");this._attributesProcessor=i,this._aggregationCardinalityLimit=a,this._deltaMetricStorage=new da(r,this._aggregationCardinalityLimit),this._temporalMetricStorage=new nt(r,s)}record(n,r){const i=new Pe;Array.from(n.entries()).forEach(([s,a])=>{i.set(this._attributesProcessor.process(s),a)}),this._deltaMetricStorage.batchCumulate(i,r)}collect(n,r){const i=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(n,this._instrumentDescriptor,i,r)}}function Vs(t,e){let n="";return t.unit!==e.unit&&(n+=`	- Unit '${t.unit}' does not match '${e.unit}'
`),t.type!==e.type&&(n+=`	- Type '${t.type}' does not match '${e.type}'
`),t.valueType!==e.valueType&&(n+=`	- Value Type '${t.valueType}' does not match '${e.valueType}'
`),t.description!==e.description&&(n+=`	- Description '${t.description}' does not match '${e.description}'
`),n}function Lf(t,e){return`	- use valueType '${t.valueType}' on instrument creation or use an instrument name other than '${e.name}'`}function Mf(t,e){return`	- use unit '${t.unit}' on instrument creation or use an instrument name other than '${e.name}'`}function Pf(t,e){const n={name:e.name,type:e.type,unit:e.unit},r=JSON.stringify(n);return`	- create a new view with a name other than '${t.name}' and InstrumentSelector '${r}'`}function If(t,e){const n={name:e.name,type:e.type,unit:e.unit},r=JSON.stringify(n);return`	- create a new view with a name other than '${t.name}' and InstrumentSelector '${r}'
    	- OR - create a new view with the name ${t.name} and description '${t.description}' and InstrumentSelector ${r}
    	- OR - create a new view with the name ${e.name} and description '${t.description}' and InstrumentSelector ${r}`}function Gs(t,e){return t.valueType!==e.valueType?Lf(t,e):t.unit!==e.unit?Mf(t,e):t.type!==e.type?Pf(t,e):t.description!==e.description?If(t,e):""}class ci{constructor(){f(this,"_sharedRegistry",new Map);f(this,"_perCollectorRegistry",new Map)}static create(){return new ci}getStorages(e){let n=[];for(const i of this._sharedRegistry.values())n=n.concat(i);const r=this._perCollectorRegistry.get(e);if(r!=null)for(const i of r.values())n=n.concat(i);return n}register(e){this._registerStorage(e,this._sharedRegistry)}registerForCollector(e,n){let r=this._perCollectorRegistry.get(e);r==null&&(r=new Map,this._perCollectorRegistry.set(e,r)),this._registerStorage(n,r)}findOrUpdateCompatibleStorage(e){const n=this._sharedRegistry.get(e.name);return n===void 0?null:this._findOrUpdateCompatibleStorage(e,n)}findOrUpdateCompatibleCollectorStorage(e,n){const r=this._perCollectorRegistry.get(e);if(r===void 0)return null;const i=r.get(n.name);return i===void 0?null:this._findOrUpdateCompatibleStorage(n,i)}_registerStorage(e,n){const r=e.getInstrumentDescriptor(),i=n.get(r.name);if(i===void 0){n.set(r.name,[e]);return}i.push(e)}_findOrUpdateCompatibleStorage(e,n){let r=null;for(const i of n){const s=i.getInstrumentDescriptor();gf(s,e)?(s.description!==e.description&&(e.description.length>s.description.length&&i.updateDescription(e.description),C.warn("A view or instrument with the name ",e.name,` has already been registered, but has a different description and is incompatible with another registered view.
`,`Details:
`,Vs(s,e),`The longer description will be used.
To resolve the conflict:`,Gs(s,e))),r=i):C.warn("A view or instrument with the name ",e.name,` has already been registered and is incompatible with another registered view.
`,`Details:
`,Vs(s,e),`To resolve the conflict:
`,Gs(s,e))}return r}}class Nf{constructor(e){f(this,"_backingStorages");this._backingStorages=e}record(e,n,r,i){this._backingStorages.forEach(s=>{s.record(e,n,r,i)})}}class kf{constructor(e,n){f(this,"_instrumentName");f(this,"_valueType");f(this,"_buffer",new Pe);this._instrumentName=e,this._valueType=n}observe(e,n={}){if(typeof e!="number"){C.warn(`non-number value provided to metric ${this._instrumentName}: ${e}`);return}this._valueType===st.INT&&!Number.isInteger(e)&&(C.warn(`INT value type cannot accept a floating-point value for ${this._instrumentName}, ignoring the fractional digits.`),e=Math.trunc(e),!Number.isInteger(e))||this._buffer.set(n,e)}}class Uf{constructor(){f(this,"_buffer",new Map)}observe(e,n,r={}){if(!Ur(e))return;let i=this._buffer.get(e);if(i==null&&(i=new Pe,this._buffer.set(e,i)),typeof n!="number"){C.warn(`non-number value provided to metric ${e._descriptor.name}: ${n}`);return}e._descriptor.valueType===st.INT&&!Number.isInteger(n)&&(C.warn(`INT value type cannot accept a floating-point value for ${e._descriptor.name}, ignoring the fractional digits.`),n=Math.trunc(n),!Number.isInteger(n))||i.set(r,n)}}class Df{constructor(){f(this,"_callbacks",[]);f(this,"_batchCallbacks",[])}addCallback(e,n){this._findCallback(e,n)>=0||this._callbacks.push({callback:e,instrument:n})}removeCallback(e,n){const r=this._findCallback(e,n);r<0||this._callbacks.splice(r,1)}addBatchCallback(e,n){const r=new Set(n.filter(Ur));if(r.size===0){C.error("BatchObservableCallback is not associated with valid instruments",n);return}this._findBatchCallback(e,r)>=0||this._batchCallbacks.push({callback:e,instruments:r})}removeBatchCallback(e,n){const r=new Set(n.filter(Ur)),i=this._findBatchCallback(e,r);i<0||this._batchCallbacks.splice(i,1)}async observe(e,n){const r=this._observeCallbacks(e,n),i=this._observeBatchCallbacks(e,n);return(await hd([...r,...i])).filter(fd).map(c=>c.reason)}_observeCallbacks(e,n){return this._callbacks.map(async({callback:r,instrument:i})=>{const s=new kf(i._descriptor.name,i._descriptor.valueType);let a=Promise.resolve(r(s));n!=null&&(a=_n(a,n)),await a,i._metricStorages.forEach(c=>{c.record(s._buffer,e)})})}_observeBatchCallbacks(e,n){return this._batchCallbacks.map(async({callback:r,instruments:i})=>{const s=new Uf;let a=Promise.resolve(r(s));n!=null&&(a=_n(a,n)),await a,i.forEach(c=>{const h=s._buffer.get(c);h!=null&&c._metricStorages.forEach(p=>{p.record(h,e)})})})}_findCallback(e,n){return this._callbacks.findIndex(r=>r.callback===e&&r.instrument===n)}_findBatchCallback(e,n){return this._batchCallbacks.findIndex(r=>r.callback===e&&pd(r.instruments,n))}}class Bf extends la{constructor(n,r,i,s,a){super(n);f(this,"_attributesProcessor");f(this,"_aggregationCardinalityLimit");f(this,"_deltaMetricStorage");f(this,"_temporalMetricStorage");this._attributesProcessor=i,this._aggregationCardinalityLimit=a,this._deltaMetricStorage=new da(r,this._aggregationCardinalityLimit),this._temporalMetricStorage=new nt(r,s)}record(n,r,i,s){r=this._attributesProcessor.process(r,i),this._deltaMetricStorage.record(n,r,i,s)}collect(n,r){const i=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(n,this._instrumentDescriptor,i,r)}}class $f{process(e,n){return e}}class Ff{constructor(e){f(this,"_processors");this._processors=e}process(e,n){let r=e;for(const i of this._processors)r=i.process(r,n);return r}}function ha(){return Vf}function Hf(t){return new Ff(t)}const Vf=new $f;class Gf{constructor(e,n){f(this,"_meterProviderSharedState");f(this,"_instrumentationScope");f(this,"metricStorageRegistry",new ci);f(this,"observableRegistry",new Df);f(this,"meter");this._meterProviderSharedState=e,this._instrumentationScope=n,this.meter=new Cf(this)}registerMetricStorage(e){const n=this._registerMetricStorage(e,Bf);return n.length===1?n[0]:new Nf(n)}registerAsyncMetricStorage(e){return this._registerMetricStorage(e,Rf)}async collect(e,n,r){const i=await this.observableRegistry.observe(n,r==null?void 0:r.timeoutMillis),s=this.metricStorageRegistry.getStorages(e);if(s.length===0)return null;const a=s.map(c=>c.collect(e,n)).filter(ud);return a.length===0?{errors:i}:{scopeMetrics:{scope:this._instrumentationScope,metrics:a},errors:i}}_registerMetricStorage(e,n){let i=this._meterProviderSharedState.viewRegistry.findViews(e,this._instrumentationScope).map(s=>{const a=_f(s,e),c=this.metricStorageRegistry.findOrUpdateCompatibleStorage(a);if(c!=null)return c;const h=s.aggregation.createAggregator(a),p=new n(a,h,s.attributesProcessor,this._meterProviderSharedState.metricCollectors,s.aggregationCardinalityLimit);return this.metricStorageRegistry.register(p),p});if(i.length===0){const a=this._meterProviderSharedState.selectAggregations(e.type).map(([c,h])=>{const p=this.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(c,e);if(p!=null)return p;const m=h.createAggregator(e),v=c.selectCardinalityLimit(e.type),S=new n(e,m,ha(),[c],v);return this.metricStorageRegistry.registerForCollector(c,S),S});i=i.concat(a)}return i}}class jf{constructor(e){f(this,"resource");f(this,"viewRegistry",new pf);f(this,"metricCollectors",[]);f(this,"meterSharedStates",new Map);this.resource=e}getMeterSharedState(e){const n=ld(e);let r=this.meterSharedStates.get(n);return r==null&&(r=new Gf(this,e),this.meterSharedStates.set(n,r)),r}selectAggregations(e){const n=[];for(const r of this.metricCollectors)n.push([r,aa(r.selectAggregation(e))]);return n}}class zf{constructor(e,n){f(this,"_sharedState");f(this,"_metricReader");this._sharedState=e,this._metricReader=n}async collect(e){const n=ge(Date.now()),r=[],i=[],s=Array.from(this._sharedState.meterSharedStates.values()).map(async a=>{const c=await a.collect(this,n,e);(c==null?void 0:c.scopeMetrics)!=null&&r.push(c.scopeMetrics),(c==null?void 0:c.errors)!=null&&i.push(...c.errors)});return await Promise.all(s),{resourceMetrics:{resource:this._sharedState.resource,scopeMetrics:r},errors:i}}async forceFlush(e){await this._metricReader.forceFlush(e)}async shutdown(e){await this._metricReader.shutdown(e)}selectAggregationTemporality(e){return this._metricReader.selectAggregationTemporality(e)}selectAggregation(e){return this._metricReader.selectAggregation(e)}selectCardinalityLimit(e){var n,r;return((r=(n=this._metricReader).selectCardinalityLimit)==null?void 0:r.call(n,e))??2e3}}const qf=/[\^$\\.+?()[\]{}|]/g;class Nn{constructor(e){f(this,"_matchAll");f(this,"_regexp");e==="*"?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(Nn.escapePattern(e)))}match(e){return this._matchAll?!0:this._regexp.test(e)}static escapePattern(e){return`^${e.replace(qf,"\\$&").replace("*",".*")}$`}static hasWildcard(e){return e.includes("*")}}class ln{constructor(e){f(this,"_matchAll");f(this,"_pattern");this._matchAll=e===void 0,this._pattern=e}match(e){return!!(this._matchAll||e===this._pattern)}}class Xf{constructor(e){f(this,"_nameFilter");f(this,"_type");f(this,"_unitFilter");this._nameFilter=new Nn((e==null?void 0:e.name)??"*"),this._type=e==null?void 0:e.type,this._unitFilter=new ln(e==null?void 0:e.unit)}getType(){return this._type}getNameFilter(){return this._nameFilter}getUnitFilter(){return this._unitFilter}}class Kf{constructor(e){f(this,"_nameFilter");f(this,"_versionFilter");f(this,"_schemaUrlFilter");this._nameFilter=new ln(e==null?void 0:e.name),this._versionFilter=new ln(e==null?void 0:e.version),this._schemaUrlFilter=new ln(e==null?void 0:e.schemaUrl)}getNameFilter(){return this._nameFilter}getVersionFilter(){return this._versionFilter}getSchemaUrlFilter(){return this._schemaUrlFilter}}function Wf(t){return t.instrumentName==null&&t.instrumentType==null&&t.instrumentUnit==null&&t.meterName==null&&t.meterVersion==null&&t.meterSchemaUrl==null}function Yf(t){if(Wf(t))throw new Error("Cannot create view with no selector arguments supplied");if(t.name!=null&&((t==null?void 0:t.instrumentName)==null||Nn.hasWildcard(t.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.")}class Jf{constructor(e){f(this,"name");f(this,"description");f(this,"aggregation");f(this,"attributesProcessor");f(this,"instrumentSelector");f(this,"meterSelector");f(this,"aggregationCardinalityLimit");Yf(e),e.attributesProcessors!=null?this.attributesProcessor=Hf(e.attributesProcessors):this.attributesProcessor=ha(),this.name=e.name,this.description=e.description,this.aggregation=aa(e.aggregation??{type:ce.DEFAULT}),this.instrumentSelector=new Xf({name:e.instrumentName,type:e.instrumentType,unit:e.instrumentUnit}),this.meterSelector=new Kf({name:e.meterName,version:e.meterVersion,schemaUrl:e.meterSchemaUrl}),this.aggregationCardinalityLimit=e.aggregationCardinalityLimit}}class Qf{constructor(e){f(this,"_sharedState");f(this,"_shutdown",!1);if(this._sharedState=new jf((e==null?void 0:e.resource)??ua()),(e==null?void 0:e.views)!=null&&e.views.length>0)for(const n of e.views)this._sharedState.viewRegistry.addView(new Jf(n));if((e==null?void 0:e.readers)!=null&&e.readers.length>0)for(const n of e.readers){const r=new zf(this._sharedState,n);n.setMetricProducer(r),this._sharedState.metricCollectors.push(r)}}getMeter(e,n="",r={}){return this._shutdown?(C.warn("A shutdown MeterProvider cannot provide a Meter"),Xc()):this._sharedState.getMeterSharedState({name:e,version:n,schemaUrl:r.schemaUrl}).meter}async shutdown(e){if(this._shutdown){C.warn("shutdown may only be called once per MeterProvider");return}this._shutdown=!0,await Promise.all(this._sharedState.metricCollectors.map(n=>n.shutdown(e)))}async forceFlush(e){if(this._shutdown){C.warn("invalid attempt to force flush after MeterProvider shutdown");return}await Promise.all(this._sharedState.metricCollectors.map(n=>n.forceFlush(e)))}}function Zf(t,e,{leading:n=!0,trailing:r=!0}={}){let i,s,a,c=null,h=0;function p(){h=n===!1?0:Date.now(),c=null,i&&(s=t.apply(a,i),ep(s)&&s.catch(m=>{C.debug("Error in throttled callback",m)})),a=null,i=null}return function(...m){const v=Date.now();!h&&n===!1&&(h=v);const S=e-(v-h);return a=this,i=m,S<=0||S>e?(c&&(clearTimeout(c),c=null),h=v,i&&(s=t.apply(a,i)),a=null,i=null):!c&&r!==!1&&(c=setTimeout(p,S)),s}}function ep(t){return t!=null&&typeof t=="object"&&"then"in t&&typeof t.then=="function"&&"catch"in t&&typeof t.catch=="function"}class js extends df{constructor({exporter:e,throttleLimit:n}){var r,i;super({aggregationSelector:(r=e.selectAggregation)===null||r===void 0?void 0:r.bind(e),aggregationTemporalitySelector:(i=e.selectAggregationTemporality)===null||i===void 0?void 0:i.bind(e)}),this._exporter=void 0,this._exporter=e,this.onForceFlush=Zf(this.onForceFlush,n)}async onForceFlush(){const{resourceMetrics:e,errors:n}=await this.collect({});return n.length>0&&C.error("PeriodicExportingMetricReader: metrics collection errors",...n),new Promise((r,i)=>{this._exporter.export(e,s=>{if(s.code===Ee.SUCCESS)r();else{var a;i((a=s.error)!==null&&a!==void 0?a:new Error(`InstantaneousMetricReader: metrics export failed (error ${s.error})`))}})})}async onShutdown(){await this._exporter.shutdown()}}let rt=function(t){return t.Histogram="Histogram",t.Counter="Counter",t.UpDownCounter="UpDownCounter",t}({});const tp=ho("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function np(t){return t.setValue(tp,!0)}function zs(t){return t==null?!0:Array.isArray(t)?rp(t):fa(t)}function rp(t){let e;for(const n of t)if(n!=null){if(!e){if(fa(n)){e=typeof n;continue}return!1}if(typeof n!==e)return!1}return!0}function fa(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}function ip(){return t=>{C.error(sp(t))}}function sp(t){return typeof t=="string"?t:JSON.stringify(op(t))}function op(t){const e={};let n=t;for(;n!==null;)Object.getOwnPropertyNames(n).forEach(r=>{if(e[r])return;const i=n[r];i&&(e[r]=String(i))}),n=Object.getPrototypeOf(n);return e}let ap=ip();function Re(t){try{ap(t)}catch{}}const gr=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},Dr=performance,cp="2.0.0",mr={[fh]:"opentelemetry",[hh]:"browser",[ph]:mh,[_h]:cp};const up=9,lp=6,dp=Math.pow(10,lp),Br=Math.pow(10,up);function Nt(t){const e=t/1e3,n=Math.trunc(e),r=Math.round(t%1e3*dp);return[n,r]}function pa(){let t=Dr.timeOrigin;if(typeof t!="number"){const e=Dr;t=e.timing&&e.timing.fetchStart}return t}function $r(t){const e=Nt(pa()),n=Nt(typeof t=="number"?t:Dr.now());return pp(e,n)}function Ie(t){if(fp(t))return t;if(typeof t=="number")return t<pa()?$r(t):Nt(t);if(t instanceof Date)return Nt(t.getTime());throw TypeError("Invalid input type")}function me(t){return t[0]*Br+t[1]}function hp(t){return t[0]*1e6+t[1]/1e3}function fp(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function pp(t,e){const n=[t[0]+e[0],t[1]+e[1]];return n[1]>=Br&&(n[1]-=Br,n[0]+=1),n}var ae;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(ae||(ae={}));const _p="[object Object]",gp="[object Null]",mp="[object Undefined]",yp=Function.prototype,_a=yp.toString,vp=_a.call(Object),Sp=Object.getPrototypeOf,ga=Object.prototype,ma=ga.hasOwnProperty,Oe=Symbol?Symbol.toStringTag:void 0,ya=ga.toString;function qs(t){if(!bp(t)||Ep(t)!==_p)return!1;const e=Sp(t);if(e===null)return!0;const n=ma.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&_a.call(n)===vp}function bp(t){return t!=null&&typeof t=="object"}function Ep(t){return t==null?t===void 0?mp:gp:Oe&&Oe in Object(t)?wp(t):Tp(t)}function wp(t){const e=ma.call(t,Oe),n=t[Oe];let r=!1;try{t[Oe]=void 0,r=!0}catch{}const i=ya.call(t);return r&&(e?t[Oe]=n:delete t[Oe]),i}function Tp(t){return ya.call(t)}const Ap=20;function Cp(...t){let e=t.shift();const n=new WeakMap;for(;t.length>0;)e=va(e,t.shift(),0,n);return e}function yr(t){return yn(t)?t.slice():t}function va(t,e,n=0,r){let i;if(!(n>Ap)){if(n++,dn(t)||dn(e)||Sa(e))i=yr(e);else if(yn(t)){if(i=t.slice(),yn(e))for(let s=0,a=e.length;s<a;s++)i.push(yr(e[s]));else if(St(e)){const s=Object.keys(e);for(let a=0,c=s.length;a<c;a++){const h=s[a];i[h]=yr(e[h])}}}else if(St(t))if(St(e)){if(!Op(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let a=0,c=s.length;a<c;a++){const h=s[a],p=e[h];if(dn(p))typeof p>"u"?delete i[h]:i[h]=p;else{const m=i[h],v=p;if(Xs(t,h,r)||Xs(e,h,r))delete i[h];else{if(St(m)&&St(v)){const S=r.get(m)||[],w=r.get(v)||[];S.push({obj:t,key:h}),w.push({obj:e,key:h}),r.set(m,S),r.set(v,w)}i[h]=va(i[h],p,n,r)}}}}else i=e;return i}}function Xs(t,e,n){const r=n.get(t[e])||[];for(let i=0,s=r.length;i<s;i++){const a=r[i];if(a.key===e&&a.obj===t)return!0}return!1}function yn(t){return Array.isArray(t)}function Sa(t){return typeof t=="function"}function St(t){return!dn(t)&&!yn(t)&&!Sa(t)&&typeof t=="object"}function dn(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function Op(t,e){return!(!qs(t)||!qs(e))}class ui extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ui.prototype)}}function ba(t,e){let n;const r=new Promise(function(s,a){n=setTimeout(function(){a(new ui("Operation timed out."))},e)});return Promise.race([t,r]).then(i=>(clearTimeout(n),i),i=>{throw clearTimeout(n),i})}function Ea(t,e){return typeof e=="string"?t===e:!!t.match(e)}function xp(t,e){if(!e)return!1;for(const n of e)if(Ea(t,n))return!0;return!1}class Rp{constructor(){f(this,"_promise");f(this,"_resolve");f(this,"_reject");this._promise=new Promise((e,n)=>{this._resolve=e,this._reject=n})}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}class li{constructor(e,n){f(this,"_callback");f(this,"_that");f(this,"_isCalled",!1);f(this,"_deferred",new Rp);this._callback=e,this._that=n}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then(n=>this._deferred.resolve(n),n=>this._deferred.reject(n))}catch(n){this._deferred.reject(n)}}return this._deferred.promise}}function Lp(t,e){return new Promise(n=>{K.with(np(K.active()),()=>{t.export(e,r=>{n(r)})})})}const wa={_export:Lp};var ye;(function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"})(ye||(ye={}));var ee;(function(t){t.COUNTER="COUNTER",t.GAUGE="GAUGE",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"})(ee||(ee={}));var Ze;(function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"})(Ze||(Ze={}));var Fr;(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DROP=1]="DROP",t[t.SUM=2]="SUM",t[t.LAST_VALUE=3]="LAST_VALUE",t[t.EXPLICIT_BUCKET_HISTOGRAM=4]="EXPLICIT_BUCKET_HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=5]="EXPONENTIAL_HISTOGRAM"})(Fr||(Fr={}));function Mp(){return"unknown_service"}const tn=t=>t!==null&&typeof t=="object"&&typeof t.then=="function";class vn{constructor(e){f(this,"_rawAttributes");f(this,"_asyncAttributesPending",!1);f(this,"_memoizedAttributes");const n=e.attributes??{};this._rawAttributes=Object.entries(n).map(([r,i])=>(tn(i)&&(this._asyncAttributesPending=!0),[r,i]))}static FromAttributeList(e){const n=new vn({});return n._rawAttributes=e,n._asyncAttributesPending=e.filter(([r,i])=>tn(i)).length>0,n}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let e=0;e<this._rawAttributes.length;e++){const[n,r]=this._rawAttributes[e];try{this._rawAttributes[e]=[n,tn(r)?await r:r]}catch(i){C.debug("a resource's async attributes promise rejected: %s",i),this._rawAttributes[e]=[n,void 0]}}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&C.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const e={};for(const[n,r]of this._rawAttributes){if(tn(r)){C.debug(`Unsettled resource attribute ${n} skipped`);continue}r!=null&&(e[n]??(e[n]=r))}return this._asyncAttributesPending||(this._memoizedAttributes=e),e}getRawAttributes(){return this._rawAttributes}merge(e){return e==null?this:vn.FromAttributeList([...e.getRawAttributes(),...this.getRawAttributes()])}}function Pp(t){return vn.FromAttributeList(Object.entries(t))}function Ip(){return Pp({[zo]:Mp(),[Mt]:mr[Mt],[Pt]:mr[Pt],[It]:mr[It]})}var Sn;(function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE",t[t.LOWMEMORY=2]="LOWMEMORY"})(Sn||(Sn={}));class di{constructor(e){f(this,"_delegate");this._delegate=e}export(e,n){this._delegate.export(e,n)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}}class Ks extends Error{constructor(n,r,i){super(n);f(this,"code");f(this,"name","OTLPExporterError");f(this,"data");this.data=i,this.code=r}}function Np(t){if(Number.isFinite(t)&&t>0)return t;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${t}')`)}function kp(t){if(t!=null)return()=>t}function Up(t,e,n){return{timeoutMillis:Np(t.timeoutMillis??e.timeoutMillis??n.timeoutMillis),concurrencyLimit:t.concurrencyLimit??e.concurrencyLimit??n.concurrencyLimit,compression:t.compression??e.compression??n.compression}}function Dp(){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none"}}class Bp{constructor(e){f(this,"_concurrencyLimit");f(this,"_sendingPromises",[]);this._concurrencyLimit=e}pushPromise(e){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(e);const n=()=>{const r=this._sendingPromises.indexOf(e);this._sendingPromises.splice(r,1)};e.then(n,n)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}}function $p(t){return new Bp(t.concurrencyLimit)}function Fp(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}function Hp(){return{handleResponse(t){t==null||!Fp(t)||t.partialSuccess==null||Object.keys(t.partialSuccess).length===0||C.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}}}class Vp{constructor(e,n,r,i,s){f(this,"_transport");f(this,"_serializer");f(this,"_responseHandler");f(this,"_promiseQueue");f(this,"_timeout");f(this,"_diagLogger");this._transport=e,this._serializer=n,this._responseHandler=r,this._promiseQueue=i,this._timeout=s,this._diagLogger=C.createComponentLogger({namespace:"OTLPExportDelegate"})}export(e,n){if(this._diagLogger.debug("items to be sent",e),this._promiseQueue.hasReachedLimit()){n({code:ae.FAILED,error:new Error("Concurrent export limit reached")});return}const r=this._serializer.serializeRequest(e);if(r==null){n({code:ae.FAILED,error:new Error("Nothing to send")});return}this._promiseQueue.pushPromise(this._transport.send(r,this._timeout).then(i=>{if(i.status==="success"){if(i.data!=null)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(i.data))}catch(s){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",s,i.data)}n({code:ae.SUCCESS});return}else if(i.status==="failure"&&i.error){n({code:ae.FAILED,error:i.error});return}else i.status==="retryable"?n({code:ae.FAILED,error:new Ks("Export failed with retryable status")}):n({code:ae.FAILED,error:new Ks("Export failed with unknown error")})},i=>n({code:ae.FAILED,error:i})))}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}}function Gp(t,e){return new Vp(t.transport,t.serializer,Hp(),t.promiseHandler,e.timeout)}function Ta(t,e,n){return Gp({transport:n,serializer:e,promiseHandler:$p(t)},{timeout:t.timeoutMillis})}const Hr=()=>ye.CUMULATIVE,Aa=t=>{switch(t){case ee.COUNTER:case ee.OBSERVABLE_COUNTER:case ee.GAUGE:case ee.HISTOGRAM:case ee.OBSERVABLE_GAUGE:return ye.DELTA;case ee.UP_DOWN_COUNTER:case ee.OBSERVABLE_UP_DOWN_COUNTER:return ye.CUMULATIVE}},Ca=t=>{switch(t){case ee.COUNTER:case ee.HISTOGRAM:return ye.DELTA;case ee.GAUGE:case ee.UP_DOWN_COUNTER:case ee.OBSERVABLE_UP_DOWN_COUNTER:case ee.OBSERVABLE_COUNTER:case ee.OBSERVABLE_GAUGE:return ye.CUMULATIVE}};function jp(){const t="cumulative".toLowerCase();return t==="cumulative"?Hr:t==="delta"?Aa:t==="lowmemory"?Ca:(C.warn(`OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is set to '${t}', but only 'cumulative' and 'delta' are allowed. Using default ('cumulative') instead.`),Hr)}function zp(t){return t!=null?t===Sn.DELTA?Aa:t===Sn.LOWMEMORY?Ca:Hr:jp()}const qp=Object.freeze({type:Fr.DEFAULT});function Xp(t){return(t==null?void 0:t.aggregationPreference)??(()=>qp)}class Kp extends di{constructor(n,r){super(n);f(this,"_aggregationTemporalitySelector");f(this,"_aggregationSelector");this._aggregationSelector=Xp(r),this._aggregationTemporalitySelector=zp(r==null?void 0:r.temporalityPreference)}selectAggregation(n){return this._aggregationSelector(n)}selectAggregationTemporality(n){return this._aggregationTemporalitySelector(n)}}function Ws(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function hi(t){const e=new Uint8Array(t.length/2);let n=0;for(let r=0;r<t.length;r+=2){const i=Ws(t.charCodeAt(r)),s=Ws(t.charCodeAt(r+1));e[n++]=i<<4|s}return e}function Oa(t){const e=BigInt(1e9);return BigInt(t[0])*e+BigInt(t[1])}function Wp(t){const e=Number(BigInt.asUintN(32,t)),n=Number(BigInt.asUintN(32,t>>BigInt(32)));return{low:e,high:n}}function xa(t){const e=Oa(t);return Wp(e)}function Yp(t){return Oa(t).toString()}const Jp=typeof BigInt<"u"?Yp:me;function Ys(t){return t}function Ra(t){if(t!==void 0)return hi(t)}const Qp={encodeHrTime:xa,encodeSpanContext:hi,encodeOptionalSpanContext:Ra};function fi(t){if(t===void 0)return Qp;const e=t.useLongBits??!0,n=t.useHex??!1;return{encodeHrTime:e?xa:Jp,encodeSpanContext:n?Ys:hi,encodeOptionalSpanContext:n?Ys:Ra}}function pi(t){return{attributes:Fe(t.attributes),droppedAttributesCount:0}}function _i(t){return{name:t.name,version:t.version}}function Fe(t){return Object.keys(t).map(e=>gi(e,t[e]))}function gi(t,e){return{key:t,value:mi(e)}}function mi(t){const e=typeof t;return e==="string"?{stringValue:t}:e==="number"?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:e==="boolean"?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(mi)}}:e==="object"&&t!=null?{kvlistValue:{values:Object.entries(t).map(([n,r])=>gi(n,r))}}:{}}function Zp(t,e){const n=fi(e);return{resourceLogs:t_(t,n)}}function e_(t){const e=new Map;for(const n of t){const{resource:r,instrumentationScope:{name:i,version:s="",schemaUrl:a=""}}=n;let c=e.get(r);c||(c=new Map,e.set(r,c));const h=`${i}@${s}:${a}`;let p=c.get(h);p||(p=[],c.set(h,p)),p.push(n)}return e}function t_(t,e){const n=e_(t);return Array.from(n,([r,i])=>({resource:pi(r),scopeLogs:Array.from(i,([,s])=>({scope:_i(s[0].instrumentationScope),logRecords:s.map(a=>n_(a,e)),schemaUrl:s[0].instrumentationScope.schemaUrl})),schemaUrl:void 0}))}function n_(t,e){var n,r,i;return{timeUnixNano:e.encodeHrTime(t.hrTime),observedTimeUnixNano:e.encodeHrTime(t.hrTimeObserved),severityNumber:t.severityNumber,severityText:t.severityText,body:mi(t.body),attributes:r_(t.attributes),droppedAttributesCount:t.droppedAttributesCount,flags:(n=t.spanContext)==null?void 0:n.traceFlags,traceId:e.encodeOptionalSpanContext((r=t.spanContext)==null?void 0:r.traceId),spanId:e.encodeOptionalSpanContext((i=t.spanContext)==null?void 0:i.spanId)}}function r_(t){return Object.keys(t).map(e=>gi(e,t[e]))}function i_(t,e){const n=fi(e);return{resource:pi(t.resource),schemaUrl:void 0,scopeMetrics:s_(t.scopeMetrics,n)}}function s_(t,e){return Array.from(t.map(n=>({scope:_i(n.scope),metrics:n.metrics.map(r=>o_(r,e)),schemaUrl:n.scope.schemaUrl})))}function o_(t,e){const n={name:t.descriptor.name,description:t.descriptor.description,unit:t.descriptor.unit},r=l_(t.aggregationTemporality);switch(t.dataPointType){case Ze.SUM:n.sum={aggregationTemporality:r,isMonotonic:t.isMonotonic,dataPoints:Js(t,e)};break;case Ze.GAUGE:n.gauge={dataPoints:Js(t,e)};break;case Ze.HISTOGRAM:n.histogram={aggregationTemporality:r,dataPoints:c_(t,e)};break;case Ze.EXPONENTIAL_HISTOGRAM:n.exponentialHistogram={aggregationTemporality:r,dataPoints:u_(t,e)};break}return n}function a_(t,e,n){const r={attributes:Fe(t.attributes),startTimeUnixNano:n.encodeHrTime(t.startTime),timeUnixNano:n.encodeHrTime(t.endTime)};switch(e){case st.INT:r.asInt=t.value;break;case st.DOUBLE:r.asDouble=t.value;break}return r}function Js(t,e){return t.dataPoints.map(n=>a_(n,t.descriptor.valueType,e))}function c_(t,e){return t.dataPoints.map(n=>{const r=n.value;return{attributes:Fe(n.attributes),bucketCounts:r.buckets.counts,explicitBounds:r.buckets.boundaries,count:r.count,sum:r.sum,min:r.min,max:r.max,startTimeUnixNano:e.encodeHrTime(n.startTime),timeUnixNano:e.encodeHrTime(n.endTime)}})}function u_(t,e){return t.dataPoints.map(n=>{const r=n.value;return{attributes:Fe(n.attributes),count:r.count,min:r.min,max:r.max,sum:r.sum,positive:{offset:r.positive.offset,bucketCounts:r.positive.bucketCounts},negative:{offset:r.negative.offset,bucketCounts:r.negative.bucketCounts},scale:r.scale,zeroCount:r.zeroCount,startTimeUnixNano:e.encodeHrTime(n.startTime),timeUnixNano:e.encodeHrTime(n.endTime)}})}function l_(t){switch(t){case ye.DELTA:return 1;case ye.CUMULATIVE:return 2}}function d_(t,e){return{resourceMetrics:t.map(n=>i_(n,e))}}function h_(t,e){var s,a,c;const n=t.spanContext(),r=t.status,i=(s=t.parentSpanContext)!=null&&s.spanId?e.encodeSpanContext((a=t.parentSpanContext)==null?void 0:a.spanId):void 0;return{traceId:e.encodeSpanContext(n.traceId),spanId:e.encodeSpanContext(n.spanId),parentSpanId:i,traceState:(c=n.traceState)==null?void 0:c.serialize(),name:t.name,kind:t.kind==null?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:Fe(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(h=>p_(h,e)),droppedEventsCount:t.droppedEventsCount,status:{code:r.code,message:r.message},links:t.links.map(h=>f_(h,e)),droppedLinksCount:t.droppedLinksCount}}function f_(t,e){var n;return{attributes:t.attributes?Fe(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:(n=t.context.traceState)==null?void 0:n.serialize(),droppedAttributesCount:t.droppedAttributesCount||0}}function p_(t,e){return{attributes:t.attributes?Fe(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}function __(t,e){const n=fi(e);return{resourceSpans:m_(t,n)}}function g_(t){const e=new Map;for(const n of t){let r=e.get(n.resource);r||(r=new Map,e.set(n.resource,r));const i=`${n.instrumentationScope.name}@${n.instrumentationScope.version||""}:${n.instrumentationScope.schemaUrl||""}`;let s=r.get(i);s||(s=[],r.set(i,s)),s.push(n)}return e}function m_(t,e){const n=g_(t),r=[],i=n.entries();let s=i.next();for(;!s.done;){const[a,c]=s.value,h=[],p=c.values();let m=p.next();for(;!m.done;){const S=m.value;if(S.length>0){const w=S.map(L=>h_(L,e));h.push({scope:_i(S[0].instrumentationScope),spans:w,schemaUrl:S[0].instrumentationScope.schemaUrl})}m=p.next()}const v={resource:pi(a),scopeSpans:h,schemaUrl:void 0};r.push(v),s=i.next()}return r}const y_={serializeRequest:t=>{const e=Zp(t,{useHex:!0,useLongBits:!1});return new TextEncoder().encode(JSON.stringify(e))},deserializeResponse:t=>{const e=new TextDecoder;return JSON.parse(e.decode(t))}},v_={serializeRequest:t=>{const e=d_([t],{useLongBits:!1});return new TextEncoder().encode(JSON.stringify(e))},deserializeResponse:t=>{const e=new TextDecoder;return JSON.parse(e.decode(t))}},S_={serializeRequest:t=>{const e=__(t,{useHex:!0,useLongBits:!1});return new TextEncoder().encode(JSON.stringify(e))},deserializeResponse:t=>{const e=new TextDecoder;return JSON.parse(e.decode(t))}},b_=5,E_=1e3,w_=5e3,T_=1.5,Qs=.2;function A_(){return Math.random()*(2*Qs)-Qs}class C_{constructor(e){f(this,"_transport");this._transport=e}retry(e,n,r){return new Promise((i,s)=>{setTimeout(()=>{this._transport.send(e,n).then(i,s)},r)})}async send(e,n){const r=Date.now()+n;let i=await this._transport.send(e,n),s=b_,a=E_;for(;i.status==="retryable"&&s>0;){s--;const c=Math.max(Math.min(a,w_)+A_(),0);a=a*T_;const h=i.retryInMillis??c,p=r-Date.now();if(h>p)return i;i=await this.retry(e,p,h)}return i}shutdown(){return this._transport.shutdown()}}function La(t){return new C_(t.transport)}function O_(t){return[429,502,503,504].includes(t)}function x_(t){if(t==null)return;const e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?e*1e3:-1;const n=new Date(t).getTime()-Date.now();return n>=0?n:0}class R_{constructor(e){f(this,"_parameters");this._parameters=e}send(e,n){return new Promise(r=>{const i=new XMLHttpRequest;i.timeout=n,i.open("POST",this._parameters.url);const s=this._parameters.headers();Object.entries(s).forEach(([a,c])=>{i.setRequestHeader(a,c)}),i.ontimeout=a=>{r({status:"failure",error:new Error("XHR request timed out")})},i.onreadystatechange=()=>{i.status>=200&&i.status<=299?(C.debug("XHR success"),r({status:"success"})):i.status&&O_(i.status)?r({status:"retryable",retryInMillis:x_(i.getResponseHeader("Retry-After"))}):i.status!==0&&r({status:"failure",error:new Error("XHR request failed with non-retryable status")})},i.onabort=()=>{r({status:"failure",error:new Error("XHR request aborted")})},i.onerror=()=>{r({status:"failure",error:new Error("XHR request errored")})},i.send(e)})}shutdown(){}}function L_(t){return new R_(t)}class M_{constructor(e){f(this,"_params");this._params=e}send(e){return new Promise(n=>{navigator.sendBeacon(this._params.url,new Blob([e],{type:this._params.blobType}))?(C.debug("SendBeacon success"),n({status:"success"})):n({status:"failure",error:new Error("SendBeacon failed")})})}shutdown(){}}function P_(t){return new M_(t)}function I_(t,e){return Ta(t,e,La({transport:L_(t)}))}function N_(t,e){return Ta(t,e,La({transport:P_({url:t.url,blobType:t.headers()["Content-Type"]})}))}function k_(t){return()=>{const e={};return Object.entries((t==null?void 0:t())??{}).forEach(([n,r])=>{typeof r<"u"?e[n]=String(r):C.warn(`Header "${n}" has invalid value (${r}) and will be ignored`)}),e}}function U_(t,e,n){const r={...n()},i={};return()=>(e!=null&&Object.assign(i,e()),t!=null&&Object.assign(i,t()),Object.assign(i,r))}function D_(t){if(t!=null)try{return new URL(t),t}catch{throw new Error(`Configuration: Could not parse user-provided export URL: '${t}'`)}}function B_(t,e,n){return{...Up(t,e,n),headers:U_(k_(t.headers),e.headers,n.headers),url:D_(t.url)??e.url??n.url,agentOptions:t.agentOptions??e.agentOptions??n.agentOptions}}function $_(t,e){return{...Dp(),headers:()=>t,url:"http://localhost:4318/"+e,agentOptions:{keepAlive:!0}}}function F_(t,e,n){return B_({url:t.url,timeoutMillis:t.timeoutMillis,headers:kp(t.headers),concurrencyLimit:t.concurrencyLimit},{},$_(n,e))}function yi(t,e,n,r){const i=!!t.headers||typeof navigator.sendBeacon!="function",s=F_(t,n,r);return i?I_(s,e):N_(s,e)}class H_ extends Kp{constructor(e){super(yi(e??{},v_,"v1/metrics",{"Content-Type":"application/json"}),e)}}const bn={production:"https://otlp-http-production.MedusaJSsvc.com",staging:"https://otlp-http-staging.MedusaJSsvc.com",local:"http://localhost:4318"},V_="/v1/metrics",G_="/v1/traces",j_="/v1/logs",vi="service.name",Ma="deployment.environment";class z_ extends Qf{constructor({serviceName:e,env:n,throttleLimit:r,useXhr:i,dev:s,otlpBaseURL:a,views:c=[]}){const p={url:(typeof a=="string"?a:bn[n]||n)+V_,temporalityPreference:Rt.DELTA};i&&(p.headers={});const m=new H_(p),v=[new js({exporter:m,throttleLimit:r})];s&&v.push(new js({exporter:new ai,throttleLimit:r})),super({resource:Mn({[vi]:e}),readers:v,views:c})}}class q_ extends di{constructor(e={}){super(yi(e,S_,"v1/traces",{"Content-Type":"application/json"}))}}const X_="exception";class K_{constructor(e){f(this,"_spanContext");f(this,"kind");f(this,"parentSpanContext");f(this,"attributes",{});f(this,"links",[]);f(this,"events",[]);f(this,"startTime");f(this,"resource");f(this,"instrumentationScope");f(this,"_droppedAttributesCount",0);f(this,"_droppedEventsCount",0);f(this,"_droppedLinksCount",0);f(this,"name");f(this,"status",{code:Kc.UNSET});f(this,"endTime",[0,0]);f(this,"_ended",!1);f(this,"_duration",[-1,-1]);f(this,"_spanProcessor");f(this,"_spanLimits");f(this,"_attributeValueLengthLimit");f(this,"_performanceStartTime");f(this,"_performanceOffset");f(this,"_startTimeProvided");const n=Date.now();this._spanContext=e.spanContext,this._performanceStartTime=tt.now(),this._performanceOffset=n-(this._performanceStartTime+qo()),this._startTimeProvided=e.startTime!=null,this._spanLimits=e.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=e.spanProcessor,this.name=e.name,this.parentSpanContext=e.parentSpanContext,this.kind=e.kind,this.links=e.links||[],this.startTime=this._getTime(e.startTime??n),this.resource=e.resource,this.instrumentationScope=e.scope,e.attributes!=null&&this.setAttributes(e.attributes),this._spanProcessor.onStart(this,e.context)}spanContext(){return this._spanContext}setAttribute(e,n){if(n==null||this._isSpanEnded())return this;if(e.length===0)return C.warn(`Invalid attribute key: ${e}`),this;if(!Go(n))return C.warn(`Invalid attribute value set for key: ${e}`),this;const{attributeCountLimit:r}=this._spanLimits;return r!==void 0&&Object.keys(this.attributes).length>=r&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(n),this)}setAttributes(e){for(const[n,r]of Object.entries(e))this.setAttribute(n,r);return this}addEvent(e,n,r){if(this._isSpanEnded())return this;const{eventCountLimit:i}=this._spanLimits;if(i===0)return C.warn("No events allowed."),this._droppedEventsCount++,this;i!==void 0&&this.events.length>=i&&(this._droppedEventsCount===0&&C.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Ns(n)&&(Ns(r)||(r=n),n=void 0);const s=cn(n);return this.events.push({name:e,attributes:s,time:this._getTime(r),droppedAttributesCount:0}),this}addLink(e){return this.links.push(e),this}addLinks(e){return this.links.push(...e),this}setStatus(e){return this._isSpanEnded()?this:(this.status={...e},this.status.message!=null&&typeof e.message!="string"&&(C.warn(`Dropping invalid status.message of type '${typeof e.message}', expected 'string'`),delete this.status.message),this)}updateName(e){return this._isSpanEnded()?this:(this.name=e,this)}end(e){if(this._isSpanEnded()){C.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`);return}this._ended=!0,this.endTime=this._getTime(e),this._duration=Ah(this.startTime,this.endTime),this._duration[0]<0&&(C.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&C.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this)}_getTime(e){if(typeof e=="number"&&e<=tt.now())return Th(e+this._performanceOffset);if(typeof e=="number")return ge(e);if(e instanceof Date)return ge(e.getTime());if(Xo(e))return e;if(this._startTimeProvided)return ge(Date.now());const n=tt.now()-this._performanceStartTime;return Ko(this.startTime,ge(n))}isRecording(){return this._ended===!1}recordException(e,n){const r={};typeof e=="string"?r[ur]=e:e&&(e.code?r[lr]=e.code.toString():e.name&&(r[lr]=e.name),e.message&&(r[ur]=e.message),e.stack&&(r[yh]=e.stack)),r[lr]||r[ur]?this.addEvent(X_,r,n):C.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const e=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);C.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,e)}return this._ended}_truncateToLimitUtil(e,n){return e.length<=n?e:e.substring(0,n)}_truncateToSize(e){const n=this._attributeValueLengthLimit;return n<=0?(C.warn(`Attribute value limit must be positive, got ${n}`),e):typeof e=="string"?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(r=>typeof r=="string"?this._truncateToLimitUtil(r,n):r):e}}var ut;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(ut||(ut={}));class En{shouldSample(){return{decision:ut.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class it{shouldSample(){return{decision:ut.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class nn{constructor(e){f(this,"_root");f(this,"_remoteParentSampled");f(this,"_remoteParentNotSampled");f(this,"_localParentSampled");f(this,"_localParentNotSampled");this._root=e.root,this._root||($e(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new it),this._remoteParentSampled=e.remoteParentSampled??new it,this._remoteParentNotSampled=e.remoteParentNotSampled??new En,this._localParentSampled=e.localParentSampled??new it,this._localParentNotSampled=e.localParentNotSampled??new En}shouldSample(e,n,r,i,s,a){const c=se.getSpanContext(e);return!c||!zr(c)?this._root.shouldSample(e,n,r,i,s,a):c.isRemote?c.traceFlags&Ne.SAMPLED?this._remoteParentSampled.shouldSample(e,n,r,i,s,a):this._remoteParentNotSampled.shouldSample(e,n,r,i,s,a):c.traceFlags&Ne.SAMPLED?this._localParentSampled.shouldSample(e,n,r,i,s,a):this._localParentNotSampled.shouldSample(e,n,r,i,s,a)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}class Vr{constructor(e=0){f(this,"_ratio");f(this,"_upperBound");this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(e,n){return{decision:Wc(n)&&this._accumulate(n)<this._upperBound?ut.RECORD_AND_SAMPLED:ut.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let n=0;for(let r=0;r<e.length/8;r++){const i=r*8,s=parseInt(e.slice(i,i+8),16);n=(n^s)>>>0}return n}}const Zs=1;function Pa(){return{sampler:Ia(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},spanLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128,linkCountLimit:128,eventCountLimit:128,attributePerEventCountLimit:128,attributePerLinkCountLimit:128}}}function Ia(){const t="parentbased_always_on";switch(t){case"always_on":return new it;case"always_off":return new En;case"parentbased_always_on":return new nn({root:new it});case"parentbased_always_off":return new nn({root:new En});case"traceidratio":return new Vr(eo());case"parentbased_traceidratio":return new nn({root:new Vr(eo())});default:return C.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "parentbased_always_on".`),new nn({root:new it})}}function eo(){return C.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${Zs}.`),Zs}const W_=128,Y_=1/0;function J_(t){const e={sampler:Ia()},n=Pa(),r=Object.assign({},n,e,t);return r.generalLimits=Object.assign({},n.generalLimits,t.generalLimits||{}),r.spanLimits=Object.assign({},n.spanLimits,t.spanLimits||{}),r}function Q_(t){var n,r,i,s;const e=Object.assign({},t.spanLimits);return e.attributeCountLimit=((n=t.spanLimits)==null?void 0:n.attributeCountLimit)??((r=t.generalLimits)==null?void 0:r.attributeCountLimit)??void 0??void 0??W_,e.attributeValueLengthLimit=((i=t.spanLimits)==null?void 0:i.attributeValueLengthLimit)??((s=t.generalLimits)==null?void 0:s.attributeValueLengthLimit)??void 0??void 0??Y_,Object.assign({},t,{spanLimits:e})}class Z_{constructor(e,n){f(this,"_exporter");f(this,"_maxExportBatchSize");f(this,"_maxQueueSize");f(this,"_scheduledDelayMillis");f(this,"_exportTimeoutMillis");f(this,"_isExporting",!1);f(this,"_finishedSpans",[]);f(this,"_timer");f(this,"_shutdownOnce");f(this,"_droppedSpansCount",0);this._exporter=e,this._maxExportBatchSize=typeof(n==null?void 0:n.maxExportBatchSize)=="number"?n.maxExportBatchSize:512,this._maxQueueSize=typeof(n==null?void 0:n.maxQueueSize)=="number"?n.maxQueueSize:2048,this._scheduledDelayMillis=typeof(n==null?void 0:n.scheduledDelayMillis)=="number"?n.scheduledDelayMillis:5e3,this._exportTimeoutMillis=typeof(n==null?void 0:n.exportTimeoutMillis)=="number"?n.exportTimeoutMillis:3e4,this._shutdownOnce=new ta(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(C.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(e,n){}onEnd(e){this._shutdownOnce.isCalled||(e.spanContext().traceFlags&Ne.SAMPLED)!==0&&this._addToBuffer(e)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&C.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(C.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()}_flushAll(){return new Promise((e,n)=>{const r=[],i=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let s=0,a=i;s<a;s++)r.push(this._flushOneBatch());Promise.all(r).then(()=>{e()}).catch(n)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((e,n)=>{const r=setTimeout(()=>{n(new Error("Timeout"))},this._exportTimeoutMillis);K.with(Vo(K.active()),()=>{let i;this._finishedSpans.length<=this._maxExportBatchSize?(i=this._finishedSpans,this._finishedSpans=[]):i=this._finishedSpans.splice(0,this._maxExportBatchSize);const s=()=>this._exporter.export(i,c=>{clearTimeout(r),c.code===Ee.SUCCESS?e():n(c.error??new Error("BatchSpanProcessor: span export failed"))});let a=null;for(let c=0,h=i.length;c<h;c++){const p=i[c];p.resource.asyncAttributesPending&&p.resource.waitForAsyncAttributes&&(a??(a=[]),a.push(p.resource.waitForAsyncAttributes()))}a===null?s():Promise.all(a).then(s,c=>{$e(c),n(c)})})})}_maybeStartTimer(){if(this._isExporting)return;const e=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(n=>{this._isExporting=!1,$e(n)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();this._timer===void 0&&(this._timer=setTimeout(()=>e(),this._scheduledDelayMillis),this._timer,void 0)}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}}class eg extends Z_{constructor(n,r){super(n,r);f(this,"_visibilityChangeListener");f(this,"_pageHideListener");this.onInit(r)}onInit(n){(n==null?void 0:n.disableAutoFlushOnDocumentHide)!==!0&&typeof document<"u"&&(this._visibilityChangeListener=()=>{document.visibilityState==="hidden"&&this.forceFlush().catch(r=>{$e(r)})},this._pageHideListener=()=>{this.forceFlush().catch(r=>{$e(r)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){typeof document<"u"&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}}const tg=8,ng=16;class rg{constructor(){f(this,"generateTraceId",to(ng));f(this,"generateSpanId",to(tg))}}const rn=Array(32);function to(t){return function(){for(let n=0;n<t*2;n++)rn[n]=Math.floor(Math.random()*16)+48,rn[n]>=58&&(rn[n]+=39);return String.fromCharCode.apply(null,rn.slice(0,t*2))}}class ig{constructor(e,n,r,i){f(this,"_sampler");f(this,"_generalLimits");f(this,"_spanLimits");f(this,"_idGenerator");f(this,"instrumentationScope");f(this,"_resource");f(this,"_spanProcessor");const s=J_(n);this._sampler=s.sampler,this._generalLimits=s.generalLimits,this._spanLimits=s.spanLimits,this._idGenerator=n.idGenerator||new rg,this._resource=r,this._spanProcessor=i,this.instrumentationScope=e}startSpan(e,n={},r=K.active()){n.root&&(r=se.deleteSpan(r));const i=se.getSpan(r);if(si(r))return C.debug("Instrumentation suppressed, returning Noop Span"),se.wrapSpanContext(Yc);const s=i==null?void 0:i.spanContext(),a=this._idGenerator.generateSpanId();let c,h,p;!s||!se.isSpanContextValid(s)?h=this._idGenerator.generateTraceId():(h=s.traceId,p=s.traceState,c=s);const m=n.kind??fo.INTERNAL,v=(n.links??[]).map(B=>({context:B.context,attributes:cn(B.attributes)})),S=cn(n.attributes),w=this._sampler.shouldSample(r,h,e,m,S,v);p=w.traceState??p;const L=w.decision===es.RECORD_AND_SAMPLED?Ne.SAMPLED:Ne.NONE,A={traceId:h,spanId:a,traceFlags:L,traceState:p};if(w.decision===es.NOT_RECORD)return C.debug("Recording is off, propagating context in a non-recording span"),se.wrapSpanContext(A);const R=cn(Object.assign(S,w.attributes));return new K_({resource:this._resource,scope:this.instrumentationScope,context:r,spanContext:A,name:e,kind:m,links:v,parentSpanContext:c,attributes:R,startTime:n.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(e,n,r,i){let s,a,c;if(arguments.length<2)return;arguments.length===2?c=n:arguments.length===3?(s=n,c=r):(s=n,a=r,c=i);const h=a??K.active(),p=this.startSpan(e,s,h),m=se.setSpan(h,p);return K.with(m,c,void 0,p)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}}class sg{constructor(e){f(this,"_spanProcessors");this._spanProcessors=e}forceFlush(){const e=[];for(const n of this._spanProcessors)e.push(n.forceFlush());return new Promise(n=>{Promise.all(e).then(()=>{n()}).catch(r=>{$e(r||new Error("MultiSpanProcessor: forceFlush failed")),n()})})}onStart(e,n){for(const r of this._spanProcessors)r.onStart(e,n)}onEnd(e){for(const n of this._spanProcessors)n.onEnd(e)}shutdown(){const e=[];for(const n of this._spanProcessors)e.push(n.shutdown());return new Promise((n,r)=>{Promise.all(e).then(()=>{n()},r)})}}var xe;(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(xe||(xe={}));class og{constructor(e={}){f(this,"_config");f(this,"_tracers",new Map);f(this,"_resource");f(this,"_activeSpanProcessor");var i;const n=ef({},Pa(),Q_(e));this._resource=n.resource??ua(),this._config=Object.assign({},n,{resource:this._resource});const r=[];(i=e.spanProcessors)!=null&&i.length&&r.push(...e.spanProcessors),this._activeSpanProcessor=new sg(r)}getTracer(e,n,r){const i=`${e}@${n||""}:${(r==null?void 0:r.schemaUrl)||""}`;return this._tracers.has(i)||this._tracers.set(i,new ig({name:e,version:n,schemaUrl:r==null?void 0:r.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(i)}forceFlush(){const e=this._config.forceFlushTimeoutMillis,n=this._activeSpanProcessor._spanProcessors.map(r=>new Promise(i=>{let s;const a=setTimeout(()=>{i(new Error(`Span processor did not completed within timeout period of ${e} ms`)),s=xe.timeout},e);r.forceFlush().then(()=>{clearTimeout(a),s!==xe.timeout&&(s=xe.resolved,i(s))}).catch(c=>{clearTimeout(a),s=xe.error,i(c)})}));return new Promise((r,i)=>{Promise.all(n).then(s=>{const a=s.filter(c=>c!==xe.resolved);a.length>0?i(a):r()}).catch(s=>i([s]))})}shutdown(){return this._activeSpanProcessor.shutdown()}}class ag{export(e,n){return this._sendSpans(e,n)}shutdown(){return this._sendSpans([]),this.forceFlush()}forceFlush(){return Promise.resolve()}_exportInfo(e){var n;return{resource:{attributes:e.resource.attributes},instrumentationScope:e.instrumentationScope,traceId:e.spanContext().traceId,parentSpanContext:e.parentSpanContext,traceState:(n=e.spanContext().traceState)==null?void 0:n.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:Qe(e.startTime),duration:Qe(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}}_sendSpans(e,n){for(const r of e)console.dir(this._exportInfo(r),{depth:3});if(n)return n({code:Ee.SUCCESS})}}class cg{constructor(e){f(this,"_exporter");f(this,"_shutdownOnce");f(this,"_pendingExports");this._exporter=e,this._shutdownOnce=new ta(this._shutdown,this),this._pendingExports=new Set}async forceFlush(){await Promise.all(Array.from(this._pendingExports)),this._exporter.forceFlush&&await this._exporter.forceFlush()}onStart(e,n){}onEnd(e){if(this._shutdownOnce.isCalled||(e.spanContext().traceFlags&Ne.SAMPLED)===0)return;const n=this._doExport(e).catch(r=>$e(r));this._pendingExports.add(n),n.finally(()=>this._pendingExports.delete(n))}async _doExport(e){var r,i;e.resource.asyncAttributesPending&&await((i=(r=e.resource).waitForAsyncAttributes)==null?void 0:i.call(r));const n=await sf._export(this._exporter,[e]);if(n.code!==Ee.SUCCESS)throw n.error??new Error(`SimpleSpanProcessor: span export failed (status ${n})`)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}}class ug{constructor(){f(this,"_enabled",!1);f(this,"_currentContext",mt)}_bindFunction(e=mt,n){const r=this,i=function(...s){return r.with(e,()=>n.apply(this,s))};return Object.defineProperty(i,"length",{enumerable:!1,configurable:!0,writable:!1,value:n.length}),i}active(){return this._currentContext}bind(e,n){return e===void 0&&(e=this.active()),typeof n=="function"?this._bindFunction(e,n):n}disable(){return this._currentContext=mt,this._enabled=!1,this}enable(){return this._enabled?this:(this._enabled=!0,this._currentContext=mt,this)}with(e,n,r,...i){const s=this._currentContext;this._currentContext=e||mt;try{return n.call(r,...i)}finally{this._currentContext=s}}}function lg(t){if(t!==null){if(t===void 0){const e=new ug;e.enable(),K.setGlobalContextManager(e);return}t.enable(),K.setGlobalContextManager(t)}}function dg(t){if(t!==null){if(t===void 0){ue.setGlobalPropagator(new Ch({propagators:[new Vh,new Ud]}));return}ue.setGlobalPropagator(t)}}class hg extends og{constructor(e={}){super(e)}register(e={}){se.setGlobalTracerProvider(this),dg(e.propagator),lg(e.contextManager)}}class Na{emit(e){}}const ka=new Na;class fg{getLogger(e,n,r){return new Na}}const Ua=new fg;class pg{constructor(e,n,r,i){this._provider=e,this.name=n,this.version=r,this.options=i}emit(e){this._getLogger().emit(e)}_getLogger(){if(this._delegate)return this._delegate;const e=this._provider.getDelegateLogger(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):ka}}class no{getLogger(e,n,r){var i;return(i=this.getDelegateLogger(e,n,r))!==null&&i!==void 0?i:new pg(this,e,n,r)}getDelegate(){var e;return(e=this._delegate)!==null&&e!==void 0?e:Ua}setDelegate(e){this._delegate=e}getDelegateLogger(e,n,r){var i;return(i=this._delegate)===null||i===void 0?void 0:i.getLogger(e,n,r)}}const _g=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},sn=Symbol.for("io.opentelemetry.js.api.logs"),bt=_g;function gg(t,e,n){return r=>r===t?e:n}const ro=1;class Si{constructor(){this._proxyLoggerProvider=new no}static getInstance(){return this._instance||(this._instance=new Si),this._instance}setGlobalLoggerProvider(e){return bt[sn]?this.getLoggerProvider():(bt[sn]=gg(ro,e,Ua),this._proxyLoggerProvider.setDelegate(e),e)}getLoggerProvider(){var e,n;return(n=(e=bt[sn])===null||e===void 0?void 0:e.call(bt,ro))!==null&&n!==void 0?n:this._proxyLoggerProvider}getLogger(e,n,r){return this.getLoggerProvider().getLogger(e,n,r)}disable(){delete bt[sn],this._proxyLoggerProvider=new no}}const mg=Si.getInstance();class yg{constructor(e,n,r){f(this,"instrumentationName");f(this,"instrumentationVersion");f(this,"_config",{});f(this,"_tracer");f(this,"_meter");f(this,"_logger");f(this,"_diag");f(this,"_wrap",Kt.wrap);f(this,"_unwrap",Kt.unwrap);f(this,"_massWrap",Kt.massWrap);f(this,"_massUnwrap",Kt.massUnwrap);this.instrumentationName=e,this.instrumentationVersion=n,this.setConfig(r),this._diag=C.createComponentLogger({namespace:e}),this._tracer=se.getTracer(e,n),this._meter=Jc.getMeter(e,n),this._logger=mg.getLogger(e,n),this._updateMetricInstruments()}get meter(){return this._meter}setMeterProvider(e){this._meter=e.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(e){this._logger=e.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){const e=this.init()??[];return Array.isArray(e)?e:[e]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(e){this._config={enabled:!0,...e}}setTracerProvider(e){this._tracer=e.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(e,n,r,i){if(e)try{e(r,i)}catch(s){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:n},s)}}}class vg extends yg{constructor(e,n,r){super(e,n,r),this._config.enabled&&this.enable()}}function io(t,e,n){let r,i;try{i=t()}catch(s){r=s}finally{return e(r,i),i}}function Sg(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}var z;(function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"})(z||(z={}));let vr;function bg(){return vr||(vr=document.createElement("a")),vr}function Eg(t,e){return e in t}function _e(t,e,n,r=!0){if(Eg(n,e)&&typeof n[e]=="number"&&!(r&&n[e]===0))return t.addEvent(e,n[e])}function so(t,e,n=!1,r){r===void 0&&(r=e[z.START_TIME]!==0),n||(_e(t,z.FETCH_START,e,r),_e(t,z.DOMAIN_LOOKUP_START,e,r),_e(t,z.DOMAIN_LOOKUP_END,e,r),_e(t,z.CONNECT_START,e,r),_e(t,z.SECURE_CONNECTION_START,e,r),_e(t,z.CONNECT_END,e,r),_e(t,z.REQUEST_START,e,r),_e(t,z.RESPONSE_START,e,r),_e(t,z.RESPONSE_END,e,r));const i=e[z.ENCODED_BODY_SIZE];i!==void 0&&t.setAttribute(oh,i);const s=e[z.DECODED_BODY_SIZE];s!==void 0&&i!==s&&t.setAttribute(ah,s)}function wg(t){return t.slice().sort((e,n)=>{const r=e[z.FETCH_START],i=n[z.FETCH_START];return r>i?1:r<i?-1:0})}function Da(){return typeof location<"u"?location.origin:void 0}function Tg(t,e,n,r,i=new WeakSet,s){const a=wn(t);t=a.toString();const c=Cg(t,e,n,r,i,s);if(c.length===0)return{mainRequest:void 0};if(c.length===1)return{mainRequest:c[0]};const h=wg(c);if(a.origin!==Da()&&h.length>1){let p=h[0],m=Ag(h,p[z.RESPONSE_END],n);const v=p[z.RESPONSE_END];return m[z.FETCH_START]<v&&(m=p,p=void 0),{corsPreFlightRequest:p,mainRequest:m}}else return{mainRequest:c[0]}}function Ag(t,e,n){const r=me(n),i=me(Ie(e));let s=t[1],a;const c=t.length;for(let h=1;h<c;h++){const p=t[h],m=me(Ie(p[z.FETCH_START])),v=me(Ie(p[z.RESPONSE_END])),S=r-v;m>=i&&(!a||S<a)&&(a=S,s=p)}return s}function Cg(t,e,n,r,i,s){const a=me(e),c=me(n);let h=r.filter(p=>{const m=me(Ie(p[z.FETCH_START])),v=me(Ie(p[z.RESPONSE_END]));return p.initiatorType.toLowerCase()===s&&p.name===t&&m>=a&&v<=c});return h.length>0&&(h=h.filter(p=>!i.has(p))),h}function wn(t){if(typeof URL=="function")return new URL(t,typeof document<"u"?document.baseURI:typeof location<"u"?location.href:void 0);const e=bg();return e.href=t,e}function Og(t,e){let n=e||[];return(typeof n=="string"||n instanceof RegExp)&&(n=[n]),wn(t).origin===Da()?!0:n.some(i=>Ea(t,i))}var Tn;(function(t){t.COMPONENT="component",t.HTTP_ERROR_NAME="http.error_name",t.HTTP_STATUS_TEXT="http.status_text"})(Tn||(Tn={}));const Ba=C.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});function xg(...t){if(t[0]instanceof URL||typeof t[0]=="string"){const e=t[1];if(!(e!=null&&e.body))return Promise.resolve();if(e.body instanceof ReadableStream){const{body:n,length:r}=Rg(e.body);return e.body=n,r}else return Promise.resolve(Mg(e.body))}else{const e=t[0];return e!=null&&e.body?e.clone().text().then(n=>Gr(n)):Promise.resolve()}}function Rg(t){if(!t.pipeThrough)return Ba.warn("Platform has ReadableStream but not pipeThrough!"),{body:t,length:Promise.resolve(void 0)};let e=0,n;const r=new Promise(s=>{n=s}),i=new TransformStream({start(){},async transform(s,a){const c=await s;e+=c.byteLength,a.enqueue(s)},flush(){n(e)}});return{body:t.pipeThrough(i),length:r}}function Lg(t){return typeof Document<"u"&&t instanceof Document}function Mg(t){if(Lg(t))return new XMLSerializer().serializeToString(document).length;if(typeof t=="string")return Gr(t);if(t instanceof Blob)return t.size;if(t instanceof FormData)return Ig(t);if(t instanceof URLSearchParams)return Gr(t.toString());if(t.byteLength!==void 0)return t.byteLength;Ba.warn("unknown body type")}const Pg=new TextEncoder;function Gr(t){return Pg.encode(t).byteLength}function Ig(t){let e=0;for(const[n,r]of t.entries())e+=n.length,r instanceof Blob?e+=r.size:e+=r.length;return e}const oo="0.200.0",Ng=300;var uo;const ao=typeof process=="object"&&((uo=process.release)==null?void 0:uo.name)==="node";class kg extends vg{constructor(n={}){super("@opentelemetry/instrumentation-fetch",oo,n);f(this,"component","fetch");f(this,"version",oo);f(this,"moduleName",this.component);f(this,"_usedResources",new WeakSet);f(this,"_tasksCount",0)}init(){}_addChildSpan(n,r){const i=this.tracer.startSpan("CORS Preflight",{startTime:r[z.FETCH_START]},se.setSpan(K.active(),n));so(i,r,this.getConfig().ignoreNetworkEvents),i.end(r[z.RESPONSE_END])}_addFinalSpanAttributes(n,r){const i=wn(r.url);n.setAttribute(rh,r.status),r.statusText!=null&&n.setAttribute(Tn.HTTP_STATUS_TEXT,r.statusText),n.setAttribute(th,i.host),n.setAttribute(nh,i.protocol.replace(":","")),typeof navigator<"u"&&n.setAttribute(ih,navigator.userAgent)}_addHeaders(n,r){if(!Og(r,this.getConfig().propagateTraceHeaderCorsUrls)){const i={};ue.inject(K.active(),i),Object.keys(i).length>0&&this._diag.debug("headers inject skipped due to CORS policy");return}if(n instanceof Request)ue.inject(K.active(),n.headers,{set:(i,s,a)=>i.set(s,typeof a=="string"?a:String(a))});else if(n.headers instanceof Headers)ue.inject(K.active(),n.headers,{set:(i,s,a)=>i.set(s,typeof a=="string"?a:String(a))});else if(n.headers instanceof Map)ue.inject(K.active(),n.headers,{set:(i,s,a)=>i.set(s,typeof a=="string"?a:String(a))});else{const i={};ue.inject(K.active(),i),n.headers=Object.assign({},i,n.headers||{})}}_clearResources(){this._tasksCount===0&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(n,r={}){if(xp(n,this.getConfig().ignoreUrls)){this._diag.debug("ignoring span as url matches ignored url");return}const i=(r.method||"GET").toUpperCase(),s=`HTTP ${i}`;return this.tracer.startSpan(s,{kind:fo.CLIENT,attributes:{[Tn.COMPONENT]:this.moduleName,[Zd]:i,[eh]:n}})}_findResourceAndAddNetworkEvents(n,r,i){let s=r.entries;if(!s.length){if(!performance.getEntriesByType)return;s=performance.getEntriesByType("resource")}const a=Tg(r.spanUrl,r.startTime,i,s,this._usedResources,"fetch");if(a.mainRequest){const c=a.mainRequest;this._markResourceAsUsed(c);const h=a.corsPreFlightRequest;h&&(this._addChildSpan(n,h),this._markResourceAsUsed(h)),so(n,c,this.getConfig().ignoreNetworkEvents)}}_markResourceAsUsed(n){this._usedResources.add(n)}_endSpan(n,r,i){const s=Nt(Date.now()),a=$r();this._addFinalSpanAttributes(n,i),setTimeout(()=>{var c;(c=r.observer)==null||c.disconnect(),this._findResourceAndAddNetworkEvents(n,r,a),this._tasksCount--,this._clearResources(),n.end(s)},Ng)}_patchConstructor(){return n=>{const r=this;return function(...s){const a=this,c=wn(s[0]instanceof Request?s[0].url:String(s[0])).href,h=s[0]instanceof Request?s[0]:s[1]||{},p=r._createSpan(c,h);if(!p)return n.apply(this,s);const m=r._prepareSpanData(c);r.getConfig().measureRequestSize&&xg(...s).then(A=>{A&&p.setAttribute(sh,A)}).catch(A=>{r._diag.warn("getFetchBodyLength",A)});function v(A,R){r._applyAttributesAfterFetch(A,h,R),r._endSpan(A,m,{status:R.status||0,statusText:R.message,url:c})}function S(A,R){r._applyAttributesAfterFetch(A,h,R),R.status>=200&&R.status<400?r._endSpan(A,m,R):r._endSpan(A,m,{status:R.status,statusText:R.statusText,url:c})}function w(A,R,I){try{const V=I.clone().body;if(V){const H=V.getReader(),$=()=>{H.read().then(({done:U})=>{U?S(A,I):$()},U=>{v(A,U)})};$()}else S(A,I)}finally{R(I)}}function L(A,R,I){try{v(A,I)}finally{R(I)}}return new Promise((A,R)=>K.with(se.setSpan(K.active(),p),()=>(r._addHeaders(h,c),r._callRequestHook(p,h),r._tasksCount++,n.apply(a,h instanceof Request?[h]:[c,h]).then(w.bind(a,p,A),L.bind(a,p,R)))))}}}_applyAttributesAfterFetch(n,r,i){const s=this.getConfig().applyCustomAttributesOnSpan;s&&io(()=>s(n,r,i),a=>{a&&this._diag.error("applyCustomAttributesOnSpan",a)})}_callRequestHook(n,r){const i=this.getConfig().requestHook;i&&io(()=>i(n,r),s=>{s&&this._diag.error("requestHook",s)})}_prepareSpanData(n){const r=$r(),i=[];if(typeof PerformanceObserver!="function")return{entries:i,startTime:r,spanUrl:n};const s=new PerformanceObserver(a=>{a.getEntries().forEach(h=>{h.initiatorType==="fetch"&&h.name===n&&i.push(h)})});return s.observe({entryTypes:["resource"]}),{entries:i,observer:s,startTime:r,spanUrl:n}}enable(){if(ao){this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()");return}Sg(fetch)&&(this._unwrap(gr,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(gr,"fetch",this._patchConstructor())}disable(){ao||(this._unwrap(gr,"fetch"),this._usedResources=new WeakSet)}}class Ug extends hg{constructor({serviceName:e,env:n,useXhr:r,dev:i,autoInstrumentations:s,samplingRatio:a,otlpBaseURL:c}){const p={url:(typeof c=="string"?c:bn[n]||n)+G_};r&&(p.headers={});const m=new q_(p),v=[new eg(m,{scheduledDelayMillis:1e3})];if(i&&v.push(new cg(new ag)),super({resource:Mn({[vi]:e,[Ma]:n}),sampler:new Vr(a),spanProcessors:v}),ue.setGlobalPropagator(Qc.MedusaJSCompositeTextMapPropagator),s.includes("fetch")){const S=Object.values(bn);new kg({ignoreUrls:S,propagateTraceHeaderCorsUrls:[new RegExp(".*")]}).setTracerProvider(this)}}}class Dg extends di{constructor(e={}){super(yi(e,y_,"v1/logs",{"Content-Type":"application/json"}))}}class Bg{constructor(e,n,r){f(this,"hrTime");f(this,"hrTimeObserved");f(this,"spanContext");f(this,"resource");f(this,"instrumentationScope");f(this,"attributes",{});f(this,"_severityText");f(this,"_severityNumber");f(this,"_body");f(this,"totalAttributesCount",0);f(this,"_isReadonly",!1);f(this,"_logRecordLimits");const{timestamp:i,observedTimestamp:s,severityNumber:a,severityText:c,body:h,attributes:p={},context:m}=r,v=Date.now();if(this.hrTime=Ie(i??v),this.hrTimeObserved=Ie(s??v),m){const S=se.getSpanContext(m);S&&zr(S)&&(this.spanContext=S)}this.severityNumber=a,this.severityText=c,this.body=h,this.resource=e.resource,this.instrumentationScope=n,this._logRecordLimits=e.logRecordLimits,this.setAttributes(p)}set severityText(e){this._isLogRecordReadonly()||(this._severityText=e)}get severityText(){return this._severityText}set severityNumber(e){this._isLogRecordReadonly()||(this._severityNumber=e)}get severityNumber(){return this._severityNumber}set body(e){this._isLogRecordReadonly()||(this._body=e)}get body(){return this._body}get droppedAttributesCount(){return this.totalAttributesCount-Object.keys(this.attributes).length}setAttribute(e,n){return this._isLogRecordReadonly()?this:n===null?this:e.length===0?(C.warn(`Invalid attribute key: ${e}`),this):!zs(n)&&!(typeof n=="object"&&!Array.isArray(n)&&Object.keys(n).length>0)?(C.warn(`Invalid attribute value set for key: ${e}`),this):(this.totalAttributesCount+=1,Object.keys(this.attributes).length>=this._logRecordLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this.droppedAttributesCount===1&&C.warn("Dropping extra attributes."),this):(zs(n)?this.attributes[e]=this._truncateToSize(n):this.attributes[e]=n,this))}setAttributes(e){for(const[n,r]of Object.entries(e))this.setAttribute(n,r);return this}setBody(e){return this.body=e,this}setSeverityNumber(e){return this.severityNumber=e,this}setSeverityText(e){return this.severityText=e,this}_makeReadonly(){this._isReadonly=!0}_truncateToSize(e){const n=this._logRecordLimits.attributeValueLengthLimit;return n<=0?(C.warn(`Attribute value limit must be positive, got ${n}`),e):typeof e=="string"?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(r=>typeof r=="string"?this._truncateToLimitUtil(r,n):r):e}_truncateToLimitUtil(e,n){return e.length<=n?e:e.substring(0,n)}_isLogRecordReadonly(){return this._isReadonly&&C.warn("Can not execute the operation on emitted log record"),this._isReadonly}}class $g{constructor(e,n){f(this,"instrumentationScope");f(this,"_sharedState");this.instrumentationScope=e,this._sharedState=n}emit(e){const n=e.context||K.active(),r=new Bg(this._sharedState,this.instrumentationScope,{context:n,...e});this._sharedState.activeProcessor.onEmit(r,n),r._makeReadonly()}}function Fg(){return{forceFlushTimeoutMillis:3e4,logRecordLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},includeTraceContext:!0}}function Hg(t){return{attributeCountLimit:t.attributeCountLimit??void 0??void 0??128,attributeValueLengthLimit:t.attributeValueLengthLimit??void 0??void 0??1/0}}class Vg{constructor(e,n){f(this,"processors");f(this,"forceFlushTimeoutMillis");this.processors=e,this.forceFlushTimeoutMillis=n}async forceFlush(){const e=this.forceFlushTimeoutMillis;await Promise.all(this.processors.map(n=>ba(n.forceFlush(),e)))}onEmit(e,n){this.processors.forEach(r=>r.onEmit(e,n))}async shutdown(){await Promise.all(this.processors.map(e=>e.shutdown()))}}class Gg{forceFlush(){return Promise.resolve()}onEmit(e,n){}shutdown(){return Promise.resolve()}}class jg{constructor(e,n,r){f(this,"resource");f(this,"forceFlushTimeoutMillis");f(this,"logRecordLimits");f(this,"loggers",new Map);f(this,"activeProcessor");f(this,"registeredLogRecordProcessors",[]);this.resource=e,this.forceFlushTimeoutMillis=n,this.logRecordLimits=r,this.activeProcessor=new Gg}}const zg="unknown";class qg{constructor(e={}){f(this,"_shutdownOnce");f(this,"_sharedState");const n=Cp({},Fg(),e),r=e.resource??Ip();this._sharedState=new jg(r,n.forceFlushTimeoutMillis,Hg(n.logRecordLimits)),this._shutdownOnce=new li(this._shutdown,this)}getLogger(e,n,r){if(this._shutdownOnce.isCalled)return C.warn("A shutdown LoggerProvider cannot provide a Logger"),ka;e||C.warn("Logger requested without instrumentation scope name.");const i=e||zg,s=`${i}@${n||""}:${(r==null?void 0:r.schemaUrl)||""}`;return this._sharedState.loggers.has(s)||this._sharedState.loggers.set(s,new $g({name:i,version:n,schemaUrl:r==null?void 0:r.schemaUrl},this._sharedState)),this._sharedState.loggers.get(s)}addLogRecordProcessor(e){this._sharedState.registeredLogRecordProcessors.length===0&&this._sharedState.activeProcessor.shutdown().catch(n=>C.error("Error while trying to shutdown current log record processor",n)),this._sharedState.registeredLogRecordProcessors.push(e),this._sharedState.activeProcessor=new Vg(this._sharedState.registeredLogRecordProcessors,this._sharedState.forceFlushTimeoutMillis)}forceFlush(){return this._shutdownOnce.isCalled?(C.warn("invalid attempt to force flush after LoggerProvider shutdown"),this._shutdownOnce.promise):this._sharedState.activeProcessor.forceFlush()}shutdown(){return this._shutdownOnce.isCalled?(C.warn("shutdown may only be called once per LoggerProvider"),this._shutdownOnce.promise):this._shutdownOnce.call()}_shutdown(){return this._sharedState.activeProcessor.shutdown()}}class Xg{export(e,n){this._sendLogRecords(e,n)}shutdown(){return Promise.resolve()}_exportInfo(e){var n,r,i;return{resource:{attributes:e.resource.attributes},instrumentationScope:e.instrumentationScope,timestamp:hp(e.hrTime),traceId:(n=e.spanContext)==null?void 0:n.traceId,spanId:(r=e.spanContext)==null?void 0:r.spanId,traceFlags:(i=e.spanContext)==null?void 0:i.traceFlags,severityText:e.severityText,severityNumber:e.severityNumber,body:e.body,attributes:e.attributes}}_sendLogRecords(e,n){for(const r of e)console.dir(this._exportInfo(r),{depth:3});n==null||n({code:ae.SUCCESS})}}class Kg{constructor(e){f(this,"_exporter");f(this,"_shutdownOnce");f(this,"_unresolvedExports");this._exporter=e,this._shutdownOnce=new li(this._shutdown,this),this._unresolvedExports=new Set}onEmit(e){var r,i;if(this._shutdownOnce.isCalled)return;const n=()=>wa._export(this._exporter,[e]).then(s=>{s.code!==ae.SUCCESS&&Re(s.error??new Error(`SimpleLogRecordProcessor: log record export failed (status ${s})`))}).catch(Re);if(e.resource.asyncAttributesPending){const s=(i=(r=e.resource).waitForAsyncAttributes)==null?void 0:i.call(r).then(()=>(this._unresolvedExports.delete(s),n()),Re);s!=null&&this._unresolvedExports.add(s)}else n()}async forceFlush(){await Promise.all(Array.from(this._unresolvedExports))}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}}class Wg{constructor(e,n){f(this,"_exporter");f(this,"_maxExportBatchSize");f(this,"_maxQueueSize");f(this,"_scheduledDelayMillis");f(this,"_exportTimeoutMillis");f(this,"_finishedLogRecords",[]);f(this,"_timer");f(this,"_shutdownOnce");this._exporter=e,this._maxExportBatchSize=(n==null?void 0:n.maxExportBatchSize)??void 0??512,this._maxQueueSize=(n==null?void 0:n.maxQueueSize)??void 0??2048,this._scheduledDelayMillis=(n==null?void 0:n.scheduledDelayMillis)??void 0??5e3,this._exportTimeoutMillis=(n==null?void 0:n.exportTimeoutMillis)??void 0??3e4,this._shutdownOnce=new li(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(C.warn("BatchLogRecordProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}onEmit(e){this._shutdownOnce.isCalled||this._addToBuffer(e)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}shutdown(){return this._shutdownOnce.call()}async _shutdown(){this.onShutdown(),await this._flushAll(),await this._exporter.shutdown()}_addToBuffer(e){this._finishedLogRecords.length>=this._maxQueueSize||(this._finishedLogRecords.push(e),this._maybeStartTimer())}_flushAll(){return new Promise((e,n)=>{const r=[],i=Math.ceil(this._finishedLogRecords.length/this._maxExportBatchSize);for(let s=0;s<i;s++)r.push(this._flushOneBatch());Promise.all(r).then(()=>{e()}).catch(n)})}_flushOneBatch(){return this._clearTimer(),this._finishedLogRecords.length===0?Promise.resolve():new Promise((e,n)=>{ba(this._export(this._finishedLogRecords.splice(0,this._maxExportBatchSize)),this._exportTimeoutMillis).then(()=>e()).catch(n)})}_maybeStartTimer(){this._timer===void 0&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedLogRecords.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(e=>{Re(e)})},this._scheduledDelayMillis),this._timer,void 0)}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}_export(e){const n=()=>wa._export(this._exporter,e).then(i=>{i.code!==ae.SUCCESS&&Re(i.error??new Error(`BatchLogRecordProcessor: log record export failed (status ${i})`))}).catch(Re),r=e.map(i=>i.resource).filter(i=>i.asyncAttributesPending);return r.length===0?n():Promise.all(r.map(i=>{var s;return(s=i.waitForAsyncAttributes)==null?void 0:s.call(i)})).then(n,Re)}}class Yg extends Wg{constructor(n,r){super(n,r);f(this,"_visibilityChangeListener");f(this,"_pageHideListener");this._onInit(r)}onShutdown(){typeof document>"u"||(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}_onInit(n){(n==null?void 0:n.disableAutoFlushOnDocumentHide)===!0||typeof document>"u"||(this._visibilityChangeListener=()=>{document.visibilityState==="hidden"&&this.forceFlush()},this._pageHideListener=()=>{this.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}}class Jg extends qg{constructor({serviceName:e,env:n,useXhr:r,dev:i,otlpBaseURL:s}){super({resource:Mn({[vi]:e,[Ma]:n})});const c={url:(typeof s=="string"?s:bn[n]||n)+j_};r&&(c.headers={});const h=new Dg(c);this.addLogRecordProcessor(new Yg(h,{scheduledDelayMillis:1e3})),i&&this.addLogRecordProcessor(new Kg(new Xg))}}const Qg=new RegExp("[^a-zA-Z_][^a-zA-Z0-9_]*");function $m(t){return typeof t=="object"&&t!=null&&t.connection!=null&&typeof t.connection=="object"&&Array.isArray(t.events)&&Array.isArray(t.navigations)&&typeof t.pathname=="string"}function Zg(t){return Qg.test(t)?(C.warn(`Metric name ${t} contains invalid characters and will be dropped.
    Service Names and metric names must conform to the following regex %c[a-zA-Z_][a-zA-Z0-9_]*`,"color:red"),!1):!0}const em="opentelemetry-js-MedusaJS-web";class tm{constructor({serviceName:e,prefixMetric:n=!1,metrics:r={},onRecord:i,meterProvider:s,loggerProvider:a,tracerProvider:c}){if(this.serviceName=void 0,this.prefixMetric=void 0,this.meterProvider=void 0,this.loggerProvider=void 0,this.tracerProvider=void 0,this.metrics=new Map,this.recordListeners=new Set,!e)throw new Error("Service name is required.");if(this.serviceName=e,this.prefixMetric=n,i&&this.addOnRecord(i),!s)throw new Error("MeterProvider is required.");this.meterProvider=s,this.tracerProvider=c,this.loggerProvider=a,this.register(r)}getMeterProvider(){return this.meterProvider}getTracerProvider(){return this.tracerProvider}getLoggerProvider(){return this.loggerProvider}record(e,n,r){const i=this.metrics.get(e);if(!i)throw new Error(`Service ${this.serviceName} has no metrics registered for name: ${e}. Can't record value for unknown metric.`);i(n,r)}registerMetric(e,{type:n,...r}){if(this.metrics.has(e))return;const i=this.meterProvider.getMeter(em),s=this.prefixMetric?`${this.serviceName}_${e}`:e;if(!Zg(s))return;const a=()=>{switch(n){case rt.Counter:return i.createCounter(s,r);case rt.UpDownCounter:return i.createUpDownCounter(s,r);case rt.Histogram:return"boundaries"in r&&r.boundaries&&(r.advice={explicitBucketBoundaries:r.boundaries}),i.createHistogram(s,r)}};this.metrics.set(e,(c,h)=>{const p=a(),m=(v,S)=>{const[w,L]=this.notifyRecordListeners(e,v,{...S});"record"in p?p.record(w,L):p.add(w,L),this.meterProvider.forceFlush({}).catch(A=>{C.warn("Error flushing metrics",A)})};m(c,h),this.metrics.set(e,m)})}register(e){Object.entries(e).forEach(([n,r])=>{this.registerMetric(n,r)})}addOnRecord(e){return this.recordListeners.add(e),()=>{this.recordListeners.delete(e)}}removeOnRecord(e){this.recordListeners.delete(e)}shutdown(){return this.metrics.clear(),this.recordListeners.clear(),this.meterProvider.shutdown().then(()=>{this.tracerProvider&&this.tracerProvider.shutdown(),this.loggerProvider&&this.loggerProvider.shutdown()})}notifyRecordListeners(e,n,r){return Array.from(this.recordListeners).reduce((i,s)=>s(e,...i)||i,[n,r])}}class nm extends tm{constructor({throttleLimit:e=5e3,env:n="local",serviceName:r,prefixMetric:i=!1,metrics:s={},onRecord:a,meterProvider:c,tracerProvider:h,loggerProvider:p,useXhr:m=!1,dev:v=!1,enableDefaultTracer:S=!1,samplingRatio:w=.1,autoInstrumentations:L=[],enableDefaultLogger:A=!1,otlpBaseURL:R}){C.setLogger(new Zc,{logLevel:["production","staging"].includes(n)?ts.ERROR:ts.INFO,suppressOverrideMessage:!0});const I=[];Object.entries(s).forEach(([$,U])=>{if(U.type===rt.Histogram&&!("boundaries"in U&&U.boundaries)){const q=i?`${r}_${$}`:$;I.push({instrumentName:q,instrumentType:G.HISTOGRAM,aggregation:{type:ce.EXPONENTIAL_HISTOGRAM}})}});const B=c??new z_({serviceName:r,env:n,throttleLimit:e,useXhr:m,dev:v,otlpBaseURL:R,views:I});let V;h?V=h:S&&(V=new Ug({serviceName:r,env:n,useXhr:m,dev:v,autoInstrumentations:L,samplingRatio:w,otlpBaseURL:R}));let H;p?H=p:A&&(H=new Jg({serviceName:r,env:n,useXhr:m,dev:v,otlpBaseURL:R})),super({serviceName:r,meterProvider:B,tracerProvider:V,loggerProvider:H,prefixMetric:i,metrics:s,onRecord:a})}shutdown(){return C.disable(),super.shutdown()}}var $a=(t=>(t.GiveawaysShow="shopweb_shop_cash_giveaways_web_show",t.GiveawaysClaim="shopweb_shop_cash_giveaways_web_claim",t.FetchTimeout="shopweb_fetch_timeout",t.FetchError="shopweb_fetch_error",t.MissingMedusaJSYCookieCount="shopweb_missing_MedusaJS_y_cookie_count",t.MissingMedusaJSSCookieCount="shopweb_missing_MedusaJS_s_cookie_count",t.AppOpen="shopweb_app_open",t.AdsClick="shopweb_ads_click",t.AdsError="shopweb_ads_error",t.ShippingInfoRender="shopweb_pdp_shipping_info_render_count",t.ThankYouPagePredictionRendered="shopweb_thank_you_page_prediction_rendered",t.AccountPageVisit="shopweb_account_page_visit",t.AiChatMessageFeedback="shopweb_ai_chat_message_feedback",t.AiChatMessageHttpStatus="shopweb_ai_chat_message_http_status",t.AiChatAdaptiveUiReceived="shopweb_ai_chat_adaptive_ui_received",t.AiChatStreamEndedIncomplete="shopweb_ai_chat_stream_ended_incomplete",t.AiChatStreamFailed="shopweb_ai_chat_stream_failed",t.AiChatStreamRecoveryStarted="shopweb_ai_chat_stream_recovery_started",t.AiChatStreamRecoverySucceeded="shopweb_ai_chat_stream_recovery_succeeded",t.AiChatStreamRecoveryFailed="shopweb_ai_chat_stream_recovery_failed",t.AiChatStreamManualReload="shopweb_ai_chat_stream_manual_reload",t.AiChatNewMessageWhileStreaming="shopweb_ai_chat_new_message_while_streaming",t.AnalyticsCookieInvalidUuid="shopweb_analytics_cookie_invalid_uuid",t.AnalyticsCookieEncodeError="shopweb_analytics_cookie_encode_error",t.AnalyticsCookieDecodeError="shopweb_analytics_cookie_decode_error",t.AnalyticsCookieUpdateError="shopweb_analytics_cookie_update_error",t.CheckoutReceiptTimeout="shopweb_checkout_receipt_timeout",t.OrderIdTimeout="shopweb_order_id_timeout",t.ApiCollectRequest="shopweb_api_collect_request",t.OmniboxItemSelected="shopweb_omnibox_item_selected",t.OmniboxSubmit="shopweb_omnibox_submit",t))($a||{}),Fa=(t=>(t.AddToCart="shopweb_pdp_add_to_cart_result",t.BuyNow="shopweb_pdp_buy_now_result",t.Checkout="shopweb_cart_checkout_result",t.Offers="shopweb_offers_offers_list_result",t.Unauthorized="shopweb_request_unauthorized_count",t.SignInInit="shopweb_sign_in_init_count",t.SignInSuccess="shopweb_sign_in_success_count",t.SignOut="shopweb_sign_out_count",t.DeleteAccountInit="shopweb_delete_account_init_count",t.DeleteAccountSuccess="shopweb_delete_account_success_count",t.GraphqlGenricError="shopweb_graphqlError_generic_count",t.GraphqlTimeoutError="shopweb_graphqlError_timeout_count",t.ShopAdsOffersCompactWithoutContent="shopweb_shop_ads_offers_compact_without_content",t.AiChatMessageStreamingTotalDuration="shopweb_ai_chat_message_streaming_total_duration",t.AiChatMessageRenderTime="shopweb_ai_chat_message_render_time",t.AiChatStreamRecoveryDuration="shopweb_ai_chat_stream_recovery_duration",t))(Fa||{});const rm="shop-web",im=2500,sm=Object.values($a).reduce((t,e)=>(t[e]={type:rt.Counter},t),{}),om=Object.values(Fa).reduce((t,e)=>(t[e]={type:rt.Histogram},t),{}),am={serviceName:rm,throttleLimit:im,env:jr().APP_ENV==="production"?"production":"staging",prefixMetric:!1,useXhr:!0,metrics:{...sm,...om}},co=new nm(am);function Fm(t,e){return Ha({name:t,type:"increment",tags:e})}function Hm(t,e,n=1){return Ha({name:t,type:"distribution",value:n,tags:e})}async function Ha(t){if(jr().APP_ENV==="development")return console.log("statsd metric: ",t),!0;try{const e=t.tags?Object.entries(t.tags).reduce((n,[r,i])=>(n[r]=i.toString(),n),{}):void 0;switch(t.type){case"increment":await co.record(t.name,1,e);break;case"distribution":await co.record(t.name,t.value,e);break}return!0}catch(e){return cd.notify(e),!1}}export{xm as A,ot as B,$a as C,Fa as D,hl as E,Lm as F,Tm as G,Rm as H,vm as I,km as J,Nm as K,ym as L,rt as M,wm as N,Em as P,Cm as R,Ke as S,Am as T,Gu as X,_m as a,Oo as b,Le as c,Hm as d,re as e,cd as f,bm as g,Om as h,Fm as i,Mm as j,Pm as k,Im as l,Nu as m,Po as n,nd as o,gm as p,mm as q,Sm as r,$m as s,nm as t,co as u,dm as v,rm as w,Um as x,pm as y,pl as z};
//# sourceMappingURL=statsdClient-CCQ7Es9D.js.map
