import{j as s}from"./jsx-runtime-D_zvdyIk.js";import{F as is}from"./FavoriteVariantProductCard-Be4w2rg1.js";import{X as Fe,Y as fe,B as H,Z as ie,_ as os,$ as cs,a0 as ls,a1 as ds,S as vt,a2 as Vt,c as us,a3 as oe,a4 as ce,a5 as hs,a6 as Be,a7 as ps,a8 as ms,a9 as fs,aa as xs,ab as vs,ac as ys,j as gs,ad as bs,ae as Is,af as Cs,ag as ks,ah as ws}from"./toFeedSection-HH8g53oo.js";import{r as p,a as Re,h as js,f as Ss}from"./chunk-DQRVZFIR-mrH3D8v7.js";import{E as T,I as G}from"./types-aSuMwFxz.js";import{I as V}from"./Icon-Vc_yr2r6.js";import{T as L}from"./Text-BrMatKQv.js";import{T as z}from"./TrackingPixel-D8humLZO.js";import{u as Xe}from"./useActions-CMwTuc_r.js";import{b as de,a as Ft,g as X}from"./getAdMetadata-crX2O_21.js";import{e as Bt,P as Ee,a as Ne}from"./ProductCardProductTitle-GOnUA0Qh.js";import{u as se,e as Ns,b as st,s as B,a as Ts}from"./useMonorail-J6WwGwSW.js";import{S as Ps,E as zt,a as ue,u as at,h as _s,i as As}from"./ConversationProvider-BNoOA22x.js";import{i as P}from"./i18nConfig-CLr-UH7w.js";import{f as Rs,b as Es}from"./formatOrderStatus-SQ6Lrk43.js";import{f as Mt}from"./MoneyUtils-CzooDnh_.js";import{b as nt,e as Os,c as Ls,d as Ds,a as Ht,P as Vs}from"./ProductCard-Dp2OWc-v.js";import{P as Oe}from"./ProductCardReviewStars-CUQvKsLP.js";import{I as J}from"./IconButton-D2NlWcx2.js";import{c as w,t as Fs,P as ze}from"./cn-yu2yf51J.js";import{P as le}from"./ProductCardImage-D-YSW4cr.js";import{m as Bs,_ as zs,s as Ms}from"./index-BYuwUbLY.js";import{C as Ge,u as rt}from"./Toast-Bb3RYazJ.js";import{I as Ce}from"./Image-Cc02ywVl.js";import{L as Q}from"./Link-CnJfyO2i.js";import{u as Ut,U as Wt}from"./AuthenticationProvider-9RtBMSxF.js";import{c as Hs,T as Us,R as Ws,g as $s,a as Xs,S as yt}from"./StoreThemeProvider-jgugnGur.js";import{i as ne,C as re,d as xe,D as ve,j as gt,k as bt,f as Me}from"./statsdClient-CCQ7Es9D.js";import{u as Gs}from"./useMediaQuery-bbysqcAD.js";import{B as qs,d as U}from"./deviceUtils-BLIhItqY.js";import{d as ee}from"./FilterUtils-8PUBFIQ_.js";import{B as Te}from"./Button-D4K8aSAG.js";import{M as te}from"./MerchantLogo-USLrWjfI.js";import{c as it}from"./createProductUrl-D0TYWuIE.js";import{B as $t}from"./Badge-D9a9Zb-D.js";import{R as qe,S as Ks}from"./StoreMediaBackground-BXCp4zzg.js";import{C as Qs}from"./index-sfFT87ua.js";import{g as ye,S as ge}from"./useShoppingEvents-fSQONDgU.js";import{T as Ys}from"./Tile-CMWVJm8v.js";import{u as Pe}from"./useMutation-BEBlGsA2.js";import{M as Zs}from"./MerchantCard-DfeHZkIJ.js";import{S as Xt}from"./StoreLink-CT-7O9Ag.js";import{S as Js}from"./ShopSpinner-BY5XJj_u.js";import{u as he}from"./useTranslation-DjeLP5O7.js";import{a as Gt}from"./TypeUtils-ivZuohSF.js";import{u as ea,S as ta}from"./useTriggerLogInWithShop-D9VKR_6P.js";import{c as sa}from"./createGuestUser-FgpzrQxO.js";import{a as _e,T as Ae}from"./appendUTMParams-kkZVEnAJ.js";import{L as aa}from"./LocalizableError-DuJTnl85.js";import{m as na}from"./PayAddressUtils-BUNh7j1F.js";import{u as ra}from"./usePayAddresses-BJssbwmF.js";import{d as ia}from"./CreateCheckoutWithLineItems-LNvsaANZ.js";import{u as oa}from"./Meta-DnThQDCl.js";import{s as ca}from"./FeedCard.module-CpXtNHjC.js";import{n as la}from"./ratingsUtils-C4036l3G.js";import{R as da}from"./index-DxO_0hRA.js";import{I as It}from"./ImageUtils-D5ojfjzT.js";import{R as ua,T as ha,P as pa,C as ma}from"./index-BCHzanGi.js";import{S as fa,A as xa}from"./ShelfSectionFragment-junY_xzu.js";var qt=(e=>(e.SHOW_MERCHANT_BOOKEND="SHOW_MERCHANT_BOOKEND",e))(qt||{}),Kt=(e=>(e.AVATAR="AVATAR",e.REVIEWS="REVIEWS",e.SHOP_CASH_OFFERS="SHOP_CASH_OFFERS",e))(Kt||{}),Ke=(e=>(e.CASH_BACK="CASH_BACK",e.SHOP_CASH="SHOP_CASH",e))(Ke||{}),Z=(e=>(e.BODY_SMALL="BODY_SMALL",e.BRAND_TEXT_LARGE="BRAND_TEXT_LARGE",e.BRAND_TEXT_SMALL="BRAND_TEXT_SMALL",e.CAPTION="CAPTION",e.CAPTION_MEDIUM="CAPTION_MEDIUM",e))(Z||{}),q=(e=>(e.L="L",e.M="M",e.S="S",e.XL="XL",e.XS="XS",e.XXS="XXS",e))(q||{}),Qt=(e=>(e.CART_SYNC="CART_SYNC",e.OTHER="OTHER",e.USER="USER",e))(Qt||{}),ke=(e=>(e.BODY_SMALL="BODY_SMALL",e.BRAND_TEXT_LARGE="BRAND_TEXT_LARGE",e.BRAND_TEXT_SMALL="BRAND_TEXT_SMALL",e.CAPTION="CAPTION",e.CAPTION_MEDIUM="CAPTION_MEDIUM",e))(ke||{});function Y(e){var t,a;return{typeaheadSessionId:((t=e.current)==null?void 0:t.id)||"",typeaheadMicroSessionId:((a=e.current)==null?void 0:a.span.id)||""}}function va(){const{reportEvent:e}=se(),t=p.useCallback(({sessionRef:i})=>{var l;(l=i.current)==null||l.addSpan(),e({schemaId:"product_search_typeahead_query_change/5.0",payload:{...Y(i)}})},[e]),a=p.useCallback(({query:i,sessionRef:l})=>{e({schemaId:"product_search_typeahead_session_start/3.0",payload:{...Y(l),queryString:i||""}})},[e]),n=p.useCallback(({results:i,sessionRef:l})=>{e({schemaId:"product_search_typeahead_results_load/4.0",payload:{...Y(l),results:i}})},[e]),c=p.useCallback(({queryString:i,selectedQuery:l,selectedPosition:r,selectedType:u,selectedId:f,sessionRef:m})=>{e({schemaId:"product_search_typeahead_action/4.0",payload:{...Y(m),selectedId:f,queryString:i,selectedType:u,selectedQuery:l,selectedPosition:r,selectedQuerySource:"typeahead"}})},[e]),o=p.useCallback(({selectedQuery:i,selectedType:l,selectedId:r,sessionRef:u})=>{e({schemaId:"product_search_null_state_action/3.0",payload:{...Y(u),selectedQuery:i,selectedType:l,selectedSource:"recent_searches",selectedId:r}})},[e]),d=p.useCallback(({suggestions:i,sessionRef:l})=>{e({schemaId:"product_search_null_state_suggestions_load/3.0",payload:{...Y(l),suggestions:i}})},[e]);return{searchTypeaheadChange:t,searchTypeaheadSessionStart:a,searchTypeaheadResultsLoad:n,searchTypeaheadAction:c,searchNullStateAction:o,searchNullStateSuggestionsLoad:d}}function ya(e){const a=Date.now()-e;if(a<60*1e3)return P.t("shopAI:ThreadList.JustNow");if(a<60*60*1e3){const c=Math.floor(a/6e4);return P.t("shopAI:ThreadList.MinutesAgo",{minutes:c})}const n=new Date(e);return a>24*60*60*1e3?n.toLocaleDateString("en-US",{month:"long",day:"numeric"}):n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}function ga(e){return e.__typename==="SearchQueryPredictionShop"}const ba=()=>{const{searchParams:e,setSearchParams:t,searchParamsSize:a}=Hs(),[n,c]=p.useState(a>1),o=p.useCallback((l,r=!1)=>{let u=null;return e.forEach((f,m)=>{m.toLowerCase()===l.toLowerCase()&&(u=r?f.toLowerCase():f)}),e.size>1?!n&&c(!0):n&&c(!1),u},[n,e]),d=p.useCallback((l,r=!1)=>{const u=[];return e.forEach((f,m)=>{m.toLowerCase()===l.toLowerCase()&&u.push(r?f.toLowerCase():f)}),u},[e]),i=p.useCallback(l=>{let r=!1;e.forEach((u,f)=>{f.toLowerCase()===l.toLowerCase()&&(r=!0,e.delete(f))}),r&&t(e)},[e,t]);return p.useMemo(()=>({get:o,getAll:d,delete:i,isFilterSelected:n}),[i,d,o,n])},Ia="/search/results?",Ca=()=>{const e=Re(),{pageType:t}=Ns(),a=js(),n=ba();return p.useCallback(({searchReferrer:o,referrerSession:d,stateValues:i,params:l,preserveLocation:r,preventScrollReset:u=!1})=>{const f=new URLSearchParams(l);r&&["cpdp","upsellSearchQuery","utm_source","variantId"].forEach(b=>{const I=n.get(b);I&&f.set(b,I),b==="upsellSearchQuery"&&f.get("query")&&f.delete("query")});const m=`${a==null?void 0:a.pathname}?${f.toString()}`,h=r?m:Ia+l;e(h,{state:{referralPageType:t,searchReferrer:o,referrerSession:d,serpSession:new Us,...i},preventScrollReset:u})},[a==null?void 0:a.pathname,e,n,t])},Yt=p.createContext(void 0);function Kr({children:e,typeAheadSessionRef:t}){const a=Re(),{userAuthState:n}=Ut(),c=Ca(),o=n!==Wt.Anonymous,{searchTypeaheadAction:d}=va(),i=p.useCallback((m,h)=>{m&&t&&d&&d({sessionRef:t,queryString:m.searchTerm,selectedPosition:m.index,...h})},[t,d]),l=p.useCallback((m,h)=>{ga(m)?(ne(re.OmniboxItemSelected,{type:"shop"}),i(h,{selectedType:"shop",selectedId:Number(m.shop.id),selectedQuery:m.shop.name}),a(`/m/${m.shop.defaultHandle}`)):(ne(re.OmniboxItemSelected,{type:"query"}),i(h,{selectedType:"query",selectedQuery:m.query}),c({params:`query=${encodeURIComponent(m.query)}`,searchReferrer:Ps.SearchBar}))},[a,c,i]),r=p.useCallback((m,h)=>{if(!m.trim())return;ne(re.OmniboxItemSelected,{type:"search"}),i(h,{selectedType:"query",selectedQuery:m});const g=encodeURIComponent(m);a(o?`/threads?message=${g}`:`/search/results?query=${g}`)},[a,o,i]),u=p.useCallback(m=>{m.trim()&&(ne(re.OmniboxItemSelected,{type:"thread"}),a(`/threads?conversationId=${m}`))},[a]),f=p.useCallback((m,h)=>{var g,b,I,S,_,A;switch(m.__typename){case Fe.MerchantCard:{const k=m;ne(re.OmniboxItemSelected,{type:"merchant_card"}),i(h,{selectedType:"shop",selectedQuery:((g=k.shop)==null?void 0:g.name)||(h==null?void 0:h.searchTerm)||"",selectedId:(b=k.shop)!=null&&b.id?Number(k.shop.id):void 0}),(I=k.shop)!=null&&I.defaultHandle&&a(`/m/${k.shop.defaultHandle}`);break}case Fe.ThreadCard:{const k=m;if(i(h,{selectedType:"thread",selectedQuery:((S=k.conversation)==null?void 0:S.title)||(h==null?void 0:h.searchTerm)||""}),(_=k.conversation)!=null&&_.id){const y=zt(k.conversation.id);y&&u(y)}break}case Fe.RichText:{const y=(A=m.segments)==null?void 0:A.find(j=>j.text&&j.text.trim());y!=null&&y.text&&r(y.text,h);break}}},[a,r,u,i]);return s.jsx(Yt.Provider,{value:{navigateToSearch:r,navigateToThreads:u,navigateByContentNode:f,navigateByPrediction:l},children:e})}function ot(){return p.useContext(Yt)||null}const ka={s:"h-[34px]",l:"h-[45px]"};function wa({size:e="s"}){return s.jsx("div",{"data-testid":"countdown-details-placeholder",className:ka[e]})}const Zt={s:"text-bodyTitleSmall",l:"text-bodyTitleSmall sm:text-bodyTitleLarge"},ja={s:"w-[45px] p-space-8",l:"w-[55px] px-space-6 py-[10px] sm:p-space-12"},Sa=({text:e,size:t="s"})=>s.jsxs("div",{className:w("relative flex flex-row items-center justify-center rounded-radius-8",ja[t]),children:[s.jsx(L,{className:w("z-10 font-sans-medium text-text-inverse",Zt[t]),children:e}),s.jsx("div",{className:"absolute inset-0 z-0 overflow-hidden rounded-radius-8 bg-bg-overlay-fixed-dark-20",style:{backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"}})]}),Na=1e3,Qe=60,Ye=Qe*60,Ct=Ye*24;function kt(e){const t=Date.now(),a=Math.floor((e.getTime()-t)/Na);if(a<=0){const l=be(0);return{timeRemaining:{hours:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.Hours",{value:l}),minutes:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.Minutes",{value:l}),seconds:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.Seconds",{value:l})},isCountdownOver:!0}}const n=Math.floor(a/Ct),c=Math.floor(a%Ct/Ye),o=n*24+c,d=Math.floor(a%Ye/Qe),i=Math.floor(a%Qe);return{timeRemaining:{hours:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.Hours",{value:be(o)}),minutes:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.Minutes",{value:be(d)}),seconds:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.Seconds",{value:be(i)})},isCountdownOver:!1}}function be(e){return e.toString().padStart(2,"0")}const Ta=({to:e,alignCenter:t,size:a="s"})=>{const[n,c]=p.useState(kt(e)),{hours:o,minutes:d,seconds:i}=n.timeRemaining,l=n.isCountdownOver;return p.useEffect(()=>{if(l)return;const r=setInterval(()=>{const u=kt(e);c(u),u||clearInterval(r)},1e3);return()=>clearInterval(r)},[l,e]),s.jsx("div",{"data-testid":"countdown-timer",className:w("flex flex-col gap-space-8",t&&"flex items-center"),children:s.jsx("div",{className:"flex flex-row items-center gap-space-4",children:[o,d,i].map((r,u,f)=>s.jsxs("div",{className:"flex items-center gap-space-4",children:[s.jsx(Sa,{text:r,size:a}),u<f.length-1&&s.jsx(L,{className:w("font-sans-medium",Zt[a],"text-text-inverse"),children:P.t("Home.MarketingEvent.BeautyAndWellnessWeek.CountdownTimer.TimeFormat")})]},u))})})},Pa={s:"text-caption sm:text-bodyTitleSmall",l:"text-bodyTitleSmall sm:text-bodyTitleLarge"},_a={s:"gap-space-4 px-space-8 py-[10px] sm:p-space-8",l:"gap-[10px] p-space-8 sm:p-space-12"},Aa=({text:e,size:t="s"})=>s.jsxs("div",{"data-testid":"end-date-info",className:w("relative flex flex-row items-center justify-center self-start rounded-radius-8 ",_a[t]),children:[s.jsx("div",{className:"absolute inset-0 z-10 size-full overflow-hidden rounded-radius-8 bg-bg-overlay-fixed-dark-20",style:{backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"}}),s.jsx(V,{name:"clock",size:"m",className:"z-10 font-sans-medium text-text-inverse"}),s.jsx(L,{variant:"bodyTitleSmall",className:w("z-10 font-sans-medium text-text-inverse",Pa[t]),children:e})]}),Ra=1e3,Ea=60*60*24*2;function Oa(e){const a={weekday:"long",hour:"numeric",minute:"numeric",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,timeZoneName:"short"},n=new Intl.DateTimeFormat("en-US",a).format(e).replace(","," •");return P.t("Home.MarketingEvent.BeautyAndWellnessWeek.EndDateInfo",{date:n})}function La(e){const t=Date.now();return Math.floor((e.getTime()-t)/Ra)>Ea}const Da=({endDate:e,textOverride:t})=>{const a=p.useMemo(()=>{if(!e)return;const c=new Date(e||"");if(!Number.isNaN(c.getDate()))return c},[e]),n=p.useMemo(()=>{if(a)return{isMoreThanTwoDaysRemaining:La(a),formattedEndDateInfo:Oa(a)}},[a]);return!a||!n?null:s.jsx(Qs,{fallback:s.jsx(wa,{size:"s"}),children:()=>s.jsx("div",{className:"flex","data-testid":"time-component",children:n.isMoreThanTwoDaysRemaining||t?s.jsx(Aa,{text:t||n.formattedEndDateInfo,size:"s"}):s.jsx(Ta,{to:a,size:"s"})})})};var K=(e=>(e.XXS="xxs",e.XS="xs",e.S="s",e.M="m",e.L="l",e.XL="xl",e))(K||{});const Va={[q.XXS]:"xxs",[q.XS]:"xs",[q.S]:"s",[q.M]:"m",[q.L]:"l",[q.XL]:"xl"},Fa="m";function Ba(e){return Va[e]||Fa}function za(e,t){const n=!((t===K.S&&!(e!=null&&e.includes(fe.PRICE)))??!1),c=(e==null?void 0:e.includes(fe.SHOP_NAME))??!1,o=(e==null?void 0:e.includes(fe.PRICE))??!1,d=(e==null?void 0:e.includes(fe.REVIEWS))??!1;return{showProductName:n,showShopName:c,showPrice:o,showReviews:d}}const Jt=p.createContext({feedId:void 0,selectedItemIndex:void 0,onItemClick:void 0,onHoverIndex:void 0,onMouseLeave:void 0,theme:{sectionCardBackgroundColor:void 0}}),pe=()=>p.useContext(Jt),Qr=({children:e,feedId:t,selectedItemIndex:a,onHoverIndex:n,onMouseLeave:c,theme:o})=>{const d=p.useMemo(()=>({feedId:t,selectedItemIndex:a,onHoverIndex:n,onMouseLeave:c,theme:o}),[t,a,n,c,o]);return s.jsx(Jt.Provider,{value:d,children:e})},M=()=>{const{reportEvent:e}=se(),t=st(),{feedId:a}=pe(),{trackingValues:{sectionId:n,sectionYPos:c,sectionFormat:o,metadata:d,subject:i,sectionDisplayOptions:l}}=de(),{shopAdOnPress:r,shopAdOnView:u}=Ft(),f=({brokerId:x,xPos:v,yPos:C,adMetadata:N})=>{N&&u({adResponseId:N==null?void 0:N.adResponseId,adType:N==null?void 0:N.adType,campaignCountryCode:N==null?void 0:N.campaignCountryCode,campaignId:N==null?void 0:N.campaignHandle,brokerId:parseInt(x,10),xPos:v,yPos:C})},m=({brokerId:x,adMetadata:v})=>{v&&r({adResponseId:v==null?void 0:v.adResponseId,adType:v==null?void 0:v.adType,campaignId:v==null?void 0:v.campaignHandle,brokerId:parseInt(x,10)})},h=()=>{var x,v,C;return{sectionId:d.sectionId,subSectionId:d.subSectionId,sectionFormat:o,sectionYPos:c,feedId:a,subjectId:i==null?void 0:i.subjectId,subjectType:i==null?void 0:i.subjectKind,brokerId:i&&H(i)?parseInt(i.shop.id,10):void 0,algorithmId:(x=d.algorithm)==null?void 0:x.name,algorithmScore:((v=d.algorithm)==null?void 0:v.score)??void 0,algorithmVersion:((C=d.algorithm)==null?void 0:C.version)??void 0,displayOptions:l}},g=x=>{var C,N,E,D,O,F,$,ae;const{product:v}=x;return{...h(),xPos:x.xPos,yPos:x.yPos??0,entityId:v.id,entityType:T.Product,brokerId:parseInt(v.shop.id,10),variantId:Bt(v.defaultVariantId),...x.showReviews&&{totalReviews:(C=v.reviewAnalytics)==null?void 0:C.count,averageRating:((N=v.reviewAnalytics)==null?void 0:N.averageRating)||void 0},...((E=x.algorithm)==null?void 0:E.name)&&{algorithmId:(D=x.algorithm)==null?void 0:D.name},...((O=x.algorithm)==null?void 0:O.score)&&{algorithmScore:(F=x.algorithm)==null?void 0:F.score},...(($=x.algorithm)==null?void 0:$.version)&&{algorithmVersion:(ae=x.algorithm)==null?void 0:ae.version}}},b=x=>{const v={...g(x),isRestricted:x.product.isRestricted,isReferral:x.product.referral,MedusaJSShopId:B(x.product.shop.MedusaJSId)},C=x.product.shopCashIncentive?X(x.product.shopCashIncentive):null;e({schemaId:"shop_app_entity_recommendation_impressions/6.11",payload:v}),t.entityImpression({...v,adResponseId:C==null?void 0:C.adResponseId,campaignId:C==null?void 0:C.campaignHandle}),x.product.shopCashIncentive&&f({brokerId:x.product.shop.id,adMetadata:C,xPos:x.xPos,yPos:x.yPos??0})},I=x=>{const v=g(x),C=x.product.shopCashIncentive?X(x.product.shopCashIncentive):null;e({schemaId:"shop_app_entity_recommendation_clicks/6.7",payload:v}),t.entityClicked({...v,MedusaJSShopId:B(x.product.shop.MedusaJSId),adResponseId:C==null?void 0:C.adResponseId,campaignId:C==null?void 0:C.campaignHandle}),x.product.shopCashIncentive&&m({brokerId:x.product.shop.id,adMetadata:C})},S=x=>{const v={...h(),entityId:x.entityId,entityType:x.entityType,xPos:x.xPos,yPos:0,...x.containerType&&{containerType:x.containerType},...x.containerId&&{containerId:x.containerId},MedusaJSShopId:B(x.MedusaJSId)},C=i&&H(i)&&i.shop.shopCashIncentive?X(i.shop.shopCashIncentive):null;e({schemaId:"shop_app_entity_recommendation_impressions/6.11",payload:v}),t.entityImpression({...v,adResponseId:C==null?void 0:C.adResponseId,campaignId:C==null?void 0:C.campaignHandle})},_=x=>{const v={...h(),entityId:x.entityId,entityType:x.entityType,xPos:x.xPos,yPos:0},C=i&&H(i)&&i.shop.shopCashIncentive?X(i.shop.shopCashIncentive):null;e({schemaId:"shop_app_entity_recommendation_clicks/6.7",payload:{...v,...x.containerType&&{containerType:x.containerType},...x.containerId&&{containerId:x.containerId}}}),t.entityClicked({...v,MedusaJSShopId:B(x.MedusaJSId),adResponseId:C==null?void 0:C.adResponseId,campaignId:C==null?void 0:C.campaignHandle})},A=()=>{const x={...h(),entityId:n,entityType:T.FeedSection,xPos:0,yPos:c,MedusaJSShopId:i&&H(i)?B(i.shop.MedusaJSId):void 0},v=i&&H(i)&&i.shop.shopCashIncentive?X(i.shop.shopCashIncentive):null;e({schemaId:"shop_app_entity_recommendation_impressions/6.11",payload:x}),t.entityImpression({...x,adResponseId:v==null?void 0:v.adResponseId,campaignId:v==null?void 0:v.campaignHandle}),v&&i&&H(i)&&f({brokerId:i.shop.id,adMetadata:v,xPos:0,yPos:c})},k=()=>{const x={...h(),entityId:n,entityType:T.FeedSection,xPos:0,yPos:c},v=i&&H(i)&&i.shop.shopCashIncentive?X(i.shop.shopCashIncentive):null;e({schemaId:"shop_app_entity_recommendation_clicks/6.7",payload:x}),t.entityClicked({...x,MedusaJSShopId:i&&H(i)?B(i.shop.MedusaJSId):void 0,adResponseId:v==null?void 0:v.adResponseId,campaignId:v==null?void 0:v.campaignHandle}),i&&H(i)&&i.shop.shopCashIncentive&&m({brokerId:i.shop.id,adMetadata:v})},y=()=>{if(e({schemaId:"shop_app_entity_recommendation_clicks/6.7",payload:{...h(),entityId:n,entityType:T.FeedSectionHeader,xPos:0,yPos:c}}),i&&H(i)&&i.shop.shopCashIncentive){const x=X(i.shop.shopCashIncentive);m({brokerId:i.shop.id,adMetadata:x})}},j=()=>{e({schemaId:"shop_app_entity_recommendation_clicks/6.7",payload:{...h(),entityId:n,entityType:T.FeedSectionFooter,xPos:0,yPos:c}})},{send:R}=Xe(()=>({productViewed:b,entityViewed:S,entityPressed:_,productPressed:I,sectionViewed:A,sectionPressed:k,sectionHeaderPressed:y,sectionFooterPressed:j}));return R},He=2;function Ma({item:e}){const t=M(),a=Re(),n=p.useCallback(()=>{ie(e)&&t.entityViewed({entityId:e.trackedItem.id,entityType:T.Order,xPos:e.xPos})},[e,t]),c=p.useCallback(()=>{ie(e)&&(t.entityPressed({entityId:e.trackedItem.id,entityType:T.Order,xPos:e.xPos}),a(`/orders/${e.trackedItem.id}`))},[e,t,a]),{formattedTitle:o,formattedImages:d,statusLabel:i}=p.useMemo(()=>{var h,g;if(!ie(e))return{formattedTitle:"",formattedImages:[],statusLabel:""};const{lineItems:l,shop:r}=e.trackedItem;let u="";l.nodes.length===1?u=((h=l.nodes[0])==null?void 0:h.productTitle)||"":u=`${l.nodes.length} items from ${r.name}`;const f=l.nodes.map(b=>b==null?void 0:b.image).filter(Boolean).slice(0,He);let m=f;return!f.length&&((g=r.visualTheme)!=null&&g.logoImage)&&(m=[r.visualTheme.logoImage]),{formattedTitle:u,formattedImages:m,statusLabel:e.trackedItem.displayStatus||""}},[e]);return ie(e)?s.jsx(z,{onImpression:n,triggerOnce:!0,children:s.jsx("button",{type:"button",onClick:c,"data-testid":"compact-order-card",className:"w-full text-left",children:s.jsxs("div",{className:"flex w-full items-center gap-space-12",children:[s.jsxs("div",{className:"relative shrink-0",children:[s.jsxs("div",{className:"relative flex",children:[d.slice(0,He).map((l,r)=>s.jsx("div",{className:"size-space-32 overflow-hidden rounded-radius-8 border border-border-secondary",style:{marginLeft:r>0?"-8px":"0",zIndex:He-r},children:l!=null&&l.url?s.jsx("img",{src:l.url,alt:l.altText||"",className:"size-full object-cover"}):s.jsx("div",{className:"flex size-full items-center justify-center bg-bg-fill-secondary",children:s.jsx(V,{name:"order",size:"s",className:"text-text-tertiary"})})},(l==null?void 0:l.url)||r)),!d.length&&s.jsx("div",{className:"flex size-space-32 items-center justify-center rounded-radius-8 bg-bg-fill-secondary",children:s.jsx(V,{name:"order",size:"s",className:"text-text-tertiary"})})]}),s.jsx("div",{className:"absolute -right-space-6 -top-space-6 flex size-space-20 items-center justify-center rounded-radius-max border border-border-image bg-bg-fill shadow-xs",children:s.jsx(V,{name:"return-package",size:"s",className:"text-text-secondary"})})]}),s.jsxs("div",{className:"flex flex-1 items-center gap-space-4",children:[s.jsx(L,{variant:"bodySmall",className:"max-w-[85%] text-text",children:o}),i&&s.jsx("div",{className:"shrink-0 rounded-radius-4 bg-bg-fill-secondary px-space-4 py-space-2",children:s.jsx(L,{variant:"badgeBold",className:"text-text",children:i})})]})]})})}):null}const Ie=32,Ue=3,Ha=2;function Ua({imageUris:e,size:t}){const a=p.useMemo(()=>e==null?void 0:e.slice(0,Ue),[e]);if(!(e!=null&&e.length))return s.jsx("div",{className:"flex size-full items-center justify-center overflow-hidden rounded-radius-8 border border-bg-fill-secondary bg-bg-fill-tertiary",style:{width:t,height:t},"data-testid":"image-placeholder"});const n=e.length-Ue>0?e.length-Ue:0;return s.jsx("div",{className:"flex items-center gap-space-4","data-testid":"images-container",children:a==null?void 0:a.map((c,o)=>{if(!c)return null;const d=`Product Item ${o+1}`,i=`+${n}`;return s.jsxs("div",{className:"relative size-full overflow-hidden rounded-radius-8 border border-bg-fill-secondary bg-bg-fill-tertiary",style:{width:t,height:t},"data-testid":"image-container",children:[s.jsx("img",{src:c,alt:d,className:"size-full object-cover"}),o===Ha&&n>0&&s.jsx("div",{className:"bg-bg-fill-inverse/30 absolute inset-0 flex size-full items-center justify-center",children:s.jsx("span",{className:"text-bodySmall font-medium text-text-inverse",children:i})})]},`TrackerItemImage-${o}`)})})}function es({images:e,title:t,subtitle:a,orderDetails:n,onPress:c,accessibilityLabel:o,carrierInfo:d,date:i}){const l=d==null?void 0:d.name,r=d==null?void 0:d.imageUrl,u=p.useMemo(()=>{if(e)return e.filter(Boolean).map(f=>f.url)},[e]);return s.jsx("div",{className:"w-full cursor-default rounded-radius-12 border border-bg-fill-secondary bg-bg-fill p-space-16 shadow-sm transition-shadow duration-200 hover:cursor-pointer hover:shadow-md",onClick:()=>c(),role:"button","aria-label":o,tabIndex:0,children:s.jsxs("div",{className:"flex h-full flex-col justify-between gap-space-8",children:[s.jsxs("div",{className:"flex w-full items-start justify-between",children:[s.jsxs("div",{className:"flex w-full flex-row gap-space-8 overflow-hidden",children:[d&&s.jsx("div",{className:"flex justify-center overflow-hidden rounded-radius-8 border border-bg-fill-secondary bg-bg-fill-tertiary",style:{width:Ie,minWidth:Ie,height:Ie},children:s.jsx("img",{src:r,alt:l??""})}),s.jsxs("div",{className:"flex w-full flex-col gap-space-4 overflow-hidden",children:[s.jsx("div",{className:"truncate text-bodySmall leading-none text-text",title:t,children:t}),a&&s.jsx("div",{className:"overflow-hidden text-ellipsis text-nowrap text-buttonSmall leading-none text-text-tertiary",title:a,children:a})]})]}),u&&s.jsx(Ua,{imageUris:u,size:Ie})]}),(n||i)&&s.jsxs("div",{className:"mt-space-4 flex min-h-space-20 items-center justify-between",children:[n?s.jsx("span",{className:"rounded-radius-20 bg-bg-fill-secondary px-space-8 py-space-2 text-badge",children:n}):s.jsx("span",{}),s.jsx("span",{className:"py-space-2 text-buttonSmall leading-none text-text-tertiary",children:i})]})]})})}function Wa({item:e}){var m;const t=M(),a=ue(),n=e.trackedItem,c=n.status,o=(m=n.tracker)==null?void 0:m.carrierInfo,d=n.id,i=n.customName??n.sellerName??(o==null?void 0:o.name)??"",l=Rs({delivery:n,isOrderDelivery:!1}),r=P.t("Feed.FeedCard.DeliveryCard.TrackerFor",{name:(o==null?void 0:o.name)||"delivery"}),u=p.useCallback(()=>{t.entityViewed({entityId:n.id,entityType:T.Delivery,xPos:e.xPos})},[t,n.id,e.xPos]),f=p.useCallback(()=>{t.entityPressed({entityId:n.id,entityType:T.Delivery,xPos:e.xPos}),a&&a.navigateToOrder({orderId:n.id})},[n.id,e.xPos,t,a]);return s.jsx(z,{onImpression:u,triggerOnce:!0,children:s.jsx("div",{className:"w-full",children:s.jsx(es,{title:i,subtitle:l,onPress:f,status:c,accessibilityLabel:r,deliveryId:d,carrierInfo:o})})})}function $a({item:e}){var S,_,A;const t=M(),a=ue(),n=e.trackedItem,{shop:c,totalItemCount:o,effectiveTotalPrice:d,lineItems:i,deliveries:l}=n,r=(A=(_=(S=l==null?void 0:l.nodes)==null?void 0:S.find(({tracker:k})=>!!k))==null?void 0:_.tracker)==null?void 0:A.carrierInfo,u=new Date(n.createdAt).toLocaleDateString(P.language,{month:"short",day:"numeric"}),f=Es(n),m=p.useMemo(()=>{var j;const k=new Date(n.createdAt).toLocaleDateString(P.language,{month:"short",day:"numeric"}),y=P.t("Feed.FeedCard.OrderCard.OrderFrom",{shopName:(c==null?void 0:c.name)||"",date:k||""});if(i!=null&&i.nodes.length){const R=((j=i.nodes[0])==null?void 0:j.productTitle)||"product",x=i.nodes.length-1;return x>0?`${y}, includes ${R} and ${x} other item${x>1?"s":""}`:`${y}, includes ${R}`}return y},[i==null?void 0:i.nodes,n.createdAt,c==null?void 0:c.name]),h=p.useMemo(()=>(i==null?void 0:i.nodes.filter(k=>!!k.image).map(k=>k.image).filter(Boolean))||[],[i==null?void 0:i.nodes]),g=p.useCallback(()=>{t.entityViewed({entityId:n.id,entityType:T.Order,xPos:e.xPos})},[t,n.id,e.xPos]),b=p.useCallback(()=>{t.entityPressed({entityId:n.id,entityType:T.Order,xPos:e.xPos}),a&&a.navigateToOrder({orderId:n.id})},[e.xPos,n.id,t,a]),I=p.useMemo(()=>{const k=[];if(o){const y=o===1?"item":"items";k.push(`${o} ${y}`)}return d&&k.push(Mt(d)),k.join("・")},[o,d]);return s.jsx(z,{onImpression:g,triggerOnce:!0,children:s.jsx("div",{className:"mx-auto w-full max-w-[450px]",children:s.jsx(es,{title:(c==null?void 0:c.name)||"",subtitle:f,images:h,onPress:b,orderDetails:I,accessibilityLabel:m,carrierInfo:r,date:u})})})}function Xa({item:e,cardSize:t}){return t===K.XXS?s.jsx(Ma,{item:e}):os(e)?s.jsx(Wa,{item:e}):ie(e)?s.jsx($a,{item:e}):null}const ts=({selectedIndex:e,numberOfDots:t})=>s.jsx("div",{"data-testid":"pagination-indicator",className:"flex gap-space-2",children:[...new Array(t)].map((a,n)=>s.jsx("div",{"data-testid":`pagination-dot-${n+1}`,className:w("size-space-6 rounded-full bg-bg-overlay-fixed-light-40 transition-all",e===n&&"bg-bg-overlay-fixed-light-75")},n))}),wt="pointer-events-auto bg-bg-fill opacity-0 shadow-xs transition-opacity group-hover:opacity-70";function ss({productTitle:e,images:t,rounded:a=!0,borderRadius:n,borderClassName:c,shadowClassName:o}){const d=t.length>1,[i,l]=p.useState(0),r=t.length-1,u=p.useCallback(h=>{h.stopPropagation(),h.preventDefault(),l(i===0?r:i-1)},[r,i]),f=p.useCallback(h=>{h.stopPropagation(),h.preventDefault(),l(i===r?0:i+1)},[r,i]),m=n??(a?"12":void 0);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"scrollbar-hide group relative size-full max-lg:hidden",children:[t.map((h,g)=>s.jsx("div",{className:w("absolute inset-0 transition-opacity",i===g?"z-10 opacity-100":"pointer-events-none opacity-0"),"data-testid":"product-details-card-image__desktop-image",children:s.jsx(le,{rounded:a,image:h,productTitle:e,borderRadius:m,borderClassName:c,shadowClassName:o})},h.url)),d&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-space-16 z-30 flex items-center",children:s.jsx(J,{variant:"tertiary",name:"left-chevron",ariaLabel:P.t("MerchantCard.PreviousProductAriaLabel"),className:wt,size:"m","data-testid":"prev-button",onClick:u})}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-space-16 z-30 flex items-center",children:s.jsx(J,{variant:"tertiary",name:"right-chevron",ariaLabel:P.t("MerchantCard.NextProductAriaLabel"),className:wt,size:"m",onClick:f,"data-testid":"next-button"})})]})]}),s.jsx("div",{"data-testid":"product-details-card-image__mobile",className:w("scrollbar-hide relative size-full lg:hidden","snap-x snap-mandatory overflow-x-auto overflow-y-hidden whitespace-nowrap",a?"rounded-radius-12":void 0),children:t.map(h=>s.jsx("div",{"data-testid":"product-details-card-image__mobile-image",className:"inline-block w-full snap-center",children:s.jsx(le,{image:h,rounded:!1,productTitle:e,borderClassName:c,borderRadius:n,shadowClassName:o})},h.url))}),d?s.jsx("div",{className:"absolute bottom-space-16 z-10 flex w-full transform-gpu justify-center",children:s.jsx(ts,{selectedIndex:i,numberOfDots:t.length})}):null]})}const as=p.memo(({text:e,searchTerm:t})=>{if(!t||!e)return s.jsx("span",{children:e});const a=t.trim();if(!a)return s.jsx("span",{children:e});const n=e.toLowerCase(),c=a.toLowerCase(),o=n.indexOf(c);if(o===-1)return s.jsx("span",{className:"font-normal",children:e});const d=e.slice(0,o),i=e.slice(o,o+a.length),l=e.slice(o+a.length);return s.jsxs("span",{"data-testid":"highlighted-text-container",children:[d&&s.jsx("span",{className:"font-bold",children:d}),s.jsx("span",{className:"font-normal",children:i}),l&&s.jsx("span",{className:"font-bold",children:l})]})});as.displayName="HighlightedText";function Ga(e){if(!e)return null;if(e.startsWith("shopapp://agent"))try{const a=new URL(e).searchParams.get("query");if(a)return{action:"newMessage",message:a}}catch{return null}if(e.startsWith("#")){const t=e.slice(1),[a,n]=t.split("=");if(a==="newMessage"&&n)return{action:"newMessage",message:decodeURIComponent(n.replace(/\+/g," "))}}return null}const qa="_markdownContent_8q9dw_1",jt={markdownContent:qa},Ka={[Z.BODY_SMALL]:"bodySmall",[Z.BRAND_TEXT_LARGE]:"brandTextLarge",[Z.BRAND_TEXT_SMALL]:"brandTextSmall",[Z.CAPTION]:"caption",[Z.CAPTION_MEDIUM]:"captionMedium"};function We({index:e,segment:t,isCompact:a=!1}){var F,$,ae,ut,ht,pt,mt,ft,xt;const{selectedItemIndex:n,onHoverIndex:c,onMouseLeave:o,feedId:d}=pe(),{trackingValues:i}=de(),l=new URLSearchParams((d==null?void 0:d.split("?")[1])||"").get("query"),r=n===e,{className:u,variant:f}=cs(t.traits),m=at(),h=ot(),g=ls(t.text),b=ds(t.text),I=((F=t.text)==null?void 0:F.replace(/\\n/g,`
`))||"",S=Vt(I),_=g||b||S,A=Gs(`(max-width: ${qs.lg}px)`),k=(($=i==null?void 0:i.metadata)==null?void 0:$.subSectionId)==="disclaimer",j=t.icon&&vt[t.icon]&&!((ae=t.text)!=null&&ae.trim()),R=t.fontVariant&&Ka[t.fontVariant],x=p.useMemo(()=>{if(!_||!I)return null;const W=new zs,me=Bs(I,{gfm:!0,breaks:!0,renderer:W});return Ms(me)},[_,I]),v=p.useMemo(()=>{var W;return Ga((W=t.action)==null?void 0:W.url)},[(ut=t.action)==null?void 0:ut.url]),C=p.useCallback(W=>{if(v&&m){if(W.preventDefault(),m.isGenerating)return;v.action==="newMessage"&&(m.sendMessage({content:v.message}),m.send.clearSuggestions())}h&&t.text&&h.navigateToSearch(t.text,{index:e||0,searchTerm:l||""})},[v,m,h,t.text,e,l]);if(j){const W=vt[t.icon],me=(ht=t.action)==null?void 0:ht.url;return me?s.jsx(Q,{"data-testid":"rich-text-icon",to:me,target:"_blank",rel:"noopener noreferrer",className:w("ml-space-4 inline-flex",k&&"hover:text-text-secondary"),"aria-label":(pt=t.icon)==null?void 0:pt.toLowerCase().replace(/_/g," "),children:s.jsx(V,{name:W,size:"s",className:"text-text-tertiary"})}):s.jsx("span",{"data-testid":"rich-text-icon",className:"ml-space-4 inline-flex",children:s.jsx(V,{name:W,size:"s",className:"text-text-tertiary"})})}if(!t.text)return null;if(R&&k)return s.jsx("span",{"data-testid":"rich-text-muted",className:w("text-text-tertiary",`text-${R}`),children:t.text});const N=(mt=t.action)==null?void 0:mt.url;let E;_&&x&&S?E=s.jsx("div",{className:w(u,jt.markdownContent,"[&_ul]:list-disc [&_ul]:space-y-space-4 [&_ul]:pl-space-20","[&_ol]:list-decimal [&_ol]:space-y-space-4 [&_ol]:pl-space-20",a?"text-bodySmall":"text-body"),dangerouslySetInnerHTML:{__html:x}}):_&&x?E=s.jsx(L,{className:w(u,jt.markdownContent,N&&"whitespace-nowrap"),variant:a?"bodySmall":f,dangerouslySetInnerHTML:{__html:x}}):E=s.jsx(L,{className:w(u,N&&"whitespace-nowrap"),variant:a?"bodySmall":f,children:l&&h?s.jsx(as,{text:t.text||"",searchTerm:l}):t.text});const D=w("group flex items-center justify-between gap-space-4","rounded-radius-max hover:cursor-pointer ",N&&t.image?"w-full":"w-fit",a&&t.image?"block hover:bg-bg-overlay-fixed-dark-04 pl-space-6 p-space-4 rounded-radius-8 rounded-radius-max":"",a&&!t.image?"bg-bg-overlay-fixed-dark-04 px-space-12 py-space-8 group hover:opacity-60 pr-space-16":"",a?"":"bg-bg-fill border-[0.5px] border-border-secondary shadow-xs px-space-12 py-space-8 my-space-4",a&&r&&t.image&&"bg-bg-overlay-fixed-dark-04",a&&r&&!t.image&&"opacity-60");if(t.image)return v?s.jsxs("div",{"data-testid":"rich-text-segment",className:D,onClick:C,onMouseEnter:()=>{c==null||c(e||0)},onMouseLeave:()=>{o==null||o()},children:[s.jsxs("div",{className:a?"flex items-center gap-space-16":"flex items-center gap-space-8",children:[s.jsx(Ce,{src:t.image.url,style:a?{width:32,height:32}:{width:24,height:24}}),E]}),N&&!a&&s.jsx("div",{className:"p-space-4",children:s.jsx(V,{name:"arrow-right",size:"m",className:"text-text"})})]}):N?s.jsx(Ge,{to:(ft=t.action)==null?void 0:ft.url,children:s.jsxs("div",{"data-testid":"rich-text-segment",className:D,children:[s.jsxs("div",{className:"flex items-center gap-space-8",children:[s.jsx(Ce,{src:t.image.url,style:{width:24,height:24}}),E]}),s.jsx("div",{className:"p-space-4",children:s.jsx(V,{name:"arrow-right",size:"m",className:"text-text"})})]})}):s.jsxs("div",{className:"flex items-center gap-space-8",children:[s.jsx(Ce,{src:t.image.url,style:{width:24,height:24}}),E]});if((g||S)&&x)return E;const O=a?s.jsxs(s.Fragment,{children:[s.jsx(V,{name:"arrow-right",size:"s",className:"rotate-90 text-text-placeholder"}),E]}):s.jsxs(s.Fragment,{children:[E,s.jsx("div",{className:"p-space-4",children:s.jsx(V,{name:"arrow-right",size:"m",className:"text-text"})})]});return v?s.jsx("div",{"data-testid":"rich-text-segment",className:D,onClick:C,onMouseEnter:()=>{c==null||c(e||0)},onMouseLeave:()=>{o==null||o()},children:a?s.jsxs(s.Fragment,{children:[A?s.jsx(V,{name:"arrow-up",size:"m",className:"mr-space-4  rotate-180 text-text-tertiary group-hover:scale-110"}):null,E]}):E}):N?s.jsx(Ge,{to:(xt=t.action)==null?void 0:xt.url,children:s.jsx("div",{"data-testid":"rich-text-segment",className:D,children:O})}):E}const ct=({index:e,item:t,cardSize:a})=>{var l,r,u,f;const{trackingValues:n}=de(),c=a===K.XXS,o=t.segments.length===1&&((r=(l=t.segments[0])==null?void 0:l.action)==null?void 0:r.url),d=((u=n==null?void 0:n.metadata)==null?void 0:u.subSectionId)==="disclaimer",i=!!((f=t.segments[0])!=null&&f.image);return o?s.jsx("div",{className:w(i?"w-full":"w-fit"),children:s.jsx(We,{index:e,item:t,segment:t.segments[0],isCompact:c},t.segments[0].text)}):d?s.jsx("div",{className:"mt-space-16",children:t.segments.map((m,h)=>s.jsx(We,{index:h,item:t,segment:m,isCompact:c},`${m.text}-${h}`))}):s.jsx("div",{className:"flex flex-row flex-wrap gap-space-2",children:t.segments.map((m,h)=>s.jsx(We,{index:h,item:t,segment:m,isCompact:c},`${m.text}-${h}`))})},Qa=({product:e,descriptors:t,cardSize:a,onImpression:n,onPress:c})=>{const o=p.useCallback(()=>{n==null||n()},[n]),d=p.useCallback(()=>{c()},[c]);return s.jsx(z,{onImpression:o,triggerOnce:!0,className:"h-full",children:s.jsx("div",{role:"button",tabIndex:0,"data-testid":"product-details-card-wrapper",onClick:d,"aria-label":P.t("ProductCard.ImageAriaLabel",{productTitle:e.title}),className:"mx-auto h-full",children:s.jsxs("div",{"data-testid":"product-details-comparison-card",className:w("flex size-full flex-col rounded-radius-16 border-[0.5px] border-border-image","overflow-hidden shadow-xs transition-all duration-100 hover:cursor-pointer hover:shadow-s"),children:[s.jsxs("div",{className:"flex w-full flex-row items-center",onClick:d,"data-testid":"product-details-card-content",children:[s.jsx("div",{className:"relative aspect-square w-[30%] min-w-[46px] shrink-0 overflow-hidden p-space-8",children:s.jsx(ss,{productTitle:e.title,images:e.images,rounded:!0,borderClassName:"border-none",shadowClassName:"shadow-none"})}),s.jsx("div",{className:"flex flex-1 flex-col justify-between gap-y-space-8 p-space-8",children:s.jsx("div",{className:"flex flex-col gap-y-space-8",children:s.jsxs("div",{className:"flex flex-col gap-space-2",children:[s.jsx(Ee,{product:e,lineClampClassName:"line-clamp-2"}),s.jsx(Oe,{product:e}),s.jsx(nt,{product:e})]})})})]}),s.jsx("div",{className:"flex size-full",children:s.jsx("ul",{className:"flex size-full flex-col justify-between pb-space-4","data-testid":"comparison-table",children:t.map((i,l)=>s.jsx("li",{className:"flex flex-col gap-space-2 bg-bg-fill px-space-16 py-space-8",children:s.jsx("div",{className:"flex items-start gap-space-8",children:s.jsx("div",{children:s.jsx(ct,{item:i,cardSize:a},l)})})},l))})})]})})})};function Ya({productTitle:e,images:t}){const a=!U();return s.jsx("div",{children:t.length===1?s.jsx("div",{className:"flex justify-center pb-space-8 md:px-space-16",children:s.jsx("div",{className:w("relative aspect-square","w-full md:w-[calc(100%/3-((2px*3)/3))]","rounded-radius-bl-none overflow-hidden rounded-br-radius-none md:rounded-radius-28"),"data-testid":"single-product-image",children:s.jsx(le,{productTitle:e,image:t[0],rounded:!1,borderClassName:"",shadowClassName:"none"})})}):s.jsx(Ws,{noGutter:!0,itemType:"moreOnDesktopFewerOnMobile",hideNavigation:!0,slidesOffsetBefore:U()?"space-16":void 0,slidesOffsetAfter:U()?"space-16":void 0,swiperProps:a?{slidesPerView:"auto",freeMode:{enabled:!0,sticky:!1},resistance:!1}:void 0,children:t.map((n,c)=>{const o=c===0,d=c===t.length-1,i=!o&&!d;return s.jsx("div",{className:w(d&&"-mr-space-6"),children:s.jsx(le,{productTitle:e,image:n,rounded:!1,borderClassName:w("after:pointer-events-none after:absolute after:inset-0",o&&"after:rounded-tl-radius-28",o&&U()&&"after:rounded-bl-radius-28",d&&"after:rounded-tr-radius-28",o&&U()&&"after:rounded-br-radius-28",i&&"after:rounded-none"),shadowClassName:w("undefined",o&&"rounded-tl-radius-28",o&&U()&&"rounded-bl-radius-28",d&&"rounded-tr-radius-28",d&&U()&&"rounded-br-radius-28",i&&"rounded-none")})},n.url)})})})}const ns=p.createContext({shouldAnimate:!1}),Za=()=>p.useContext(ns),Yr=({shouldAnimate:e=!1,children:t})=>s.jsx(ns.Provider,{value:{shouldAnimate:e},children:t}),Ja="_accordionAnimation_11zaz_29",en="_slideInAnimation_11zaz_37",tn="_speechBubble_11zaz_44",$e={accordionAnimation:Ja,slideInAnimation:en,speechBubble:tn},sn="•",an=({badge:e,product:t,descriptors:a,hasFavoriteAction:n,cardSize:c,onImpression:o,onPress:d})=>{var R,x,v,C;const{shouldAnimate:i}=Za(),l=at(),r=ue(),u=r==null?void 0:r.navigateToShop,f=(l==null?void 0:l.isGenerating)??!1,m=p.useRef(null),[h,g]=p.useState(!1),[b,I]=p.useState(!1),S=p.useMemo(()=>it({productId:t.id,variantId:t.defaultVariantId,slug:t.slug?t.slug:Os(t.title)}),[t.id,t.defaultVariantId,t.slug,t.title]),_=!!(i&&f);p.useEffect(()=>{_&&h&&!b&&I(!0)},[_,h,b]),p.useEffect(()=>{if(!_)return;const N=new IntersectionObserver(E=>{const[D]=E;D.isIntersecting&&g(!0)},{threshold:1,rootMargin:"-10px 0px 0px 0px"});return m.current&&N.observe(m.current),()=>N.disconnect()},[_]);const A=us(t.shopCashIncentive),k=s.jsxs("div",{className:"flex min-w-0 flex-col justify-center gap-space-2",children:[s.jsx(Ee,{product:t,productTitleVariant:"bodyTitleLarge",lineClampClassName:"line-clamp-1"}),s.jsx(Oe,{product:t}),s.jsx(Ls,{price:t.price,originalPrice:t.originalPrice,format:Ds.Caption})]}),y=N=>{N.stopPropagation(),u==null||u({shopId:t.shop.id,shopHandle:t.shop.defaultHandle??void 0})},j=N=>{N.stopPropagation(),l!=null&&l.inNativeWebView&&N.preventDefault(),d()};return s.jsx(z,{onImpression:o,triggerOnce:!0,className:"flex h-full justify-center",children:s.jsx(Q,{to:S,"aria-label":P.t("ProductCard.ImageAriaLabel",{productTitle:t.title}),className:w("h-full w-full sm:max-w-[800px]"),onClick:j,"data-testid":"xl-product-details-card-wrapper",children:s.jsxs("div",{"data-testid":"product-details-card",className:w("flex h-full flex-col rounded-radius-28 border-[0.5px] border-border-image sm:rounded-radius-36","-mx-space-20 overflow-hidden transition duration-100","mx-0 shadow-xs hover:cursor-pointer hover:shadow-s group-hover:scale-105"),children:[U()&&s.jsxs("div",{className:"flex items-center justify-between p-space-16",children:[s.jsxs("div",{className:"flex gap-space-8",children:[s.jsx("div",{"data-testid":"merchant-logo-wrapper",onClick:y,children:s.jsx(te,{src:(x=(R=t.shop.visualTheme)==null?void 0:R.logoImage)==null?void 0:x.url,size:"l",shopName:t.shop.name,hasIncentive:ee(A)})}),k]}),s.jsxs("div",{className:"flex shrink-0 items-center gap-space-8",children:[n&&s.jsx(Ne,{product:t,unfavoritedButtonVariant:"outlined-juicy"}),s.jsx("div",{className:"[&_button]:min-w-[100px]","data-testid":"view-details-btn",children:s.jsx(Te,{variant:"outlined-juicy",size:"m",onClick:()=>{d()},children:s.jsx(L,{variant:"captionBold",className:"text-text",children:P.t("shopAI:XLProductDetailsCard.ViewDetails")})})})]})]}),s.jsxs("div",{className:"flex w-full flex-1 flex-col gap-space-12 sm:gap-space-16",children:[s.jsx("div",{className:"flex w-full justify-center",children:s.jsx(Ya,{productTitle:t.title,images:t.images,badge:e})}),!U()&&s.jsxs("div",{className:"flex items-center justify-between gap-space-12 px-space-12",children:[k,s.jsxs("div",{className:"flex items-center gap-space-8",children:[s.jsx("div",{"data-testid":"merchant-logo-wrapper",onClick:y,children:s.jsx(te,{src:(C=(v=t.shop.visualTheme)==null?void 0:v.logoImage)==null?void 0:C.url,size:"s",shopName:t.shop.name,hasIncentive:ee(A)})}),n&&s.jsx(Ne,{product:t,unfavoritedButtonVariant:"outlined-juicy"})]})]}),s.jsx("div",{className:"flex px-space-12 pt-space-8 sm:p-space-16",children:s.jsx("div",{ref:m,"data-testid":"reasoning-text-container",className:w("relative flex w-full flex-col rounded-radius-28 bg-bg-fill-agent p-space-12 sm:p-space-16",$e.speechBubble,_&&!h&&"max-h-0 overflow-hidden opacity-0",b&&$e.accordionAnimation),children:a.map((N,E)=>{const D=N.segments.some(O=>{var F;return Vt(((F=O.text)==null?void 0:F.replace(/\\n/g,`
`))||"")});return s.jsxs("div",{"data-testid":"reasoning-descriptor",className:w("relative z-10 flex items-baseline gap-space-8",_&&!h&&"translate-y-[-16px] opacity-0",b&&$e.slideInAnimation),style:b?{"--animation-delay":`${250+E*100}ms`}:void 0,children:[!D&&s.jsx("span",{className:"leading-none text-text-agent-emphasis",children:sn}),s.jsx("div",{"data-testid":"reasoning-text",className:"text-text-agent-emphasis",children:s.jsx(ct,{item:N,cardSize:c})})]},E)})})}),!U()&&s.jsx("div",{className:"w-full px-space-12 pb-space-12",children:s.jsx("div",{className:"w-full [&_button]:w-full","data-testid":"view-details-btn",children:s.jsx(Te,{variant:"outlined-juicy",size:"m",onClick:()=>{d()},children:s.jsx(L,{variant:"captionBold",className:"text-text",children:P.t("shopAI:XLProductDetailsCard.ViewDetails")})})})})]})]})})})};function nn({product:e,onImpression:t,onPress:a,hasFavoriteAction:n,borderless:c,badge:o}){var i,l,r,u,f,m,h,g;const d=p.useMemo(()=>o?(o==null?void 0:o.badgeVariant)==="cashBack"?Ke.CASH_BACK:(o==null?void 0:o.badgeVariant)==="multiplierFilled"?Ke.SHOP_CASH:null:null,[o]);return s.jsx(z,{onImpression:t,triggerOnce:!0,className:"h-full",children:s.jsx("div",{role:"button",tabIndex:0,"data-testid":"product-details-card-wrapper",onClick:a,"aria-label":P.t("ProductCard.ImageAriaLabel",{productTitle:e.title}),className:"mx-auto h-full",children:s.jsx("div",{"data-testid":"product-details-card",className:w("flex size-full flex-col overflow-hidden rounded-radius-16",c?void 0:"  border-[0.5px] border-border-image shadow-xs transition-all duration-100 hover:cursor-pointer hover:shadow-s"),children:s.jsxs("div",{className:"flex w-full",onClick:a,"data-testid":"product-details-card-content",children:[s.jsxs("div",{className:w("relative aspect-square shrink-0 overflow-hidden","w-[30%] min-w-[130px] p-space-8",c?"-ml-space-8":void 0),children:[s.jsx(ss,{productTitle:e.title,images:e.images,rounded:!0,borderClassName:"border-none",shadowClassName:"shadow-none"}),n&&s.jsx("div",{className:"absolute bottom-space-12 right-space-12 z-30",children:s.jsx(Ne,{product:e})})]}),s.jsxs("div",{className:"flex flex-1 flex-col justify-between gap-y-space-8 p-space-8",children:[s.jsx("div",{className:"flex flex-col gap-y-space-8",children:s.jsxs("div",{className:"flex flex-col gap-space-2",children:[s.jsx(Ee,{product:e}),s.jsx(Oe,{product:e}),s.jsx(nt,{product:e})]})}),s.jsxs("div",{className:"flex justify-between gap-space-4",children:[s.jsxs("div",{className:"flex flex-1 items-center gap-space-8",children:[s.jsx(te,{src:(l=(i=e.shop.visualTheme)==null?void 0:i.logoImage)==null?void 0:l.url,shopName:e.shop.name,size:"xs",className:"shrink-0",hasIncentive:ee(d)}),s.jsx(Ht,{product:e,textVariant:"badgeBold"})]}),!o&&((u=(r=e.shop)==null?void 0:r.productReviewAnalytics)!=null&&u.averageRating)&&((m=(f=e.shop)==null?void 0:f.productReviewAnalytics)!=null&&m.totalProductReviews)?s.jsx("div",{className:"flex items-center",children:s.jsx(qe,{rating:{averageRating:(h=e.shop.productReviewAnalytics)==null?void 0:h.averageRating,totalProductRatings:(g=e.shop.productReviewAnalytics)==null?void 0:g.totalProductReviews},textVariant:"captionBold",ratingTextVariant:"captionBold",subduedReviewCount:!0})}):null,o?s.jsx("div",{className:"flex items-center",children:s.jsx($t,{variant:o.badgeVariant,textAccessibilityLabel:o.badgeTextAccessibilityLabel,text:o.badgeText})}):null]})]})]})})})})}function rn({item:e,cardSize:t}){const a=M(),{product:n,descriptors:c,hasFavoriteAction:o,badge:d}=e,i=Re(),l=ue(),r=p.useCallback(()=>{a.productViewed(e)},[a,e]),u=p.useCallback(()=>{a.productPressed(e),l?l.navigateToProduct({productId:n.id,variantId:n.defaultVariantId}):i(it({productId:n.id,slug:n.slug}))},[a,e,l,n.id,n.defaultVariantId,n.slug,i]),f=t===K.XL,m=t===K.L&&c.length>1;if(!f&&!m)return s.jsx(nn,{product:n,onImpression:r,onPress:u,hasFavoriteAction:o,badge:d});if(m)return s.jsx(Qa,{product:n,descriptors:c,cardSize:t,onImpression:r,onPress:u});if(f)return s.jsx(an,{badge:d,product:n,descriptors:c,hasFavoriteAction:o,cardSize:t,onImpression:r,onPress:u})}const St=({videoUrl:e,imageUrl:t,backgroundColor:a,maxWidth:n,contentClassName:c,stickToInsets:o=!0})=>{const d=p.useRef(null),[i,l]=p.useState(!1);return p.useEffect(()=>{const r=d.current,u=()=>{l(!0)};r==null||r.addEventListener("play",u);const f=(r==null?void 0:r.readyState)||0;return!(r!=null&&r.paused)&&f>2&&l(!0),()=>{r==null||r.removeEventListener("play",u)}},[]),s.jsx("div",{className:"absolute inset-0","data-testid":"shopping-event-card-background",style:{backgroundColor:a||Fs.colors["bg-brand"]},children:s.jsxs("div",{className:w("absolute overflow-hidden",o&&"inset-0"),children:[t&&s.jsx("div",{className:w("absolute inset-0",n&&"max-w-[3200px]",c),children:s.jsx("img",{"data-testid":"shopping-event-banner-img",src:t,alt:"",className:"size-full object-cover"})}),e&&s.jsx("div",{className:w("relative mx-auto h-full w-full",i?"animate-fadeInSlow":"opacity-0",n&&"max-w-[3200px]",c),children:s.jsx("video",{"data-testid":"shopping-event-banner-video",ref:d,className:"size-full object-cover",src:e,autoPlay:!0,muted:!0,loop:!0,playsInline:!0})})]})})},on=({shoppingEvent:e,onClick:t})=>{var n,c,o,d,i,l,r,u;const a=p.useMemo(()=>{var h,g;if(!e)return;const f=ye(ge.CardBackgroundImageWebDesktop,e.media),m=ye(ge.CardBackgroundImageWebMobile,e.media);return{videoDesktop:(h=ye(ge.CardBackgroundVideoWebDesktop,e.media))==null?void 0:h.url,videoMobile:(g=ye(ge.CardBackgroundVideoWebMobile,e.media))==null?void 0:g.url,imageDesktop:f,imageMobile:m}},[e]);return s.jsx(Q,{to:(e==null?void 0:e.destinationUrl)||"",className:"block","data-testid":"shopping-event-card",onClick:()=>{t()},children:s.jsxs("div",{className:"pointer-events-none relative h-[255px] w-full max-w-pageWidth overflow-hidden rounded-radius-28 sm:h-[200px]",children:[s.jsxs("div",{className:"flex h-full flex-col-reverse items-start justify-between gap-space-8 p-space-16 sm:flex-row sm:items-center sm:px-space-24",children:[s.jsxs("div",{className:"z-10 flex-col items-center justify-center gap-space-4 sm:items-start sm:gap-space-24",children:[s.jsxs("div",{className:"flex w-full items-center justify-start gap-space-8",children:[s.jsx(L,{"data-testid":"shopping-event-card-title",variant:"headerNormal",className:"hidden text-text-inverse sm:block",style:{fontSize:32,letterSpacing:-1.7},children:(n=e==null?void 0:e.texts)==null?void 0:n.expandedBannerTitle}),s.jsx(L,{"data-testid":"shopping-event-card-title",variant:"headerNormal",className:"block text-text-inverse sm:hidden",style:{fontSize:24,letterSpacing:-.5},children:(c=e==null?void 0:e.texts)==null?void 0:c.expandedBannerTitle}),s.jsx("div",{className:"block rounded-full bg-bg-overlay-fixed-icon",children:s.jsx(V,{name:"bold-right-chevron",size:"xl",className:"text-text-inverse"})})]}),s.jsx(L,{variant:"subtitleSmall","data-testid":"shopping-event-card-subtitle",className:"z-10 text-left text-text-inverse sm:text-left",children:(o=e==null?void 0:e.texts)==null?void 0:o.expandedBannerSubtitle})]}),s.jsx(Da,{endDate:e.endDate,textOverride:(d=e==null?void 0:e.texts)==null?void 0:d.countdownText})]}),s.jsx("div",{className:"absolute inset-0 hidden sm:block",children:s.jsx(St,{videoUrl:a==null?void 0:a.videoDesktop,imageUrl:(i=a==null?void 0:a.imageDesktop)==null?void 0:i.url,backgroundColor:(l=a==null?void 0:a.imageDesktop)==null?void 0:l.backgroundColor,maxWidth:!0,contentClassName:"h-[200px]"})}),s.jsx("div",{className:"absolute inset-0 sm:hidden",children:s.jsx(St,{videoUrl:a==null?void 0:a.videoMobile,imageUrl:(r=a==null?void 0:a.imageMobile)==null?void 0:r.url,backgroundColor:(u=a==null?void 0:a.imageMobile)==null?void 0:u.backgroundColor,maxWidth:!0,contentClassName:"h-[255px] w-full"})})]})})},cn=({item:e})=>{const t=M(),a=p.useCallback(()=>{t.entityViewed({entityId:e.shoppingEvent.handle,entityType:T.ShoppingEventCard,xPos:e.xPos})},[e.shoppingEvent.handle,e.xPos,t]),n=p.useCallback(()=>{t.entityPressed({entityId:e.shoppingEvent.handle,entityType:T.ShoppingEventCard,xPos:e.xPos})},[e.shoppingEvent.handle,e.xPos,t]);return s.jsx(z,{onImpression:a,triggerOnce:!0,children:s.jsx(on,{"data-testid":"feed-shopping-event-card",shoppingEvent:e.shoppingEvent,onClick:n})})},ln={[ke.BRAND_TEXT_SMALL]:"brandTextSmall",[ke.BRAND_TEXT_LARGE]:"brandTextLarge",[ke.CAPTION_MEDIUM]:"captionMedium"},dn=({item:e})=>{var o,d;const t=M(),a=p.useCallback(()=>{t.entityPressed({entityId:e.action.url,entityType:T.ActionCard,xPos:e.xPos})},[e.action.url,e.xPos,t]),n=p.useCallback(()=>{t.entityViewed({entityId:e.action.url,entityType:T.ActionCard,xPos:e.xPos})},[e.action.url,e.xPos,t]),c=e.displayHints.fontVariant&&ln[e.displayHints.fontVariant];return s.jsx(z,{onImpression:n,triggerOnce:!0,children:s.jsx(Ys,{label:e.action.label,url:e.action.url,imageUrl:(o=e.backgroundImage)==null?void 0:o.url,imageThumbhash:(d=e.backgroundImage)==null?void 0:d.thumbhash,onClick:a,fontVariant:c||void 0})})};function lt({onRemove:e}){const[t,a]=p.useState(!1),n=p.useCallback(async c=>{c.preventDefault();try{a(!0),await e(),a(!1)}catch{a(!1)}},[e]);return t?null:s.jsx(J,{"data-testid":"remove-overlay-item",name:"cross",variant:"blurred",ariaLabel:P.t("Feed.FeedCard.OverlayItems.Remove"),onClick:n,size:"m"})}var Le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RemoveProduct"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productViewDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userErrors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"field"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"deletedProductViewId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:146}};Le.loc.source={body:`mutation RemoveProduct($id: ID!) {
  productViewDelete(id: $id) {
    userErrors {
      field
      message
    }
    deletedProductViewId
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function we(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var a=e.type;a.kind==="NamedType"&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(n){we(n,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(n){we(n,t)}),e.definitions&&e.definitions.forEach(function(n){we(n,t)})}var Ze={};(function(){Le.definitions.forEach(function(t){if(t.name){var a=new Set;we(t,a),Ze[t.name.value]=a}})})();function Nt(e,t){for(var a=0;a<e.definitions.length;a++){var n=e.definitions[a];if(n.name&&n.name.value==t)return n}}function un(e,t){var a={kind:e.kind,definitions:[Nt(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var n=Ze[t]||new Set,c=new Set,o=new Set;for(n.forEach(function(i){o.add(i)});o.size>0;){var d=o;o=new Set,d.forEach(function(i){if(!c.has(i)){c.add(i);var l=Ze[i]||new Set;l.forEach(function(r){o.add(r)})}})}return c.forEach(function(i){var l=Nt(e,i);l&&a.definitions.push(l)}),a}un(Le,"RemoveProduct");var De={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RemoveShop"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shopViewDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userErrors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"field"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"deletedShopViewId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:137}};De.loc.source={body:`mutation RemoveShop($id: ID!) {
  shopViewDelete(id: $id) {
    userErrors {
      field
      message
    }
    deletedShopViewId
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function je(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var a=e.type;a.kind==="NamedType"&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(n){je(n,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(n){je(n,t)}),e.definitions&&e.definitions.forEach(function(n){je(n,t)})}var Je={};(function(){De.definitions.forEach(function(t){if(t.name){var a=new Set;je(t,a),Je[t.name.value]=a}})})();function Tt(e,t){for(var a=0;a<e.definitions.length;a++){var n=e.definitions[a];if(n.name&&n.name.value==t)return n}}function hn(e,t){var a={kind:e.kind,definitions:[Tt(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var n=Je[t]||new Set,c=new Set,o=new Set;for(n.forEach(function(i){o.add(i)});o.size>0;){var d=o;o=new Set,d.forEach(function(i){if(!c.has(i)){c.add(i);var l=Je[i]||new Set;l.forEach(function(r){o.add(r)})}})}return c.forEach(function(i){var l=Tt(e,i);l&&a.definitions.push(l)}),a}hn(De,"RemoveShop");function Pt(e){var t;return!(e!=null&&e.length)||e.length===1&&((t=e[0])==null?void 0:t.__typename)==="ViewAllCard"}function dt({id:e}){const{reportEvent:t}=se(),{showGenericError:a}=rt(),{trackingValues:{sectionId:n,sectionFormat:c}}=de(),[o]=Pe(Le),[d]=Pe(De),{send:i}=Xe(()=>({async removeProduct(){return o({variables:{id:e},optimisticResponse:{productViewDelete:{__typename:"ProductViewDeletePayload",userErrors:[],deletedProductViewId:e}},update:(r,{data:u})=>{const f=r.identify({__typename:c,id:n});r.modify({id:f,fields:{items:(m,{readField:h})=>{var I;const g=(I=u==null?void 0:u.productViewDelete)==null?void 0:I.deletedProductViewId;if(!g)return m;const b=m.nodes.filter(S=>g!==h("id",h("product",S)));if(Pt(b)){r.evict({id:f});return}return{...m,nodes:b}}}})}})},async removeShop(){return d({variables:{id:e},optimisticResponse:{shopViewDelete:{__typename:"ShopViewDeletePayload",userErrors:[],deletedShopViewId:e}},update:(r,{data:u})=>{const f=r.identify({__typename:c,id:n});r.modify({id:f,fields:{items:(m,{readField:h})=>{var I;const g=(I=u==null?void 0:u.shopViewDelete)==null?void 0:I.deletedShopViewId;if(!g)return m;const b=m.nodes.filter(S=>g!==h("id",h("shop",S)));if(Pt(b)){r.evict({id:f});return}return{...m,nodes:b}}}})}})},onItemDeleted:({type:r,deletedItemId:u,hasErrors:f})=>{if(f||!u){a();return}t({schemaId:"shop_app_entity_interaction/4.4",payload:{entityType:T.FeedSection,entityId:n,interactionValue:u||void 0,interactionType:r}})}})),{send:l}=Xe(()=>({async removeProductFromRecentlyViewed(){var u,f,m,h,g,b;const r=await i.removeProduct();i.onItemDeleted({type:G.RecentlyViewedProductRemoved,deletedItemId:(f=(u=r==null?void 0:r.data)==null?void 0:u.productViewDelete)==null?void 0:f.deletedProductViewId,hasErrors:!!((m=r==null?void 0:r.errors)!=null&&m.length||(b=(g=(h=r==null?void 0:r.data)==null?void 0:h.productViewDelete)==null?void 0:g.userErrors)!=null&&b.length)})},async removeShopFromRecentlyViewed(){var u,f,m,h,g,b;const r=await i.removeShop();i.onItemDeleted({type:G.RecentlyViewedShopRemoved,deletedItemId:(f=(u=r==null?void 0:r.data)==null?void 0:u.shopViewDelete)==null?void 0:f.deletedShopViewId,hasErrors:!!((m=r==null?void 0:r.errors)!=null&&m.length||(b=(g=(h=r==null?void 0:r.data)==null?void 0:h.shopViewDelete)==null?void 0:g.userErrors)!=null&&b.length)})}}));return l}function pn({index:e,item:t,onImpression:a,onClick:n}){var m,h;const{selectedItemIndex:c,onHoverIndex:o,onMouseLeave:d,feedId:i}=pe(),l=new URLSearchParams((i==null?void 0:i.split("?")[1])||"").get("query"),r=c===e,u=ot(),f=p.useCallback(()=>{u?u.navigateByContentNode(t,{index:c||0,searchTerm:l||""}):n()},[l,t,u,n,c]);return s.jsx(z,{onImpression:a,triggerOnce:!0,children:s.jsx(Xt,{shop:t.shop,onClick:f,onMouseEnter:()=>{o==null||o(e||0)},onMouseLeave:()=>{d==null||d()},children:s.jsxs("div",{"data-testid":"compact-merchant-card",className:w("flex w-full items-center gap-space-12 rounded-radius-max p-space-2 hover:bg-bg-overlay-fixed-dark-04",r&&"bg-bg-overlay-fixed-dark-04"),children:[s.jsx("div",{className:"p-space-2",children:s.jsx(te,{size:"s",shopName:t.shop.name,src:(h=(m=t.shop.visualTheme)==null?void 0:m.logoImage)==null?void 0:h.url,className:"shrink-0",hasIncentive:ee(t.shop.shopCashIncentive)})}),s.jsx(L,{variant:"bodySmall",className:"max-w-[75%] flex-1 truncate text-text",children:t.shop.name})]})})})}function mn({index:e,item:t,cardSize:a}){var l,r,u;const n=M(),c=p.useCallback(()=>{n.entityViewed({entityId:t.shop.id,entityType:T.ShopLink,xPos:t.xPos,MedusaJSId:t.shop.MedusaJSId})},[t.shop.id,t.shop.MedusaJSId,t.xPos,n]),o=p.useCallback(()=>{n.entityPressed({entityId:t.shop.id,entityType:T.ShopLink,xPos:t.xPos,MedusaJSId:t.shop.MedusaJSId})},[t.shop.id,t.shop.MedusaJSId,t.xPos,n]),{removeShopFromRecentlyViewed:d}=dt({id:t.shop.id}),i=(l=t.overlayItems)==null?void 0:l.some(f=>f.kind===oe.REMOVE&&f.position===ce.TOP_RIGHT);return a===K.XXS?s.jsx(pn,{index:e,item:t,onImpression:c,onClick:o}):hs(t.displayHints,Kt.AVATAR)?s.jsx(z,{onImpression:c,triggerOnce:!0,children:s.jsx(Xt,{shop:t.shop,onClick:o,children:s.jsx(te,{size:"auto",shopName:t.shop.name,src:(u=(r=t.shop.visualTheme)==null?void 0:r.logoImage)==null?void 0:u.url,hasIncentive:ee(t.shop.shopCashIncentive)})})}):s.jsx(Zs,{shop:t.shop,featuredImagesLimit:2,hideCTA:!0,onImpression:c,onClick:o,imageTopRightActions:i&&s.jsx(lt,{onRemove:d}),className:"h-full"})}const fn=({onClick:e,disabled:t=!1,loading:a=!1,success:n=!1})=>{const{t:c}=he();return s.jsx("div",{className:"overflow-hidden",children:s.jsx(Te,{"data-testid":"add-to-cart-compact-btn",size:"m",className:w("min-w-space-32 rounded-radius-max","transition","relative","flex","items-center","justify-center"),variant:"dark",disabled:t,onClick:o=>{o.preventDefault(),e()},children:s.jsxs("div",{className:w("absolute inset-0 flex h-[200%] flex-1 flex-col items-center","transition-transform delay-150 duration-500 ease-in-out",n&&"translate-y-[-50%]"),"aria-label":c("ProductDetails.AddToCart"),children:[a&&s.jsx("div",{className:"flex h-1/2 items-center","data-testid":"add-to-cart-compact-spinner",children:s.jsx(Js,{size:12,className:"bg-bg-fill-inverse"})}),!a&&s.jsx("span",{className:"flex h-1/2 items-center","data-testid":"add-to-cart-compact-icon",children:s.jsx(V,{name:"add-to-cart-compact",size:"m"})}),!a&&s.jsx("span",{className:"flex h-1/2 items-center","data-testid":"add-to-cart-compact-checkmark",children:s.jsx(V,{name:"add-to-cart-checkmark",size:"m"})})]})})})};function xn(e){if(!(e!=null&&e.length))return null;const t=e.filter(a=>"discountedAmount"in a?parseInt(a.discountedAmount.amount,10)>0:!1);return t.length?t:null}function Zr(e){switch(e.__typename){case"CartShopCashDiscountAllocation":return P.t("Cart.ExclusiveOfferLabel");case"CartAutomaticDiscountAllocation":case"CartCodeDiscountAllocation":case"CartCustomDiscountAllocation":default:return P.t("Cart.DiscountApplied")}}const vn=e=>({...e,source:e.source}),yn=e=>e.map(vn).filter(Gt),gn=(e,t)=>{if(e)return{...e,metadata:{loading:t(e.productVariant.id)},warnings:e.warnings??[]}},bn=(e,t)=>e?e.map(a=>gn(a,t)).filter(Gt):[],In=e=>e.map(({quantity:t,productVariant:a})=>({quantity:t,variantId:a.id})),Cn=(e,t)=>{var g;const{id:a,shop:n,cartType:c,offers:o,lines:{nodes:d},cartCost:{totalPrice:i},updatedBy:l,shopCashIncentive:r,discountAllocations:u,totalQuantity:f,recommendations:m,warnings:h}=e;return{__typename:"Cart",id:a,totalPrice:i,totalQuantity:f,shop:{...n,logoImage:(g=n.visualTheme)==null?void 0:g.logoImage},lines:bn(d,(t==null?void 0:t.variantLoading)??(()=>!1)),loading:(t==null?void 0:t.loading)??!1,isSyncedCart:l===Qt.CART_SYNC,isReferralCart:c==="referral_cart",discountAllocations:xn(u)??[],shopCashIncentive:r,offers:yn(o),recommendations:m,warnings:h??[]}},kn=({onClick:e,success:t,disabled:a,loading:n,size:c="xl",iconOnSuccess:o=!1})=>s.jsx(Te,{"data-testid":"add-to-cart-btn",className:"w-full overflow-hidden",size:c,variant:"primary-juicy",loading:n,onClick:e,disabled:a,children:s.jsx("div",{className:"flex h-full flex-1 overflow-hidden",children:s.jsxs("div",{className:w("absolute inset-0 flex h-[200%] flex-1 flex-col items-center","transition-transform delay-150 duration-300 ease-in-out",t&&"translate-y-[-50%]"),children:[!n&&s.jsx("span",{className:"flex h-1/2 items-center","aria-hidden":t,children:P.t("ProductDetails.AddToCart")}),!n&&s.jsxs("span",{className:"row-auto flex h-1/2 content-center items-center justify-center",children:[s.jsx(V,{name:"checkmark-circle",className:"mr-space-4 text-text-fixed-light"}),!o&&P.t("ProductDetails.AddedToCart")]})]})})}),wn=96,Jr=.9,jn=["out of stock.","not have enough stock."];class et extends aa{constructor(t){jn.includes(t.message)?super(""):super(t.message),this.code=t.code||"UNKNOWN",this.name="CheckoutError",this.localizedMessage=this.localizeErrorMessage()}localizeErrorMessage(){return{CART_PRODUCT_NOT_ENOUGH_STOCK:P.t("LocalizedErrorMessage.CartProductNotEnoughStock"),CART_PRODUCT_NOT_FOUND:P.t("LocalizedErrorMessage.CartProductNotFound"),CART_PRODUCT_OUT_OF_STOCK:P.t("LocalizedErrorMessage.CartProductOutOfStock"),CART_PRODUCT_QUANTITY_INVALID:P.t("LocalizedErrorMessage.CartProductQuantityInvalid"),CART_PRODUCT_STOCK_LIMIT_REACHED:P.t("LocalizedErrorMessage.CartProductStockLimitReached"),CART_SHOP_INELIGIBLE:P.t("LocalizedErrorMessage.CartShopNotEligible"),CART_UNAVAILABLE:P.t("LocalizedErrorMessage.CartUnavailable")}[this.code]??P.t("LocalizedErrorMessage.Default")}}var Ve={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateCheckoutWithCart"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"brokerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"checkoutWithCartCreate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"brokerId"},value:{kind:"Variable",name:{kind:"Name",value:"brokerId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"checkout"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cartId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isShopPay"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errorCode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webFallbackUrl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"userErrors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:283}};Ve.loc.source={body:`mutation CreateCheckoutWithCart($brokerId: ID!) {
  checkoutWithCartCreate(brokerId: $brokerId) {
    checkout {
      id
      cartId
      isShopPay
      status
      token
      url
      errorCode
      webFallbackUrl
    }
    userErrors {
      message
      code
    }
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function Se(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var a=e.type;a.kind==="NamedType"&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(n){Se(n,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(n){Se(n,t)}),e.definitions&&e.definitions.forEach(function(n){Se(n,t)})}var tt={};(function(){Ve.definitions.forEach(function(t){if(t.name){var a=new Set;Se(t,a),tt[t.name.value]=a}})})();function _t(e,t){for(var a=0;a<e.definitions.length;a++){var n=e.definitions[a];if(n.name&&n.name.value==t)return n}}function Sn(e,t){var a={kind:e.kind,definitions:[_t(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var n=tt[t]||new Set,c=new Set,o=new Set;for(n.forEach(function(i){o.add(i)});o.size>0;){var d=o;o=new Set,d.forEach(function(i){if(!c.has(i)){c.add(i);var l=tt[i]||new Set;l.forEach(function(r){o.add(r)})}})}return c.forEach(function(i){var l=_t(e,i);l&&a.definitions.push(l)}),a}Sn(Ve,"CreateCheckoutWithCart");const Nn=()=>{const[e]=Pe(ia),[t]=Pe(Ve),{preferredAddress:a}=ra(),n=p.useCallback(async o=>{const{brokerId:d,lineItems:i}=o,l=await e({variables:{brokerId:d,lineItems:i,mailingAddress:a!=null&&a.address?na(a.address):void 0}}),{data:r,errors:u}=l||{};if(u!=null&&u.length)throw u[0];const{userErrors:f,checkout:m}=(r==null?void 0:r.checkoutWithLineItemsCreate)||{};if(f!=null&&f.length)throw new et(f[0]);if(m){const{cartId:h,url:g,id:b}=m;return{cartId:h,url:g,id:b}}},[e,a==null?void 0:a.address]),c=p.useCallback(async o=>{const{brokerId:d}=o,i=await t({variables:{brokerId:d}}),{data:l,errors:r}=i||{};if(r!=null&&r.length)throw r[0];const{userErrors:u,checkout:f}=(l==null?void 0:l.checkoutWithCartCreate)||{};if(u!=null&&u.length)throw new et(u[0]);if(f){const{cartId:m,url:h,id:g}=f;return{cartId:m,url:h,id:g}}},[t]);return{handleCheckoutWithLineItemsMutation:n,handleCheckoutWithCartMutation:c}},Tn=(e,t,a)=>{const{origin:n}=new URL(a),c=`/cart/${e}:${t}`,o=new URL(`${n}${c}`);return _e(o.toString(),{target:Ae.Checkout,isShopCashEnabled:!0})},Pn=(e,t)=>{const{origin:a}=new URL(t),c=`/cart/${e.map(i=>`${i.variantId}:${i.quantity}`).join(",")}`,o=new URL(`${a}${c}`);return _e(o.toString(),{target:Ae.Checkout,isShopCashEnabled:!0})},_n=()=>{const{userAuthState:e,currentUser:t}=Ut(),{isCookiesConsentRequired:a,_MedusaJS_s:n,_MedusaJS_y:c}=Ss("root")||{isCookiesConsentRequired:!1},o=t==null?void 0:t.email,d=ea(),i=h=>new URL(h).searchParams.get("key")||void 0,{handleCheckoutWithLineItemsMutation:l,handleCheckoutWithCartMutation:r}=Nn(),u=Ts(),f=p.useCallback(async h=>{const{brokerId:g,currentVariantId:b,quantity:I,brokerUrl:S,sellingPlanId:_}=h,A=b.split("/").pop();if(!A)return;const k=(y,j)=>{xe(ve.BuyNow,{success:!1,error:y,isCookiesConsentRequired:a});const R=Tn(A,I,S);Me.notify(y,{metadata:{...j,checkoutUrl:R}}),window.location.assign(R)};if(e===Wt.Anonymous){const y=await sa({signInFallback:!1,triggerLogInWithShop:()=>d({entityId:ta.BuyNow,scope:"EMAIL"}),cookies:u});if(!(y!=null&&y.ok))return k("FailedToSignInUserAsGuest")}try{const y=await l({brokerId:g,lineItems:[{variantId:b,quantity:I,sellingPlanId:_}]});if(!y)return k("CreatedCheckoutIsNullOrUndefined");const{cartId:j,url:R}=y,x=R?i(R):void 0;return R?(xe(ve.BuyNow,{success:!0,isCookiesConsentRequired:a}),window.location.assign(_e(R,{target:Ae.Checkout,isShopCashEnabled:!0,fastLoginEmail:o,trackingUnique:c||bt,trackingVisit:n||gt})),j||void 0):k("CheckoutIsMissingData",{cartId:j,url:R,key:x})}catch(y){throw y instanceof et||Me.notify(y),y}},[l,d,e,o,a,u,n,c]);return{createCheckoutWithCartAndRedirect:p.useCallback(async h=>{const{brokerId:g,lineItems:b,websiteUrl:I,isReferralCart:S}=h,_=()=>{const k=In(b);if(xe(ve.Checkout,{success:!1,isCookiesConsentRequired:a}),!I)throw Error("No websiteUrl present");const y=Pn(k,I);Me.notify(`Failed to create checkout on Cart - fallback to merchant checkout: ${y}`),window.location.assign(y)},A=await r({brokerId:g});if(!A||!A.url)return _();xe(ve.Checkout,{success:!0,isCookiesConsentRequired:a}),window.location.assign(_e(A.url,{target:Ae.Checkout,isShopCashEnabled:!0,fastLoginEmail:o,trackingUnique:c||bt,trackingVisit:n||gt,isReferralCart:S}))},[r,o,a,n,c]),createCheckoutForBuyNowAndRedirect:f}},An=()=>{const{showToast:e,closeGroup:t}=rt();return{showSnackBar:p.useCallback(n=>e({...n,variant:"snackbar"}),[e]),closeGroup:t}},Rn=({eventId:e,cartId:t,product:a,variant:n,quantity:c})=>{var o;return{eventId:e,MedusaJSShopId:B(a.shop.MedusaJSId),shopId:Number(a.shop.id),cartToken:t,product:{product_id:B(a.id)||0,product_title:a.title,variant_id:B((o=n==null?void 0:n.id.match(/(\d+)$/))==null?void 0:o[0])||0,variant_title:(n==null?void 0:n.title)||"",variant_price:Number((n==null?void 0:n.price.amount)||0),quantity:c,currency:(n==null?void 0:n.price.currencyCode)||"USD"},totalPrice:Number((n==null?void 0:n.price.amount)||0)*c,currency:(n==null?void 0:n.price.currencyCode)||"USD",shopCashCampaignValue:a.shop.shopCashCampaignValue}},En=({product:e,quantity:t=1,compact:a=!1,size:n,onClickOverride:c,iconOnSuccess:o=!1})=>{const{t:d}=he(),[i,l]=p.useState(!1),[r,u]=p.useState(!1),{addToCart:f}=_s(),{createCheckoutWithCartAndRedirect:m}=_n(),{reportEvent:h}=se(),g=st(),{productAddedToCart:b}=oa(),{showToast:I}=rt(),{showSnackBar:S}=An(),_=p.useCallback(async()=>{var A,k;try{u(!0);const y=$s(),j=await f({brokerId:e.shop.id,variantId:e.defaultVariantId,quantity:t}),R=j==null?void 0:j.id;j!=null&&j.warnings&&j.warnings.length>0&&j.warnings.forEach(v=>{I({title:v.message,variant:"feedback"})});const x=(k=(A=j==null?void 0:j.lines)==null?void 0:A.nodes)==null?void 0:k.find(v=>{var C;return((C=v==null?void 0:v.productVariant)==null?void 0:C.id)===e.defaultVariantId});if(x!=null&&x.warnings&&x.warnings.length>0&&x.warnings.forEach(v=>{I({title:v.message,variant:"feedback"})}),R){const v={eventType:"add",productId:e.id,productVariantId:e.defaultVariantId,quantity:t,price:B(e.price.amount)??0,shopCurrencyCode:e.price.currencyCode,brokerId:B(e.shop.id)??0,cartId:R};h({schemaId:"shop_app_cart_line_item_update/2.1",payload:v}),g.productAddedToCart({cartId:R,productId:Number(v.productId),productVariantId:Number(Bt(v.productVariantId)),quantity:t,brokerId:v.brokerId,variantPrice:v.price,currency:v.shopCurrencyCode}),h({schemaId:"shop_app_entity_interaction/4.4",payload:{brokerId:B(e.shop.id)??0,entityType:T.Cart,entityId:R,interactionType:G.OrderAddToCart,interactionValue:"inline"}})}if(b(Rn({eventId:y,cartId:R,product:e,variant:{id:e.defaultVariantId,title:e.title,price:e.price},quantity:t})),l(R!==void 0),j){const v=e.shop.name,C=`${e.images[0].url}&width=${wn}`,N=e.images[0].altText||"",E=()=>{const D=Cn(j);m({brokerId:j.shop.id,lineItems:D.lines,websiteUrl:j.shop.websiteUrl}),h({schemaId:"shop_app_entity_interaction/4.4",payload:{entityType:T.Cart,entityId:j.id,brokerId:B(j.shop.id)??0,interactionType:G.GoToCheckoutSnackBarPressed}})};S({title:v,description:d("ProductDetails.CheckoutSnackBar.Items",{defaultValue:"",count:j.totalQuantity}),leftIconComponent:s.jsxs("div",{className:"relative aspect-square w-[56px] overflow-hidden rounded-radius-8 md:w-[84px]",children:[s.jsx(Ce,{src:C,alt:N}),s.jsx("div",{className:"absolute inset-0 bg-bg-overlay-inverse-04"})]}),cta:{content:{text:d("ProductDetails.CheckoutSnackBar.CheckoutCTA")},action:E},groupId:"Checkout",mobileOnly:!0,linkTo:"/cart"}),h({schemaId:"shop_app_entity_interaction/4.4",payload:{entityType:T.Cart,entityId:j.id,brokerId:B(j.shop.id)??0,interactionType:G.GoToCheckoutSnackBarShown}})}}catch(y){let j=null;y instanceof As?j=y.localizedMessage:y instanceof Error&&(j=d("Cart.SomethingWentWrong")),j&&I({title:j,variant:"error"}),u(!1)}},[f,e,t,b,h,g,S,m,I,d]);return p.useEffect(()=>{i&&(u(!1),I({title:d("ProductDetails.AddedToCart"),variant:"feedback"}),setTimeout(()=>{l(!1)},3e3))},[i,I,d]),a?s.jsx(fn,{onClick:_,loading:r,success:i}):s.jsx(kn,{onClick:c??_,success:i,loading:r,size:n,iconOnSuccess:o})};function On({index:e,item:t,cardSize:a}){var y;const{feedId:n}=pe(),{sectionIndex:c}=de(),o=n!=null&&n.startsWith("home")&&c===0?5:6,d=M(),i=t.product,l=(y=at())==null?void 0:y.inNativeWebView,r=ue(),{removeProductFromRecentlyViewed:u}=dt({id:i.id}),f=p.useCallback(()=>{d.productViewed(t)},[d,t]),m=p.useCallback(()=>{d.productPressed(t),r==null||r.navigateToProduct({productId:i.id,variantId:i.defaultVariantId})},[d,t,r,i.id,i.defaultVariantId]),{showProductName:h,showShopName:g,showPrice:b,showReviews:I}=za(t.displayHints.options,a),S=Be(t.overlayItems,oe.REMOVE,ce.TOP_RIGHT),_=Be(t.overlayItems,oe.ADD_TO_CART,ce.BOTTOM_RIGHT),A=Be(t.overlayItems,oe.FAVOURITE,ce.BOTTOM_RIGHT),k=_&&s.jsx(En,{product:i,compact:!0})||A&&s.jsx(Ne,{product:i});return s.jsx(Vs,{product:i,badge:t.badge,imageBottomRightActions:k,onImpression:f,onClick:m,imageTopRightActions:S&&s.jsx(lt,{onRemove:u}),navigateToPDP:!l,lazy:!r&&e!==void 0&&e>=o,fetchPriority:c===0?"high":void 0,children:h?s.jsxs("div",{className:ca.FeedCardText,children:[g?s.jsx(Ht,{product:i}):null,h?s.jsx(Ee,{product:i}):null,I?s.jsx(Oe,{product:i}):null,b?s.jsx(nt,{product:i}):null]}):null})}const Ln=(e,t)=>t?ze.Grayscale.L0:e?ze.Grayscale.L0:ze.Grayscale.D100,At=({storeName:e,storeUrl:t,selected:a,visualTheme:n,hasProducts:c,onImpression:o,onClick:d})=>{const{t:i}=he(),{theme:l}=Xs(),r=l==="dark",[u,f]=p.useState(c?0:2),[m,h]=p.useState(!1),{videoUrl:g,coverImage:b,wordmarkImage:I,thumbnailImage:S,foregroundColor:_}=p.useMemo(()=>{var x,v,C,N,E,D,O;const{brandSettings:y}=n??{},j=!!((x=y==null?void 0:y.headerTheme)!=null&&x.coverImage||(v=y==null?void 0:y.headerTheme)!=null&&v.thumbnailImage||(C=y==null?void 0:y.headerTheme)!=null&&C.videoUrl),R=Ln(r,j);return{videoUrl:(N=y==null?void 0:y.headerTheme)==null?void 0:N.videoUrl,coverImage:(E=y==null?void 0:y.headerTheme)==null?void 0:E.coverImage,wordmarkImage:(D=y==null?void 0:y.logos)==null?void 0:D.logoImage,thumbnailImage:(O=y==null?void 0:y.headerTheme)==null?void 0:O.thumbnailImage,foregroundColor:R}},[r,n]),A=()=>{setTimeout(()=>{f(1)},300),setTimeout(()=>{f(2)},1500)};p.useEffect(()=>{c&&(a?A():f(0))},[c,a]),p.useEffect(()=>{a&&(o==null||o())},[a,o]);const k=_?{color:_}:void 0;return s.jsx("div",{className:"size-full overflow-hidden bg-bg-overlay-inverse-04 max-lg:absolute max-lg:inset-0",children:s.jsxs(Ge,{to:t,onClick:d,testId:"bookend-link",ariaLabel:i("MerchantCard.ShopAriaLabel",{storeName:e}),children:[s.jsxs("div",{className:w("absolute inset-0 z-10 flex transform-gpu items-center justify-center transition-all duration-500",u>=1?"opacity-100 lg:translate-y-0":"lg:-translate-y-s opacity-0"),"data-testid":"logo-container","aria-label":i("MerchantCard.ShopAriaLabel",{storeName:e}),children:[m||!(I!=null&&I.url)?s.jsx(L,{variant:"sectionTitle",className:"text-center text-text-inverse transition-transform duration-150 group-hover:scale-105",style:k,children:e}):s.jsx(da,{src:I==null?void 0:I.url,alt:(I==null?void 0:I.altText)||e,className:"max-h-space-64 min-h-space-40 max-w-[60%] object-contain transition-transform duration-150 group-hover:scale-105 md:max-w-[140px]","data-testid":"store-data-wordmark",imageSizeAtBreakpoint:{default:It.mUrl},onError:()=>h(!0)}),s.jsx("div",{className:w("absolute bottom-space-32 z-10 hidden w-full transform-gpu justify-center pt-space-12 transition-all duration-700 lg:flex",u>=2?"opacity-100":"opacity-0",!c&&"lg:hidden"),"data-testid":"visit-store",children:s.jsx(L,{variant:"bodyTitleSmall",className:"text-text-inverse",style:k,children:i("Header.VisitStore")})})]}),s.jsx("div",{className:"size-full",children:s.jsx(Ks,{context:"feed",videoUrl:g,coverImage:b,thumbnailImage:S,showScrim:"always-show",forceShowBackgroundColor:!0,className:w("h-full md:h-full lg:h-full"),rounded:!1,imageSizeAtBreakpoint:{default:It.smUrl}})})]})})};function Rt({product:e,selected:t,xPos:a,rounded:n=!1,borderClassName:c,onImpression:o,onClick:d}){const{t:i}=he(),l=p.useRef(!1),r=p.useCallback(()=>{d==null||d({productId:e.id,xPos:a})},[d,e.id,a]),u=it({productId:e.id,slug:e.slug});return p.useEffect(()=>{t&&a!==0&&!l.current&&(o==null||o({productId:e.id,xPos:a}),l.current=!0)},[o,e.id,t,a]),s.jsx(z,{onImpression:()=>o==null?void 0:o({productId:e.id,xPos:a}),triggerOnce:!0,children:s.jsx(Q,{to:u,"data-testid":"product-link",onClick:r,"aria-label":i("ProductCard.ImageAriaLabel",{productTitle:e.title}),children:s.jsx(le,{image:e.images[0],rounded:n,productTitle:e.title,borderClassName:c})})})}const Et=.9,Ot="absolute inset-0 transition-opacity",Lt="snap-center aspect-square h-full w-auto",Dt="pointer-events-auto bg-bg-fill opacity-0 shadow-xs transition-opacity group-hover:opacity-70",Dn=({shop:e,products:t,displayHints:a,onStoreImpression:n,onProductImpression:c,onStoreClick:o,onProductClick:d,imageTopRightActions:i,badge:l})=>{var E,D;const{t:r,i18n:u}=he(),{reportEvent:f}=se(),m=u.language,{productReviewAnalytics:h,visualTheme:g,name:b,defaultHandle:I}=e,[S,_]=p.useState(0),A=p.useCallback(O=>{_(O),f({schemaId:"shop_app_entity_interaction/4.4",payload:{entityType:T.ProductFocusedMerchantCard,entityId:e.id,interactionType:G.ProductFocusedMerchantCardSwiped,interactionValue:O.toString()}})},[f,e.id]),k=((E=a==null?void 0:a.options)==null?void 0:E.includes(qt.SHOW_MERCHANT_BOOKEND))??!1,y=t.length>0,j=t.length>0&&(k||t.length>1),R=p.useCallback(()=>{const O=k?t.length:t.length-1;A(S===0?O:S-1)},[A,t.length,S,k]),x=p.useCallback(()=>{const O=k?t.length:t.length-1;A(S===O?0:S+1)},[A,t.length,S,k]),{totalProductReviews:v,averageRating:C}=h??{},N=l?s.jsx("div",{className:w("absolute left-space-12 top-space-12 z-10 transform-gpu transition-opacity lg:left-space-16 lg:top-space-16",t.length===0||t.length>0&&(!k||S!==t.length)?"opacity-100":"opacity-0"),"data-testid":"shop-cash-badge",children:s.jsx($t,{variant:l.badgeVariant,textAccessibilityLabel:l.textAccessibilityLabel,text:l.badgeText})}):null;return s.jsx(z,{onImpression:n,triggerOnce:!0,children:s.jsxs("div",{className:"flex flex-col gap-space-8","data-testid":"product-focused-merchant-card",children:[s.jsxs("div",{className:w("relative aspect-square w-full","overflow-hidden rounded-radius-20 shadow-xs after:pointer-events-none after:absolute after:inset-0 after:rounded-[inherit] after:border after:border-border-image"),children:[s.jsxs("div",{className:"scrollbar-hide group relative aspect-square size-full max-lg:hidden ",children:[t.map((O,F)=>s.jsx("div",{className:w(Ot,S===F?"z-10 opacity-100":"pointer-events-none opacity-0"),"data-testid":"product-item",children:s.jsx(Rt,{selected:S===F,product:O,xPos:F,onClick:d,onImpression:S===F?c:void 0,borderClassName:""})},O.id)),k&&s.jsx("div",{className:w(Ot,S===t.length?"opacity-100":"pointer-events-none opacity-0"),"data-testid":"bookend-item",children:s.jsx(yt,{themeSettings:g==null?void 0:g.brandSettings,children:s.jsx(At,{storeUrl:I?`/m/${I}`:void 0,onClick:o,visualTheme:g,storeName:b,hasProducts:y,selected:y&&S===t.length})})}),N,i&&s.jsx("div",{className:"absolute right-space-12 top-space-12 z-30",children:i}),j&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-space-16 z-20 flex items-center",children:s.jsx(J,{variant:"tertiary",name:"left-chevron",ariaLabel:r("MerchantCard.PreviousProductAriaLabel"),className:Dt,size:"m","data-testid":"prev-button",onClick:R})}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-space-16 z-20 flex items-center",children:s.jsx(J,{variant:"tertiary",name:"right-chevron",ariaLabel:r("MerchantCard.NextProductAriaLabel"),className:Dt,size:"m",onClick:x,"data-testid":"next-button"})})]})]}),s.jsxs("div",{"data-testid":"mobile-carousel-container",className:w("aspect-square h-full lg:hidden","scrollbar-hide relative","snap-x snap-mandatory overflow-x-auto overflow-y-hidden","flex"),children:[t.map((O,F)=>{const $=S===F;return s.jsx("div",{className:w(Lt),children:s.jsx(z,{threshold:Et,onImpression:()=>{A(F)},children:s.jsx(Rt,{selected:$,product:O,xPos:F,onClick:d,onImpression:$?c:void 0,borderClassName:""})})},O.id)}),k&&s.jsx("div",{className:w(Lt,"relative"),children:s.jsx(z,{className:"size-full",threshold:Et,onImpression:()=>A(t.length),children:s.jsx(yt,{themeSettings:g==null?void 0:g.brandSettings,children:s.jsx(At,{storeUrl:I?`/m/${I}`:void 0,onClick:o,visualTheme:g,storeName:b,hasProducts:y,selected:y&&S===t.length})})})})]}),N,j?s.jsx("div",{className:"absolute bottom-space-16 z-10 flex w-full transform-gpu justify-center",children:s.jsx(ts,{selectedIndex:S,numberOfDots:k?t.length+1:t.length})}):null]}),s.jsx(Q,{to:`/m/${I}`,onClick:o,"data-testid":"store-details","aria-label":r("MerchantCard.StoreDetailsAriaLabel",{storeHandle:I,storeName:b}),children:s.jsxs("div",{className:"flex items-center gap-space-8 px-space-4",children:[s.jsx(te,{size:"s",shopName:b,src:(D=g==null?void 0:g.logoImage)==null?void 0:D.url,ariaLabel:r("MerchantCard.StoreLogoAriaLabel"),hasIncentive:ee(e.shopCashIncentive)}),s.jsxs("div",{className:"flex max-w-[calc(100%-40px)] flex-1 justify-between max-lg:flex-col lg:items-center lg:gap-space-4 ",children:[s.jsx(L,{className:"line-clamp-2 break-words max-lg:hidden",variant:"bodyTitleSmall",children:b}),s.jsx(L,{className:"line-clamp-2 break-words lg:hidden",variant:"captionBold","aria-label":b,children:b}),C&&v?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"hidden lg:block","data-testid":"review-details-container","aria-label":r("ProductFocusedMerchantCard.Rating",{rating:la(C,m)}),children:s.jsx(qe,{rating:{averageRating:C},textVariant:"bodyTitleSmall",subduedReviewCount:!0})}),s.jsx("div",{className:"lg:hidden",children:s.jsx(qe,{rating:{averageRating:C},subduedReviewCount:!0})})]}):null]})]})})]})})},Vn=e=>{const{onStoreImpression:t,onStoreClick:a,onProductClick:n,shop:c,xPos:o}=e,{shopAdOnView:d,shopAdOnPress:i}=Ft(),l=st(),r=X(c.shopCashIncentive),u=p.useCallback(()=>{d({brokerId:parseInt(c.id,10),campaignId:r==null?void 0:r.campaignHandle,xPos:o,yPos:0,adResponseId:r==null?void 0:r.adResponseId,campaignCountryCode:r==null?void 0:r.campaignCountryCode,adType:r==null?void 0:r.adType}),l.entityImpression({entityType:T.Store,entityId:c.id,MedusaJSShopId:B(c.MedusaJSId),xPos:o,yPos:0,adResponseId:r==null?void 0:r.adResponseId,campaignId:r==null?void 0:r.campaignHandle}),t==null||t()},[r,l,t,c.id,c.MedusaJSId,d,o]),f=p.useCallback(()=>{i({brokerId:parseInt(c.id,10),adType:r==null?void 0:r.adType,adResponseId:r==null?void 0:r.adResponseId,campaignId:r==null?void 0:r.campaignHandle}),l.entityClicked({entityType:T.Store,entityId:c.id,MedusaJSShopId:B(c.MedusaJSId),xPos:o,yPos:0,adResponseId:r==null?void 0:r.adResponseId,campaignId:r==null?void 0:r.campaignHandle}),a==null||a()},[r,l,a,c.id,c.MedusaJSId,i,o]),m=p.useCallback(h=>{i({brokerId:parseInt(c.id,10),adType:r==null?void 0:r.adType,adResponseId:r==null?void 0:r.adResponseId,campaignId:r==null?void 0:r.campaignHandle}),l.entityClicked({entityType:T.Product,entityId:h.productId,MedusaJSShopId:B(c.MedusaJSId),xPos:h.xPos,yPos:0,adResponseId:r==null?void 0:r.adResponseId,campaignId:r==null?void 0:r.campaignHandle}),n==null||n(h)},[r,l,n,c.id,c.MedusaJSId,i]);return s.jsx(Dn,{...e,onStoreClick:f,onStoreImpression:u,onProductClick:m})};function Fn({item:e}){var l;const t=M(),a=p.useCallback(()=>{t.entityViewed({entityId:e.shop.id,entityType:T.ShopLink,xPos:e.xPos,MedusaJSId:e.shop.MedusaJSId})},[e.shop.id,e.shop.MedusaJSId,e.xPos,t]),n=p.useCallback(()=>{t.entityPressed({entityId:e.shop.id,entityType:T.ShopLink,xPos:e.xPos,MedusaJSId:e.shop.MedusaJSId})},[e.shop.id,e.shop.MedusaJSId,e.xPos,t]),c=p.useCallback(({productId:r,xPos:u})=>{t.entityViewed({entityId:r,entityType:T.Product,xPos:u,containerId:e.shop.id,containerType:T.ProductFocusedMerchantCard,MedusaJSId:e.shop.MedusaJSId})},[e.shop.id,e.shop.MedusaJSId,t]),o=p.useCallback(({productId:r,xPos:u})=>{t.entityPressed({entityId:r,entityType:T.Product,xPos:u,containerId:e.shop.id,containerType:T.ProductFocusedMerchantCard,MedusaJSId:e.shop.MedusaJSId})},[e.shop.id,e.shop.MedusaJSId,t]),{removeShopFromRecentlyViewed:d}=dt({id:e.shop.id}),i=(l=e.overlayItems)==null?void 0:l.some(r=>r.kind===oe.REMOVE&&r.position===ce.TOP_RIGHT);return s.jsx(Vn,{badge:e.badge,shop:e.shop,xPos:e.xPos,products:e.productCards.map(r=>r.product),displayHints:e.displayHints,onStoreImpression:a,onStoreClick:n,onProductImpression:c,onProductClick:o,imageTopRightActions:i&&s.jsx(lt,{onRemove:d})})}const rs=p.forwardRef((e,t)=>{const a=()=>{};return s.jsx(J,{ref:t,name:"overflow",ariaLabel:"More actions",className:w("!rounded-radius-12","!active:scale-[0.99]","hover:bg-[#0000001a]","after:absolute","after:inset-0","after:border","after:border-border","after:rounded-radius-12"),size:"m",onClick:a,...e})});rs.displayName="OverflowIcon";const Bn=({item:e})=>{const{balance:t,title:a}=e,n=Mt(t||{amount:"0",currencyCode:"USD"}),[c,o]=p.useState(!1),d=()=>o(!1),{reportEvent:i}=se(),l=()=>{i({schemaId:"shop_app_entity_interaction/4.4",payload:{entityType:T.ShopCashActivity,entityId:"view_shop_cash_activity_button",interactionType:G.ViewShopCashActivityPressed}}),o(!0)},r=()=>{i({schemaId:"shop_app_entity_interaction/4.4",payload:{entityType:T.ShopCashActivity,entityId:"shop_cash_learn_more_button",interactionType:G.ShopCashLearnMorePressed}})};return s.jsxs("div",{className:"flex items-center px-space-8 pt-space-8 md:pt-space-32","data-testid":"shop-cash-offers-list-heading",children:[s.jsxs("div",{className:"flex grow flex-col",children:[a&&s.jsx(L,{variant:"subtitleSmall",className:"text-text-tertiary",children:a}),s.jsx(L,{variant:"heroBold",children:n})]}),s.jsx("div",{children:s.jsxs(ua,{children:[s.jsx(ha,{asChild:!0,children:s.jsx(rs,{})}),s.jsx(pa,{children:s.jsxs(ma,{sideOffset:5,className:"z-10 flex min-w-[220px] flex-col rounded-radius-12 border-[0.5px] border-solid border-border-secondary bg-bg-fill p-space-8 shadow-md",children:[s.jsxs("div",{className:"flex cursor-pointer gap-space-16 rounded-radius-12 p-space-8 hover:bg-bg-fill-secondary",onClick:l,children:[s.jsx(V,{name:"clock"}),s.jsx("div",{children:P.t("ShopCash.Activity.Menu.Activity")})]}),s.jsxs("div",{className:"flex cursor-pointer gap-space-16 rounded-radius-12 p-space-8 hover:bg-bg-fill-secondary",children:[s.jsx(V,{name:"question-mark-circle"}),s.jsx(Q,{to:fa,target:"_blank",onClick:r,children:P.t("ShopCash.Activity.Menu.HowItWorks")})]})]})})]})}),s.jsx(xa,{open:c,onOpenChange:d})]})},zn=-3,Mn=4;function Hn({index:e,item:t}){const{selectedItemIndex:a,onHoverIndex:n,onMouseLeave:c}=pe(),o=a===e,d=M(),i=ot(),l=!!i,{conversation:r}=t,u=p.useCallback(()=>{if(!r)return;d.entityPressed({entityId:r.id,entityType:T.Thread,xPos:t.xPos});const b=zt(r.id);i&&b&&i.navigateToThreads(b)},[r,d,t,i]),f=p.useCallback(()=>{r&&d.entityViewed({entityId:r.id,entityType:T.Thread,xPos:t.xPos})},[r,d,t]),m=p.useMemo(()=>{var b;return((b=r==null?void 0:r.recentProductImages)==null?void 0:b.slice(0,2))||[]},[r]),h=m.length>0,g=p.useMemo(()=>ya(new Date(r==null?void 0:r.lastUpdatedAt).getTime()),[r]);return r?s.jsx("button",{onClick:u,onFocus:f,onMouseEnter:()=>{n==null||n(e||0)},onMouseLeave:()=>{c==null||c()},"data-testid":"feed-thread-card",className:w("w-full cursor-pointer rounded-radius-12 border-0 p-0 text-left","transition-all duration-200 ease-in-out","focus:ring-border-focus focus:outline-none focus:ring-2",l?"bg-transparent hover:bg-bg-overlay-fixed-dark-04":"bg-bg-fill hover:bg-bg-fill-secondary",o&&"bg-bg-fill-secondary outline outline-2 outline-border-secondary"),children:s.jsxs("div",{className:"flex items-center gap-space-12 p-space-4",children:[s.jsx("div",{className:"relative size-space-40 shrink-0",children:h?s.jsx(s.Fragment,{children:m.map((b,I)=>{const S=I===0?zn:Mn*I,_=0,A=I*5;return s.jsx("div",{className:"absolute size-space-40 overflow-hidden rounded-radius-12 border border-border-image bg-bg-fill shadow-xs",style:{transform:`rotate(${S}deg)`,top:`${_}px`,left:`${A}px`,zIndex:m.length-I},children:s.jsx("img",{src:b.url,alt:b.altText||"",className:"size-full object-cover"})},b.url)})}):s.jsx("div",{"data-testid":"thread-card-image-fallback",className:w(l?"size-space-40 rounded-radius-12 bg-bg-fill-secondary":"size-space-32 rounded-radius-8 bg-bg-fill shadow-xs","flex items-center justify-center border border-border-image"),children:s.jsx("div",{className:w(l?"text-text-tertiary":"size-space-16 text-text-placeholder"),children:s.jsx(V,{name:"grid-filled",size:"s",className:"rotate-45 text-text-tertiary"})})})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[r.title?s.jsx(L,{variant:"bodySmall",className:"truncate text-text",title:r.title,children:r.title}):null,s.jsx(L,{variant:l?"badgeBold":"badge",className:"text-text-tertiary",children:g})]})]})}):null}const Un=({item:e})=>{const t=M(),a=p.useCallback(()=>{t.entityPressed({entityId:e.action.url,entityType:T.ViewAll,xPos:e.xPos})},[e.action.url,e.xPos,t]),n=p.useCallback(()=>{t.entityViewed({entityId:e.action.url,entityType:T.ViewAll,xPos:e.xPos})},[e.action.url,e.xPos,t]);return e.action?s.jsx(z,{onImpression:n,triggerOnce:!0,children:s.jsx(Q,{to:e.action.url,"data-testid":"view-all-link",onClick:a,children:s.jsx("div",{className:"flex aspect-square overflow-hidden rounded-radius-16 border border-solid border-border-image",children:s.jsxs("div",{className:"group relative flex flex-1",children:[s.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center gap-space-8 p-space-8 text-center",children:[s.jsx(V,{name:"arrow-right",size:"m"}),s.jsx(L,{variant:"bodyTitleSmall",children:e.action.label})]}),s.jsx("div",{className:"flex flex-1 bg-bg-fill-secondary"})]})})})}):null};function ei({index:e,item:t,size:a}){const n=Ba(a);return ps(t)?s.jsx(On,{index:e,item:t,cardSize:n}):ms(t)?s.jsx(is,{variant:t.productVariant}):fs(t)?s.jsx(mn,{index:e,item:t,cardSize:n}):xs(t)?s.jsx(Fn,{item:t}):vs(t)?s.jsx(dn,{item:t}):ys(t)?s.jsx(Un,{item:t}):gs(t)?s.jsx(Bn,{item:t}):bs(t)?s.jsx(cn,{item:t}):Is(t)?s.jsx(rn,{item:t,cardSize:n}):Cs(t)?s.jsx(Xa,{item:t,cardSize:n}):ks(t)?s.jsx(ct,{index:e,item:t,cardSize:n}):ws(t)?s.jsx(Hn,{index:e,item:t}):null}export{Yr as A,q as C,ei as F,as as H,Ke as L,Jr as M,rs as O,nn as P,Da as T,Qr as a,ba as b,Cn as c,Bn as d,ot as e,ya as f,va as g,Kr as h,ga as i,xn as j,Zr as k,_n as l,Ba as m,M as n,pe as o,za as p,An as q,et as r,wn as s,Rn as t,Ca as u,kn as v};
//# sourceMappingURL=FeedCard-TpcvKHB_.js.map
