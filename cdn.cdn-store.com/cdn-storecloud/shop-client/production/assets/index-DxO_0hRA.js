import{j as i}from"./jsx-runtime-D_zvdyIk.js";import{r as l}from"./chunk-DQRVZFIR-mrH3D8v7.js";import{I as w}from"./Image-Cc02ywVl.js";import{s as g}from"./deviceUtils-BLIhItqY.js";import{u as x}from"./index-B71n1RID.js";import{u as j}from"./use-hydrated-Cnw4OuED.js";import{c as y}from"./cn-yu2yf51J.js";import"./ImageUtils-D5ojfjzT.js";function L(){const s=j();return l.useRef(!s).current}const I=()=>typeof window>"u"?!1:"loading"in HTMLImageElement.prototype,$=({alt:s,src:n,...e})=>{const r=I(),a=L(),{ref:o,inView:u}=x({triggerOnce:!0,skip:r!==!1}),t=a||r||u;return i.jsx("div",{ref:o,className:y("size-full",!t&&"pb-[100%]"),children:t?i.jsx(w,{...e,alt:s,src:n,loading:"lazy","data-testid":"lazy-image"}):null})};function h(s,n){if(!s.startsWith("http")){const[r,a]=s.split("?"),o=new URLSearchParams(a);return o.set("width",`${n}`),`${r}?${o.toString()}`}const e=new URL(s);return e.hostname==="cdn.MedusaJS.com"&&e.searchParams.delete("format"),e.searchParams.set("width",`${n}`),e.toString()}const O=({src:s,className:n,alt:e,imageSizeAtBreakpoint:r,lazy:a=!1,thumbhash:o,...u})=>{const t=l.useMemo(()=>{const f=[],c=[];if(s)return Object.entries(r).forEach(([p,d])=>{if(!d)return;const R=h(s,d);f.push(`${R} ${d}w`),p==="default"?c.push("(max-width: 767px) 100vw"):c.push(`(min-width: ${g[p]}) 50vw`)}),{srcSet:f.join(", "),sizes:c.join(", ")}},[r,s]),m={alt:e,srcSet:t==null?void 0:t.srcSet,sizes:t==null?void 0:t.sizes,className:n,src:s?h(s,r.default):void 0,thumbhash:o??void 0,...u};return a?i.jsx($,{...m}):i.jsx(w,{...m})};export{$ as L,O as R,h as s,L as u};
//# sourceMappingURL=index-DxO_0hRA.js.map
