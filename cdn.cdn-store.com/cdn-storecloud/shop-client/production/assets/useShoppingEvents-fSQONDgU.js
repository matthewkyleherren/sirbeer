import{r as I}from"./chunk-DQRVZFIR-mrH3D8v7.js";import{f as b}from"./MoneyUtils-CzooDnh_.js";import{a as S}from"./AuthenticationProvider-9RtBMSxF.js";var N=(e=>(e.CLAIM="CLAIM",e.ERROR="ERROR",e.PROMPT_TO_CLAIM="PROMPT_TO_CLAIM",e.SUCCESS="SUCCESS",e.SUCCESS_SHEET="SUCCESS_SHEET",e))(N||{}),k=(e=>(e.APP="APP",e.WEB="WEB",e))(k||{}),T=(e=>(e.ELIGIBLE="ELIGIBLE",e.NOT_ELIGIBLE_AFTER_ACTIVE_PERIOD="NOT_ELIGIBLE_AFTER_ACTIVE_PERIOD",e.NOT_ELIGIBLE_ALREADY_CLAIMED="NOT_ELIGIBLE_ALREADY_CLAIMED",e.NOT_ELIGIBLE_ALREADY_USED_APP="NOT_ELIGIBLE_ALREADY_USED_APP",e.NOT_ELIGIBLE_BEFORE_ACTIVE_PERIOD="NOT_ELIGIBLE_BEFORE_ACTIVE_PERIOD",e.NOT_ELIGIBLE_CONNECTED_USERS_ALREADY_CLAIMED="NOT_ELIGIBLE_CONNECTED_USERS_ALREADY_CLAIMED",e.NOT_ELIGIBLE_EMAIL_IN_BLOCKLIST="NOT_ELIGIBLE_EMAIL_IN_BLOCKLIST",e.NOT_ELIGIBLE_FIRST_ACTIVE_OUTSIDE_TIMEFRAME="NOT_ELIGIBLE_FIRST_ACTIVE_OUTSIDE_TIMEFRAME",e.NOT_ELIGIBLE_FOR_SHOP_CASH="NOT_ELIGIBLE_FOR_SHOP_CASH",e.NOT_ELIGIBLE_INVALID_VOUCHER_CODE="NOT_ELIGIBLE_INVALID_VOUCHER_CODE",e.NOT_ELIGIBLE_NEVER_USED_APP="NOT_ELIGIBLE_NEVER_USED_APP",e.NOT_ELIGIBLE_NO_ACCOUNT="NOT_ELIGIBLE_NO_ACCOUNT",e.NOT_ELIGIBLE_NOT_IN_MELODY_SEGMENT="NOT_ELIGIBLE_NOT_IN_MELODY_SEGMENT",e.NOT_ELIGIBLE_OUTSIDE_OF_GEO_BOUNDS="NOT_ELIGIBLE_OUTSIDE_OF_GEO_BOUNDS",e.NOT_ELIGIBLE_PAY_NOT_VERIFIED="NOT_ELIGIBLE_PAY_NOT_VERIFIED",e.NOT_ELIGIBLE_PAY_VERIFIED="NOT_ELIGIBLE_PAY_VERIFIED",e.NOT_ELIGIBLE_PUSH_NOTIFICATIONS_OFF="NOT_ELIGIBLE_PUSH_NOTIFICATIONS_OFF",e.NOT_ELIGIBLE_PUSH_NOTIFICATIONS_ON="NOT_ELIGIBLE_PUSH_NOTIFICATIONS_ON",e.NOT_ELIGIBLE_SHOP_APP_NOT_ALLOWED="NOT_ELIGIBLE_SHOP_APP_NOT_ALLOWED",e.NOT_ELIGIBLE_UNDISCLOSED_REASON="NOT_ELIGIBLE_UNDISCLOSED_REASON",e.NOT_ELIGIBLE_UNNACCEPTABLE_RISK_LEVEL="NOT_ELIGIBLE_UNNACCEPTABLE_RISK_LEVEL",e.NOT_ELIGIBLE_UNSUPPORTED_CURRENCY="NOT_ELIGIBLE_UNSUPPORTED_CURRENCY",e.NOT_ELIGIBLE_UNSUPPORTED_PHONE_COUNTRY="NOT_ELIGIBLE_UNSUPPORTED_PHONE_COUNTRY",e.NOT_ELIGIBLE_VOUCHER_EXPIRED="NOT_ELIGIBLE_VOUCHER_EXPIRED",e.NOT_ELIGIBLE_VOUCHER_NOT_FOUND="NOT_ELIGIBLE_VOUCHER_NOT_FOUND",e.NOT_ELIGIBLE_WEB_NOT_ALLOWED="NOT_ELIGIBLE_WEB_NOT_ALLOWED",e))(T||{}),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ShoppingEvents"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingEvents"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"destinationUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"giveaway"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"eligibility"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isClaimable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"knownVoucherAmount"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"currencyCode"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"screenCustomizations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"screenName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"medium"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"discovery"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"topBannerEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topBannerOnExploreAndCategoryPagesEnabled"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"media"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"texts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerTitle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bannerSubtitles"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"expandedBannerTitle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"expandedBannerSubtitle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"countdownText"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:646}};c.loc.source={body:`query ShoppingEvents($first: Int) {
  shoppingEvents(first: $first) {
    handle
    endDate
    destinationUrl
    giveaway {
      handle
      eligibility
      isClaimable
      knownVoucherAmount {
        amount
        currencyCode
      }
      screenCustomizations {
        name
        screenName
        medium
        value
      }
    }
    discovery {
      topBannerEnabled
      topBannerOnExploreAndCategoryPagesEnabled
    }
    media {
      handle
      url
      backgroundColor
    }
    texts {
      bannerTitle
      bannerSubtitles
      expandedBannerTitle
      expandedBannerSubtitle
      countdownText
    }
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function l(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var a=e.type;a.kind==="NamedType"&&n.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(_){l(_,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(_){l(_,n)}),e.definitions&&e.definitions.forEach(function(_){l(_,n)})}var u={};(function(){c.definitions.forEach(function(n){if(n.name){var a=new Set;l(n,a),u[n.name.value]=a}})})();function L(e,n){for(var a=0;a<e.definitions.length;a++){var _=e.definitions[a];if(_.name&&_.name.value==n)return _}}function v(e,n){var a={kind:e.kind,definitions:[L(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var _=u[n]||new Set,t=new Set,r=new Set;for(_.forEach(function(o){r.add(o)});r.size>0;){var m=r;r=new Set,m.forEach(function(o){if(!t.has(o)){t.add(o);var i=u[o]||new Set;i.forEach(function(E){r.add(E)})}})}return t.forEach(function(o){var i=L(e,o);i&&a.definitions.push(i)}),a}v(c,"ShoppingEvents");function D(e,n){if(e!==void 0)return e.replaceAll("%{amount}",n).replaceAll("\\n",`
`)}const A=(e,n,a)=>{switch(n){case"title":case"subtitle":case"image_url":case"cta_text":case"handle":e[n]=a;break;case"visible":e[n]=a;break}};function f(e){const n={visible:(e==null?void 0:e.eligibility)===T.ELIGIBLE,handle:(e==null?void 0:e.handle)||"",title:"",subtitle:"",image_url:"",cta_text:""};if(!e)return n;const a=e==null?void 0:e.screenCustomizations.filter(({screenName:_,medium:t})=>_===N.PROMPT_TO_CLAIM&&t===k.WEB);return a==null||a.forEach(({name:_,value:t})=>{A(n,_,t)}),n.title=D(n.title,e!=null&&e.knownVoucherAmount?b(e==null?void 0:e.knownVoucherAmount,{maximumFractionDigits:0,minimumFractionDigits:0}):"")||"",(!n.title||!n.image_url)&&(n.visible=!1),n}function C(e){return{giveaway:I.useMemo(()=>f(e),[e])}}var s=(e=>(e.TopBannerBackgroundVideoWebDesktop="top_banner_background_video_web_desktop",e.TopBannerBackgroundVideoWebMobile="top_banner_background_video_web_mobile",e.TopBannerBackgroundImageWebDesktop="top_banner_background_image_web_desktop",e.TopBannerBackgroundImageWebMobile="top_banner_background_image_web_mobile",e.TopShortBannerBackgroundVideoWebDesktop="top_short_banner_background_video_web_desktop",e.TopShortBannerBackgroundVideoWebMobile="top_short_banner_background_video_web_mobile",e.TopShortBannerBackgroundImageWebDesktop="top_short_banner_background_image_web_desktop",e.TopShortBannerBackgroundImageWebMobile="top_short_banner_background_image_web_mobile",e.CardBackgroundVideoWebDesktop="card_background_video_web_desktop",e.CardBackgroundVideoWebMobile="card_background_video_web_mobile",e.CardBackgroundImageWebDesktop="card_background_image_web_desktop",e.CardBackgroundImageWebMobile="card_background_image_web_mobile",e.DownloadAppBannerImageWebDesktop="download_app_banner_image_web_desktop",e.DownloadAppBannerImageWebMobile="download_app_banner_image_web_mobile",e.HeroCollageEverythingTopVideoWebDesktop="hero_collage_everything_top_video_web_desktop",e.HeroCollageEverythingTopVideoWebMobile="hero_collage_everything_top_video_web_mobile",e.HeroCollageEverythingBottomVideoWebDesktop="hero_collage_everything_bottom_video_web_desktop",e))(s||{});const O=(e,n)=>n.find(a=>a.handle===e),p=({skip:e=!1,ssr:n=!1}={})=>{var E;const a=S(c,{variables:{first:1},fetchPolicy:"cache-first",nextFetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0,skip:e,ssr:n}),_=I.useCallback(()=>a.refetch(),[a]),t=(E=a.data)==null?void 0:E.shoppingEvents[0],{giveaway:r}=C(t==null?void 0:t.giveaway),o=!!(I.useMemo(()=>{if(!t)return;const d=O(s.TopShortBannerBackgroundImageWebDesktop,t.media),B=O(s.TopShortBannerBackgroundImageWebMobile,t.media);return!!(d&&B)},[t])&&(t!=null&&t.destinationUrl)&&t.texts.bannerTitle&&t.texts.bannerSubtitles.length>0),i=t&&(t==null?void 0:t.media.find(d=>d.handle===s.DownloadAppBannerImageWebDesktop||d.handle===s.DownloadAppBannerImageWebMobile));return I.useMemo(()=>{var d;return{...a,showCollapsedBanner:!!(t&&((d=t.discovery)!=null&&d.topBannerEnabled)&&o),shoppingEvent:t,giveaway:r,refetch:_,showDownloadAppBanner:i}},[a,t,o,r,_,i])};export{T as E,s as S,O as g,D as t,p as u};
//# sourceMappingURL=useShoppingEvents-fSQONDgU.js.map
